Feature: [SAT-GR] Implementing ghost records

  Scenario: [SAT-GR-01]

    Given the SATELLITE sat is already populated with data
      | CUSTOMER_PK | CUSTOMER_NAME | CUSTOMER_PHONE  | CUSTOMER_DOB | HASHDIFF                                               | EFFECTIVE_FROM | LOAD_DATE  | SOURCE |
      | md5('1001') | Alice         | 17-214-233-1214 | 1997-04-24   | md5('1997-04-24\|\|1001\|\|ALICE\|\|17-214-233-1214')  | 1993-01-01     | 1993-01-01 | *      |
      | md5('1002') | Bob           | 17-214-233-1215 | 2006-04-17   | md5('2006-04-17\|\|1002\|\|BOB\|\|17-214-233-1215')    | 1993-01-01     | 1993-01-01 | *      |
      | md5('1003') | Chad          | 17-214-233-1216 | 2013-02-04   | md5('2013-02-04\|\|1003\|\|CHAD\|\|17-214-233-1216')   | 1993-01-01     | 1993-01-01 | *      |
      | md5('1004') | Dom           | 17-214-233-1217 | 2018-04-13   | md5('2018-04-13\|\|1004\|\|DOM\|\|17-214-233-1217')    | 1993-01-01     | 1993-01-01 | *      |
      | md5('1005') | Frida         | 17-214-233-1218 | 2008-04-13   | md5('2008-04-13\|\|1005\|\|FRIDA\|\|17-214-233-1218')  | 1993-01-01     | 1993-01-01 | *      |
      | md5('1006') | George        | 17-214-233-1219 | 1998-04-13   | md5('1998-04-13\|\|1006\|\|GEORGE\|\|17-214-233-1219') | 1993-01-01     | 1993-01-01 | *      |
      | md5('1007') | Harry         | 17-214-233-1220 | 1988-04-13   | md5('1988-04-13\|\|1007\|\|HARRY\|\|17-214-233-1220')  | 1993-01-01     | 1993-01-01 | *      |
    And I have configured ghost records
    When I append a ghost record
    Then the SATELLITE table should contain expected data
      | CUSTOMER_PK | CUSTOMER_NAME | CUSTOMER_PHONE  | CUSTOMER_DOB | HASHDIFF                                               | EFFECTIVE_FROM | LOAD_DATE  | SOURCE          |
      | 00000000000 | GHOST         | 00-000-000-0000 | 1900-01-01   | 00000000000000000000000000000000                       | 1900-01-01     | 1900-01-01 | DBTVAULT_SYSTEM |
      | md5('1001') | Alice         | 17-214-233-1214 | 1997-04-24   | md5('1997-04-24\|\|1001\|\|ALICE\|\|17-214-233-1214')  | 1993-01-01     | 1993-01-01 | *               |
      | md5('1002') | Bob           | 17-214-233-1215 | 2006-04-17   | md5('2006-04-17\|\|1002\|\|BOB\|\|17-214-233-1215')    | 1993-01-01     | 1993-01-01 | *               |
      | md5('1003') | Chad          | 17-214-233-1216 | 2013-02-04   | md5('2013-02-04\|\|1003\|\|CHAD\|\|17-214-233-1216')   | 1993-01-01     | 1993-01-01 | *               |
      | md5('1004') | Dom           | 17-214-233-1217 | 2018-04-13   | md5('2018-04-13\|\|1004\|\|DOM\|\|17-214-233-1217')    | 1993-01-01     | 1993-01-01 | *               |
      | md5('1005') | Frida         | 17-214-233-1218 | 2008-04-13   | md5('2008-04-13\|\|1005\|\|FRIDA\|\|17-214-233-1218')  | 1993-01-01     | 1993-01-01 | *               |
      | md5('1006') | George        | 17-214-233-1219 | 1998-04-13   | md5('1998-04-13\|\|1006\|\|GEORGE\|\|17-214-233-1219') | 1993-01-01     | 1993-01-01 | *               |
      | md5('1007') | Harry         | 17-214-233-1220 | 1988-04-13   | md5('1988-04-13\|\|1007\|\|HARRY\|\|17-214-233-1220')  | 1993-01-01     | 1993-01-01 | *               |
