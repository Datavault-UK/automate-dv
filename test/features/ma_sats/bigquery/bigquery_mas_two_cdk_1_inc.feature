Feature: [BQ-MAS-2CD-I] Multi Active Satellites
  Incremental loads with MAS behaviour with two CDKs

  @fixture.multi_active_satellite
  Scenario: [BQ-MAS-2CD-I-01] Load data into a populated multi-active satellite where all records load
    Given the MULTI_ACTIVE_SATELLITE_TWO_CDK ma_sat is already populated with data
      | CUSTOMER_PK | CUSTOMER_NAME | CUSTOMER_PHONE  | EXTENSION | HASHDIFF                                         | EFFECTIVE_FROM | LOAD_DATE  | SOURCE |
      | md5('1004') | Dom           | 17-214-233-1217 | 12331     | md5('1004\|\|DOM\|\|17-214-233-1217\|\|12331')   | 1993-01-01     | 1993-01-01 | *      |
      | md5('1004') | Dom           | 17-214-233-1227 | 12331     | md5('1004\|\|DOM\|\|17-214-233-1227\|\|12331')   | 1993-01-01     | 1993-01-01 | *      |
      | md5('1004') | Dom           | 17-214-233-1237 | 12331     | md5('1004\|\|DOM\|\|17-214-233-1237\|\|12331')   | 1993-01-01     | 1993-01-01 | *      |
      | md5('1006') | Frida         | 17-214-233-1214 | 12341     | md5('1006\|\|FRIDA\|\|17-214-233-1214\|\|12341') | 1993-01-01     | 1993-01-01 | *      |
      | md5('1006') | Frida         | 17-214-233-1214 | 12342     | md5('1006\|\|FRIDA\|\|17-214-233-1214\|\|12342') | 1993-01-01     | 1993-01-01 | *      |
      | md5('1006') | Frida         | 17-214-233-1214 | 12343     | md5('1006\|\|FRIDA\|\|17-214-233-1214\|\|12343') | 1993-01-01     | 1993-01-01 | *      |

    And the RAW_STAGE_TWO_CDK table contains data
      | CUSTOMER_ID | CUSTOMER_NAME | CUSTOMER_PHONE  | EXTENSION | LOAD_DATE  | SOURCE |
      | 1001        | Alice         | 17-214-233-1214 | 12301     | 1993-01-02 | *      |
      | 1001        | Alice         | 17-214-233-1214 | 12302     | 1993-01-02 | *      |
      | 1001        | Alice         | 17-214-233-1214 | 12303     | 1993-01-02 | *      |
      | 1001        | Alice         | 17-214-233-1214 | 12303     | 1993-01-02 | *      |
      | 1002        | Bob           | 17-214-233-1215 | 12311     | 1993-01-02 | *      |
      | 1002        | Bob           | 17-214-233-1215 | 12312     | 1993-01-02 | *      |
      | 1002        | Bob           | 17-214-233-1215 | 12313     | 1993-01-02 | *      |
      | 1002        | Bob           | 17-214-233-1215 | 12313     | 1993-01-02 | *      |
      | 1003        | Chad          | 17-214-233-1216 | 12321     | 1993-01-02 | *      |
      | 1003        | Chad          | 17-214-233-1226 | 12321     | 1993-01-02 | *      |
      | 1003        | Chad          | 17-214-233-1226 | 12321     | 1993-01-02 | *      |
      | 1003        | Chad          | 17-214-233-1236 | 12321     | 1993-01-02 | *      |
      | 1005        | Eric          | 17-214-233-1217 | 12331     | 1993-01-02 | *      |
      | 1005        | Eric          | 17-214-233-1227 | 12331     | 1993-01-02 | *      |
      | 1005        | Eric          | 17-214-233-1237 | 12331     | 1993-01-02 | *      |
      | 1005        | Eric          | 17-214-233-1237 | 12331     | 1993-01-02 | *      |
    And I stage the STG_CUSTOMER_TWO_CDK data
    When I load the MULTI_ACTIVE_SATELLITE_TWO_CDK ma_sat
    Then the MULTI_ACTIVE_SATELLITE_TWO_CDK table should contain expected data
      | CUSTOMER_PK | CUSTOMER_NAME | CUSTOMER_PHONE  | EXTENSION | HASHDIFF                                         | EFFECTIVE_FROM | LOAD_DATE  | SOURCE |
      | md5('1001') | Alice         | 17-214-233-1214 | 12301     | md5('1001\|\|ALICE\|\|17-214-233-1214\|\|12301') | 1993-01-02     | 1993-01-02 | *      |
      | md5('1001') | Alice         | 17-214-233-1214 | 12302     | md5('1001\|\|ALICE\|\|17-214-233-1214\|\|12302') | 1993-01-02     | 1993-01-02 | *      |
      | md5('1001') | Alice         | 17-214-233-1214 | 12303     | md5('1001\|\|ALICE\|\|17-214-233-1214\|\|12303') | 1993-01-02     | 1993-01-02 | *      |
      | md5('1002') | Bob           | 17-214-233-1215 | 12311     | md5('1002\|\|BOB\|\|17-214-233-1215\|\|12311')   | 1993-01-02     | 1993-01-02 | *      |
      | md5('1002') | Bob           | 17-214-233-1215 | 12312     | md5('1002\|\|BOB\|\|17-214-233-1215\|\|12312')   | 1993-01-02     | 1993-01-02 | *      |
      | md5('1002') | Bob           | 17-214-233-1215 | 12313     | md5('1002\|\|BOB\|\|17-214-233-1215\|\|12313')   | 1993-01-02     | 1993-01-02 | *      |
      | md5('1003') | Chad          | 17-214-233-1216 | 12321     | md5('1003\|\|CHAD\|\|17-214-233-1216\|\|12321')  | 1993-01-02     | 1993-01-02 | *      |
      | md5('1003') | Chad          | 17-214-233-1226 | 12321     | md5('1003\|\|CHAD\|\|17-214-233-1226\|\|12321')  | 1993-01-02     | 1993-01-02 | *      |
      | md5('1003') | Chad          | 17-214-233-1236 | 12321     | md5('1003\|\|CHAD\|\|17-214-233-1236\|\|12321')  | 1993-01-02     | 1993-01-02 | *      |
      | md5('1004') | Dom           | 17-214-233-1217 | 12331     | md5('1004\|\|DOM\|\|17-214-233-1217\|\|12331')   | 1993-01-01     | 1993-01-01 | *      |
      | md5('1004') | Dom           | 17-214-233-1227 | 12331     | md5('1004\|\|DOM\|\|17-214-233-1227\|\|12331')   | 1993-01-01     | 1993-01-01 | *      |
      | md5('1004') | Dom           | 17-214-233-1237 | 12331     | md5('1004\|\|DOM\|\|17-214-233-1237\|\|12331')   | 1993-01-01     | 1993-01-01 | *      |
      | md5('1005') | Eric          | 17-214-233-1217 | 12331     | md5('1005\|\|ERIC\|\|17-214-233-1217\|\|12331')  | 1993-01-02     | 1993-01-02 | *      |
      | md5('1005') | Eric          | 17-214-233-1227 | 12331     | md5('1005\|\|ERIC\|\|17-214-233-1227\|\|12331')  | 1993-01-02     | 1993-01-02 | *      |
      | md5('1005') | Eric          | 17-214-233-1237 | 12331     | md5('1005\|\|ERIC\|\|17-214-233-1237\|\|12331')  | 1993-01-02     | 1993-01-02 | *      |
      | md5('1006') | Frida         | 17-214-233-1214 | 12341     | md5('1006\|\|FRIDA\|\|17-214-233-1214\|\|12341') | 1993-01-01     | 1993-01-01 | *      |
      | md5('1006') | Frida         | 17-214-233-1214 | 12342     | md5('1006\|\|FRIDA\|\|17-214-233-1214\|\|12342') | 1993-01-01     | 1993-01-01 | *      |
      | md5('1006') | Frida         | 17-214-233-1214 | 12343     | md5('1006\|\|FRIDA\|\|17-214-233-1214\|\|12343') | 1993-01-01     | 1993-01-01 | *      |

  @fixture.multi_active_satellite
  Scenario: [BQ-MAS-2CD-I-02] Load data into a populated multi-active satellite where some records overlap
    Given the MULTI_ACTIVE_SATELLITE_TWO_CDK ma_sat is already populated with data
      | CUSTOMER_PK | CUSTOMER_NAME | CUSTOMER_PHONE  | EXTENSION | HASHDIFF                                         | EFFECTIVE_FROM | LOAD_DATE  | SOURCE |
      | md5('1002') | Bob           | 17-214-233-1215 | 12311     | md5('1002\|\|BOB\|\|17-214-233-1215\|\|12311')   | 1993-01-01     | 1993-01-01 | *      |
      | md5('1002') | Bob           | 17-214-233-1215 | 12312     | md5('1002\|\|BOB\|\|17-214-233-1215\|\|12312')   | 1993-01-01     | 1993-01-01 | *      |
      | md5('1002') | Bob           | 17-214-233-1215 | 12313     | md5('1002\|\|BOB\|\|17-214-233-1215\|\|12313')   | 1993-01-01     | 1993-01-01 | *      |
      | md5('1003') | Chad          | 17-214-233-1216 | 12321     | md5('1003\|\|CHAD\|\|17-214-233-1216\|\|12321')  | 1993-01-01     | 1993-01-01 | *      |
      | md5('1003') | Chad          | 17-214-233-1216 | 12322     | md5('1003\|\|CHAD\|\|17-214-233-1216\|\|12322')  | 1993-01-01     | 1993-01-01 | *      |
      | md5('1003') | Chad          | 17-214-233-1216 | 12323     | md5('1003\|\|CHAD\|\|17-214-233-1216\|\|12323')  | 1993-01-01     | 1993-01-01 | *      |
      | md5('1004') | Dom           | 17-214-233-1217 | 12331     | md5('1004\|\|DOM\|\|17-214-233-1217\|\|12331')   | 1993-01-01     | 1993-01-01 | *      |
      | md5('1004') | Dom           | 17-214-233-1227 | 12331     | md5('1004\|\|DOM\|\|17-214-233-1227\|\|12331')   | 1993-01-01     | 1993-01-01 | *      |
      | md5('1004') | Dom           | 17-214-233-1237 | 12331     | md5('1004\|\|DOM\|\|17-214-233-1237\|\|12331')   | 1993-01-01     | 1993-01-01 | *      |
      | md5('1006') | Frida         | 17-214-233-1218 | 12341     | md5('1006\|\|FRIDA\|\|17-214-233-1218\|\|12341') | 1993-01-01     | 1993-01-01 | *      |
      | md5('1006') | Frida         | 17-214-233-1228 | 12341     | md5('1006\|\|FRIDA\|\|17-214-233-1228\|\|12341') | 1993-01-01     | 1993-01-01 | *      |
      | md5('1006') | Frida         | 17-214-233-1238 | 12341     | md5('1006\|\|FRIDA\|\|17-214-233-1238\|\|12341') | 1993-01-01     | 1993-01-01 | *      |
    And the RAW_STAGE_TWO_CDK table contains data
      | CUSTOMER_ID | CUSTOMER_NAME | CUSTOMER_PHONE  | EXTENSION | LOAD_DATE  | SOURCE |
      | 1001        | Alice         | 17-214-233-1214 | 12301     | 1993-01-02 | *      |
      | 1001        | Alice         | 17-214-233-1214 | 12302     | 1993-01-02 | *      |
      | 1001        | Alice         | 17-214-233-1214 | 12303     | 1993-01-02 | *      |
      | 1002        | Bob           | 17-214-233-1215 | 12311     | 1993-01-02 | *      |
      | 1002        | Bob           | 17-214-233-1215 | 12312     | 1993-01-02 | *      |
      | 1002        | Bob           | 17-214-233-1215 | 12313     | 1993-01-02 | *      |
      | 1002        | Bob           | 17-214-233-1215 | 12313     | 1993-01-02 | *      |
      | 1003        | Chad          | 17-214-233-1216 | 12321     | 1993-01-02 | *      |
      | 1003        | Chad          | 17-214-233-1216 | 12322     | 1993-01-02 | *      |
      | 1003        | Chad          | 17-214-233-1216 | 12323     | 1993-01-02 | *      |
      | 1005        | Eric          | 17-214-233-1217 | 12331     | 1993-01-02 | *      |
      | 1005        | Eric          | 17-214-233-1227 | 12331     | 1993-01-02 | *      |
      | 1005        | Eric          | 17-214-233-1237 | 12331     | 1993-01-02 | *      |
      | 1005        | Eric          | 17-214-233-1237 | 12331     | 1993-01-02 | *      |
    And I stage the STG_CUSTOMER_TWO_CDK data
    When I load the MULTI_ACTIVE_SATELLITE_TWO_CDK ma_sat
    Then the MULTI_ACTIVE_SATELLITE_TWO_CDK table should contain expected data
      | CUSTOMER_PK | CUSTOMER_NAME | CUSTOMER_PHONE  | EXTENSION | HASHDIFF                                         | EFFECTIVE_FROM | LOAD_DATE  | SOURCE |
      | md5('1001') | Alice         | 17-214-233-1214 | 12301     | md5('1001\|\|ALICE\|\|17-214-233-1214\|\|12301') | 1993-01-02     | 1993-01-02 | *      |
      | md5('1001') | Alice         | 17-214-233-1214 | 12302     | md5('1001\|\|ALICE\|\|17-214-233-1214\|\|12302') | 1993-01-02     | 1993-01-02 | *      |
      | md5('1001') | Alice         | 17-214-233-1214 | 12303     | md5('1001\|\|ALICE\|\|17-214-233-1214\|\|12303') | 1993-01-02     | 1993-01-02 | *      |
      | md5('1002') | Bob           | 17-214-233-1215 | 12311     | md5('1002\|\|BOB\|\|17-214-233-1215\|\|12311')   | 1993-01-01     | 1993-01-01 | *      |
      | md5('1002') | Bob           | 17-214-233-1215 | 12312     | md5('1002\|\|BOB\|\|17-214-233-1215\|\|12312')   | 1993-01-01     | 1993-01-01 | *      |
      | md5('1002') | Bob           | 17-214-233-1215 | 12313     | md5('1002\|\|BOB\|\|17-214-233-1215\|\|12313')   | 1993-01-01     | 1993-01-01 | *      |
      | md5('1003') | Chad          | 17-214-233-1216 | 12321     | md5('1003\|\|CHAD\|\|17-214-233-1216\|\|12321')  | 1993-01-01     | 1993-01-01 | *      |
      | md5('1003') | Chad          | 17-214-233-1216 | 12322     | md5('1003\|\|CHAD\|\|17-214-233-1216\|\|12322')  | 1993-01-01     | 1993-01-01 | *      |
      | md5('1003') | Chad          | 17-214-233-1216 | 12323     | md5('1003\|\|CHAD\|\|17-214-233-1216\|\|12323')  | 1993-01-01     | 1993-01-01 | *      |
      | md5('1004') | Dom           | 17-214-233-1217 | 12331     | md5('1004\|\|DOM\|\|17-214-233-1217\|\|12331')   | 1993-01-01     | 1993-01-01 | *      |
      | md5('1004') | Dom           | 17-214-233-1227 | 12331     | md5('1004\|\|DOM\|\|17-214-233-1227\|\|12331')   | 1993-01-01     | 1993-01-01 | *      |
      | md5('1004') | Dom           | 17-214-233-1237 | 12331     | md5('1004\|\|DOM\|\|17-214-233-1237\|\|12331')   | 1993-01-01     | 1993-01-01 | *      |
      | md5('1005') | Eric          | 17-214-233-1217 | 12331     | md5('1005\|\|ERIC\|\|17-214-233-1217\|\|12331')  | 1993-01-02     | 1993-01-02 | *      |
      | md5('1005') | Eric          | 17-214-233-1227 | 12331     | md5('1005\|\|ERIC\|\|17-214-233-1227\|\|12331')  | 1993-01-02     | 1993-01-02 | *      |
      | md5('1005') | Eric          | 17-214-233-1237 | 12331     | md5('1005\|\|ERIC\|\|17-214-233-1237\|\|12331')  | 1993-01-02     | 1993-01-02 | *      |
      | md5('1006') | Frida         | 17-214-233-1218 | 12341     | md5('1006\|\|FRIDA\|\|17-214-233-1218\|\|12341') | 1993-01-01     | 1993-01-01 | *      |
      | md5('1006') | Frida         | 17-214-233-1228 | 12341     | md5('1006\|\|FRIDA\|\|17-214-233-1228\|\|12341') | 1993-01-01     | 1993-01-01 | *      |
      | md5('1006') | Frida         | 17-214-233-1238 | 12341     | md5('1006\|\|FRIDA\|\|17-214-233-1238\|\|12341') | 1993-01-01     | 1993-01-01 | *      |

  @fixture.multi_active_satellite
  Scenario: [BQ-MAS-2CD-I-03] Load data into a populated multi-active satellite where sets of records have fewer records
    Given the MULTI_ACTIVE_SATELLITE_TWO_CDK ma_sat is already populated with data
      | CUSTOMER_PK | CUSTOMER_NAME | CUSTOMER_PHONE  | EXTENSION | HASHDIFF                                         | EFFECTIVE_FROM | LOAD_DATE  | SOURCE |
      | md5('1002') | Bob           | 17-214-233-1215 | 12311     | md5('1002\|\|BOB\|\|17-214-233-1215\|\|12311')   | 1993-01-01     | 1993-01-01 | *      |
      | md5('1002') | Bob           | 17-214-233-1215 | 12312     | md5('1002\|\|BOB\|\|17-214-233-1215\|\|12312')   | 1993-01-01     | 1993-01-01 | *      |
      | md5('1002') | Bob           | 17-214-233-1215 | 12313     | md5('1002\|\|BOB\|\|17-214-233-1215\|\|12313')   | 1993-01-01     | 1993-01-01 | *      |
      | md5('1003') | Chad          | 17-214-233-1216 | 12321     | md5('1003\|\|CHAD\|\|17-214-233-1216\|\|12321')  | 1993-01-01     | 1993-01-01 | *      |
      | md5('1003') | Chad          | 17-214-233-1216 | 12322     | md5('1003\|\|CHAD\|\|17-214-233-1216\|\|12322')  | 1993-01-01     | 1993-01-01 | *      |
      | md5('1003') | Chad          | 17-214-233-1216 | 12323     | md5('1003\|\|CHAD\|\|17-214-233-1216\|\|12323')  | 1993-01-01     | 1993-01-01 | *      |
      | md5('1004') | Dom           | 17-214-233-1217 | 12331     | md5('1004\|\|DOM\|\|17-214-233-1217\|\|12331')   | 1993-01-01     | 1993-01-01 | *      |
      | md5('1004') | Dom           | 17-214-233-1227 | 12331     | md5('1004\|\|DOM\|\|17-214-233-1227\|\|12331')   | 1993-01-01     | 1993-01-01 | *      |
      | md5('1004') | Dom           | 17-214-233-1237 | 12331     | md5('1004\|\|DOM\|\|17-214-233-1237\|\|12331')   | 1993-01-01     | 1993-01-01 | *      |
      | md5('1006') | Frida         | 17-214-233-1214 | 12341     | md5('1006\|\|FRIDA\|\|17-214-233-1214\|\|12341') | 1993-01-01     | 1993-01-01 | *      |
      | md5('1006') | Frida         | 17-214-233-1224 | 12341     | md5('1006\|\|FRIDA\|\|17-214-233-1224\|\|12341') | 1993-01-01     | 1993-01-01 | *      |
      | md5('1006') | Frida         | 17-214-233-1234 | 12341     | md5('1006\|\|FRIDA\|\|17-214-233-1234\|\|12341') | 1993-01-01     | 1993-01-01 | *      |

    And the RAW_STAGE_TWO_CDK table contains data
      | CUSTOMER_ID | CUSTOMER_NAME | CUSTOMER_PHONE  | EXTENSION | LOAD_DATE  | SOURCE |
      | 1002        | Bob           | 17-214-233-1215 | 12311     | 1993-01-02 | *      |
      | 1002        | Bob           | 17-214-233-1215 | 12312     | 1993-01-02 | *      |
      | 1004        | Dom           | 17-214-233-1217 | 12331     | 1993-01-02 | *      |
      | 1004        | Dom           | 17-214-233-1237 | 12331     | 1993-01-02 | *      |

    And I stage the STG_CUSTOMER_TWO_CDK data
    When I load the MULTI_ACTIVE_SATELLITE_TWO_CDK ma_sat
    Then the MULTI_ACTIVE_SATELLITE_TWO_CDK table should contain expected data
      | CUSTOMER_PK | CUSTOMER_NAME | CUSTOMER_PHONE  | EXTENSION | HASHDIFF                                         | EFFECTIVE_FROM | LOAD_DATE  | SOURCE |
      | md5('1002') | Bob           | 17-214-233-1215 | 12311     | md5('1002\|\|BOB\|\|17-214-233-1215\|\|12311')   | 1993-01-01     | 1993-01-01 | *      |
      | md5('1002') | Bob           | 17-214-233-1215 | 12312     | md5('1002\|\|BOB\|\|17-214-233-1215\|\|12312')   | 1993-01-01     | 1993-01-01 | *      |
      | md5('1002') | Bob           | 17-214-233-1215 | 12313     | md5('1002\|\|BOB\|\|17-214-233-1215\|\|12313')   | 1993-01-01     | 1993-01-01 | *      |
      | md5('1003') | Chad          | 17-214-233-1216 | 12321     | md5('1003\|\|CHAD\|\|17-214-233-1216\|\|12321')  | 1993-01-01     | 1993-01-01 | *      |
      | md5('1003') | Chad          | 17-214-233-1216 | 12322     | md5('1003\|\|CHAD\|\|17-214-233-1216\|\|12322')  | 1993-01-01     | 1993-01-01 | *      |
      | md5('1003') | Chad          | 17-214-233-1216 | 12323     | md5('1003\|\|CHAD\|\|17-214-233-1216\|\|12323')  | 1993-01-01     | 1993-01-01 | *      |
      | md5('1004') | Dom           | 17-214-233-1217 | 12331     | md5('1004\|\|DOM\|\|17-214-233-1217\|\|12331')   | 1993-01-01     | 1993-01-01 | *      |
      | md5('1004') | Dom           | 17-214-233-1227 | 12331     | md5('1004\|\|DOM\|\|17-214-233-1227\|\|12331')   | 1993-01-01     | 1993-01-01 | *      |
      | md5('1004') | Dom           | 17-214-233-1237 | 12331     | md5('1004\|\|DOM\|\|17-214-233-1237\|\|12331')   | 1993-01-01     | 1993-01-01 | *      |
      | md5('1006') | Frida         | 17-214-233-1214 | 12341     | md5('1006\|\|FRIDA\|\|17-214-233-1214\|\|12341') | 1993-01-01     | 1993-01-01 | *      |
      | md5('1006') | Frida         | 17-214-233-1224 | 12341     | md5('1006\|\|FRIDA\|\|17-214-233-1224\|\|12341') | 1993-01-01     | 1993-01-01 | *      |
      | md5('1006') | Frida         | 17-214-233-1234 | 12341     | md5('1006\|\|FRIDA\|\|17-214-233-1234\|\|12341') | 1993-01-01     | 1993-01-01 | *      |
      | md5('1002') | Bob           | 17-214-233-1215 | 12311     | md5('1002\|\|BOB\|\|17-214-233-1215\|\|12311')   | 1993-01-02     | 1993-01-02 | *      |
      | md5('1002') | Bob           | 17-214-233-1215 | 12312     | md5('1002\|\|BOB\|\|17-214-233-1215\|\|12312')   | 1993-01-02     | 1993-01-02 | *      |
      | md5('1004') | Dom           | 17-214-233-1217 | 12331     | md5('1004\|\|DOM\|\|17-214-233-1217\|\|12331')   | 1993-01-02     | 1993-01-02 | *      |
      | md5('1004') | Dom           | 17-214-233-1237 | 12331     | md5('1004\|\|DOM\|\|17-214-233-1237\|\|12331')   | 1993-01-02     | 1993-01-02 | *      |

  @fixture.multi_active_satellite
  Scenario: [BQ-MAS-2CD-I-04] Load data into a populated multi-active satellite where some sets of records have extra records
    Given the MULTI_ACTIVE_SATELLITE_TWO_CDK ma_sat is already populated with data
      | CUSTOMER_PK | CUSTOMER_NAME | CUSTOMER_PHONE  | EXTENSION | HASHDIFF                                         | EFFECTIVE_FROM | LOAD_DATE  | SOURCE |
      | md5('1002') | Bob           | 17-214-233-1215 | 12311     | md5('1002\|\|BOB\|\|17-214-233-1215\|\|12311')   | 1993-01-01     | 1993-01-01 | *      |
      | md5('1002') | Bob           | 17-214-233-1215 | 12312     | md5('1002\|\|BOB\|\|17-214-233-1215\|\|12312')   | 1993-01-01     | 1993-01-01 | *      |
      | md5('1002') | Bob           | 17-214-233-1215 | 12313     | md5('1002\|\|BOB\|\|17-214-233-1215\|\|12313')   | 1993-01-01     | 1993-01-01 | *      |
      | md5('1003') | Chad          | 17-214-233-1216 | 12321     | md5('1003\|\|CHAD\|\|17-214-233-1216\|\|12321')  | 1993-01-01     | 1993-01-01 | *      |
      | md5('1003') | Chad          | 17-214-233-1216 | 12322     | md5('1003\|\|CHAD\|\|17-214-233-1216\|\|12322')  | 1993-01-01     | 1993-01-01 | *      |
      | md5('1003') | Chad          | 17-214-233-1216 | 12323     | md5('1003\|\|CHAD\|\|17-214-233-1216\|\|12323')  | 1993-01-01     | 1993-01-01 | *      |
      | md5('1004') | Dom           | 17-214-233-1217 | 12331     | md5('1004\|\|DOM\|\|17-214-233-1217\|\|12331')   | 1993-01-01     | 1993-01-01 | *      |
      | md5('1004') | Dom           | 17-214-233-1227 | 12331     | md5('1004\|\|DOM\|\|17-214-233-1227\|\|12331')   | 1993-01-01     | 1993-01-01 | *      |
      | md5('1004') | Dom           | 17-214-233-1237 | 12331     | md5('1004\|\|DOM\|\|17-214-233-1237\|\|12331')   | 1993-01-01     | 1993-01-01 | *      |
      | md5('1006') | Frida         | 17-214-233-1214 | 12341     | md5('1006\|\|FRIDA\|\|17-214-233-1214\|\|12341') | 1993-01-01     | 1993-01-01 | *      |
      | md5('1006') | Frida         | 17-214-233-1224 | 12341     | md5('1006\|\|FRIDA\|\|17-214-233-1224\|\|12341') | 1993-01-01     | 1993-01-01 | *      |
      | md5('1006') | Frida         | 17-214-233-1234 | 12341     | md5('1006\|\|FRIDA\|\|17-214-233-1234\|\|12341') | 1993-01-01     | 1993-01-01 | *      |

    And the RAW_STAGE_TWO_CDK table contains data
      | CUSTOMER_ID | CUSTOMER_NAME | CUSTOMER_PHONE  | EXTENSION | LOAD_DATE  | SOURCE |
      | 1003        | Chad          | 17-214-233-1216 | 12321     | 1993-01-02 | *      |
      | 1003        | Chad          | 17-214-233-1216 | 12322     | 1993-01-02 | *      |
      | 1003        | Chad          | 17-214-233-1216 | 12323     | 1993-01-02 | *      |
      | 1003        | Chad          | 17-214-233-1216 | 12324     | 1993-01-02 | *      |
      | 1004        | Dom           | 17-214-233-1217 | 12331     | 1993-01-02 | *      |
      | 1004        | Dom           | 17-214-233-1227 | 12331     | 1993-01-02 | *      |
      | 1004        | Dom           | 17-214-233-1237 | 12331     | 1993-01-02 | *      |
      | 1004        | Dom           | 17-214-233-1247 | 12331     | 1993-01-02 | *      |
      | 1004        | Dom           | 17-214-233-1257 | 12331     | 1993-01-02 | *      |

    And I stage the STG_CUSTOMER_TWO_CDK data
    When I load the MULTI_ACTIVE_SATELLITE_TWO_CDK ma_sat
    Then the MULTI_ACTIVE_SATELLITE_TWO_CDK table should contain expected data
      | CUSTOMER_PK | CUSTOMER_NAME | CUSTOMER_PHONE  | EXTENSION | HASHDIFF                                         | EFFECTIVE_FROM | LOAD_DATE  | SOURCE |
      | md5('1002') | Bob           | 17-214-233-1215 | 12311     | md5('1002\|\|BOB\|\|17-214-233-1215\|\|12311')   | 1993-01-01     | 1993-01-01 | *      |
      | md5('1002') | Bob           | 17-214-233-1215 | 12312     | md5('1002\|\|BOB\|\|17-214-233-1215\|\|12312')   | 1993-01-01     | 1993-01-01 | *      |
      | md5('1002') | Bob           | 17-214-233-1215 | 12313     | md5('1002\|\|BOB\|\|17-214-233-1215\|\|12313')   | 1993-01-01     | 1993-01-01 | *      |
      | md5('1003') | Chad          | 17-214-233-1216 | 12321     | md5('1003\|\|CHAD\|\|17-214-233-1216\|\|12321')  | 1993-01-01     | 1993-01-01 | *      |
      | md5('1003') | Chad          | 17-214-233-1216 | 12322     | md5('1003\|\|CHAD\|\|17-214-233-1216\|\|12322')  | 1993-01-01     | 1993-01-01 | *      |
      | md5('1003') | Chad          | 17-214-233-1216 | 12323     | md5('1003\|\|CHAD\|\|17-214-233-1216\|\|12323')  | 1993-01-01     | 1993-01-01 | *      |
      | md5('1004') | Dom           | 17-214-233-1217 | 12331     | md5('1004\|\|DOM\|\|17-214-233-1217\|\|12331')   | 1993-01-01     | 1993-01-01 | *      |
      | md5('1004') | Dom           | 17-214-233-1227 | 12331     | md5('1004\|\|DOM\|\|17-214-233-1227\|\|12331')   | 1993-01-01     | 1993-01-01 | *      |
      | md5('1004') | Dom           | 17-214-233-1237 | 12331     | md5('1004\|\|DOM\|\|17-214-233-1237\|\|12331')   | 1993-01-01     | 1993-01-01 | *      |
      | md5('1006') | Frida         | 17-214-233-1214 | 12341     | md5('1006\|\|FRIDA\|\|17-214-233-1214\|\|12341') | 1993-01-01     | 1993-01-01 | *      |
      | md5('1006') | Frida         | 17-214-233-1224 | 12341     | md5('1006\|\|FRIDA\|\|17-214-233-1224\|\|12341') | 1993-01-01     | 1993-01-01 | *      |
      | md5('1006') | Frida         | 17-214-233-1234 | 12341     | md5('1006\|\|FRIDA\|\|17-214-233-1234\|\|12341') | 1993-01-01     | 1993-01-01 | *      |
      | md5('1003') | Chad          | 17-214-233-1216 | 12321     | md5('1003\|\|CHAD\|\|17-214-233-1216\|\|12321')  | 1993-01-02     | 1993-01-02 | *      |
      | md5('1003') | Chad          | 17-214-233-1216 | 12322     | md5('1003\|\|CHAD\|\|17-214-233-1216\|\|12322')  | 1993-01-02     | 1993-01-02 | *      |
      | md5('1003') | Chad          | 17-214-233-1216 | 12323     | md5('1003\|\|CHAD\|\|17-214-233-1216\|\|12323')  | 1993-01-02     | 1993-01-02 | *      |
      | md5('1003') | Chad          | 17-214-233-1216 | 12324     | md5('1003\|\|CHAD\|\|17-214-233-1216\|\|12324')  | 1993-01-02     | 1993-01-02 | *      |
      | md5('1004') | Dom           | 17-214-233-1217 | 12331     | md5('1004\|\|DOM\|\|17-214-233-1217\|\|12331')   | 1993-01-02     | 1993-01-02 | *      |
      | md5('1004') | Dom           | 17-214-233-1227 | 12331     | md5('1004\|\|DOM\|\|17-214-233-1227\|\|12331')   | 1993-01-02     | 1993-01-02 | *      |
      | md5('1004') | Dom           | 17-214-233-1237 | 12331     | md5('1004\|\|DOM\|\|17-214-233-1237\|\|12331')   | 1993-01-02     | 1993-01-02 | *      |
      | md5('1004') | Dom           | 17-214-233-1247 | 12331     | md5('1004\|\|DOM\|\|17-214-233-1247\|\|12331')   | 1993-01-02     | 1993-01-02 | *      |
      | md5('1004') | Dom           | 17-214-233-1257 | 12331     | md5('1004\|\|DOM\|\|17-214-233-1257\|\|12331')   | 1993-01-02     | 1993-01-02 | *      |

  @fixture.multi_active_satellite
  Scenario: [BQ-MAS-2CD-I-05] Load data into a populated multi-active satellite where sets maintain group size after records have been added and removed in the stage
    Given the MULTI_ACTIVE_SATELLITE_TWO_CDK ma_sat is already populated with data
      | CUSTOMER_PK | CUSTOMER_NAME | CUSTOMER_PHONE  | EXTENSION | HASHDIFF                                         | EFFECTIVE_FROM | LOAD_DATE  | SOURCE |
      | md5('1002') | Bob           | 17-214-233-1215 | 12311     | md5('1002\|\|BOB\|\|17-214-233-1215\|\|12311')   | 1993-01-01     | 1993-01-01 | *      |
      | md5('1002') | Bob           | 17-214-233-1215 | 12312     | md5('1002\|\|BOB\|\|17-214-233-1215\|\|12312')   | 1993-01-01     | 1993-01-01 | *      |
      | md5('1002') | Bob           | 17-214-233-1215 | 12313     | md5('1002\|\|BOB\|\|17-214-233-1215\|\|12313')   | 1993-01-01     | 1993-01-01 | *      |
      | md5('1003') | Chad          | 17-214-233-1216 | 12321     | md5('1003\|\|CHAD\|\|17-214-233-1216\|\|12321')  | 1993-01-01     | 1993-01-01 | *      |
      | md5('1003') | Chad          | 17-214-233-1216 | 12322     | md5('1003\|\|CHAD\|\|17-214-233-1216\|\|12322')  | 1993-01-01     | 1993-01-01 | *      |
      | md5('1003') | Chad          | 17-214-233-1216 | 12323     | md5('1003\|\|CHAD\|\|17-214-233-1216\|\|12323')  | 1993-01-01     | 1993-01-01 | *      |
      | md5('1004') | Dom           | 17-214-233-1217 | 12331     | md5('1004\|\|DOM\|\|17-214-233-1217\|\|12331')   | 1993-01-01     | 1993-01-01 | *      |
      | md5('1004') | Dom           | 17-214-233-1227 | 12331     | md5('1004\|\|DOM\|\|17-214-233-1227\|\|12331')   | 1993-01-01     | 1993-01-01 | *      |
      | md5('1004') | Dom           | 17-214-233-1237 | 12331     | md5('1004\|\|DOM\|\|17-214-233-1237\|\|12331')   | 1993-01-01     | 1993-01-01 | *      |
      | md5('1006') | Frida         | 17-214-233-1214 | 12341     | md5('1006\|\|FRIDA\|\|17-214-233-1214\|\|12341') | 1993-01-01     | 1993-01-01 | *      |
      | md5('1006') | Frida         | 17-214-233-1224 | 12341     | md5('1006\|\|FRIDA\|\|17-214-233-1224\|\|12341') | 1993-01-01     | 1993-01-01 | *      |
      | md5('1006') | Frida         | 17-214-233-1234 | 12341     | md5('1006\|\|FRIDA\|\|17-214-233-1234\|\|12341') | 1993-01-01     | 1993-01-01 | *      |

    And the RAW_STAGE_TWO_CDK table contains data
      | CUSTOMER_ID | CUSTOMER_NAME | CUSTOMER_PHONE  | EXTENSION | LOAD_DATE  | SOURCE |
      | 1002        | Bob           | 17-214-233-1215 | 12311     | 1993-01-02 | *      |
      | 1002        | Bob           | 17-214-233-1215 | 12312     | 1993-01-02 | *      |
      | 1002        | Bob           | 17-214-233-1215 | 12314     | 1993-01-02 | *      |
      | 1003        | Chad          | 17-214-233-1216 | 12321     | 1993-01-02 | *      |
      | 1003        | Chad          | 17-214-233-1216 | 12324     | 1993-01-02 | *      |
      | 1003        | Chad          | 17-214-233-1216 | 12325     | 1993-01-02 | *      |
      | 1004        | Dom           | 17-214-233-1217 | 12331     | 1993-01-02 | *      |
      | 1004        | Dom           | 17-214-233-1227 | 12331     | 1993-01-02 | *      |
      | 1004        | Dom           | 17-214-233-1247 | 12331     | 1993-01-02 | *      |
      | 1006        | Frida         | 17-214-233-1214 | 12341     | 1993-01-02 | *      |
      | 1006        | Frida         | 17-214-233-1244 | 12341     | 1993-01-02 | *      |
      | 1006        | Frida         | 17-214-233-1254 | 12341     | 1993-01-02 | *      |

    And I stage the STG_CUSTOMER_TWO_CDK data
    When I load the MULTI_ACTIVE_SATELLITE_TWO_CDK ma_sat
    Then the MULTI_ACTIVE_SATELLITE_TWO_CDK table should contain expected data
      | CUSTOMER_PK | CUSTOMER_NAME | CUSTOMER_PHONE  | EXTENSION | HASHDIFF                                         | EFFECTIVE_FROM | LOAD_DATE  | SOURCE |
      | md5('1002') | Bob           | 17-214-233-1215 | 12311     | md5('1002\|\|BOB\|\|17-214-233-1215\|\|12311')   | 1993-01-01     | 1993-01-01 | *      |
      | md5('1002') | Bob           | 17-214-233-1215 | 12312     | md5('1002\|\|BOB\|\|17-214-233-1215\|\|12312')   | 1993-01-01     | 1993-01-01 | *      |
      | md5('1002') | Bob           | 17-214-233-1215 | 12313     | md5('1002\|\|BOB\|\|17-214-233-1215\|\|12313')   | 1993-01-01     | 1993-01-01 | *      |
      | md5('1003') | Chad          | 17-214-233-1216 | 12321     | md5('1003\|\|CHAD\|\|17-214-233-1216\|\|12321')  | 1993-01-01     | 1993-01-01 | *      |
      | md5('1003') | Chad          | 17-214-233-1216 | 12322     | md5('1003\|\|CHAD\|\|17-214-233-1216\|\|12322')  | 1993-01-01     | 1993-01-01 | *      |
      | md5('1003') | Chad          | 17-214-233-1216 | 12323     | md5('1003\|\|CHAD\|\|17-214-233-1216\|\|12323')  | 1993-01-01     | 1993-01-01 | *      |
      | md5('1004') | Dom           | 17-214-233-1217 | 12331     | md5('1004\|\|DOM\|\|17-214-233-1217\|\|12331')   | 1993-01-01     | 1993-01-01 | *      |
      | md5('1004') | Dom           | 17-214-233-1227 | 12331     | md5('1004\|\|DOM\|\|17-214-233-1227\|\|12331')   | 1993-01-01     | 1993-01-01 | *      |
      | md5('1004') | Dom           | 17-214-233-1237 | 12331     | md5('1004\|\|DOM\|\|17-214-233-1237\|\|12331')   | 1993-01-01     | 1993-01-01 | *      |
      | md5('1006') | Frida         | 17-214-233-1214 | 12341     | md5('1006\|\|FRIDA\|\|17-214-233-1214\|\|12341') | 1993-01-01     | 1993-01-01 | *      |
      | md5('1006') | Frida         | 17-214-233-1224 | 12341     | md5('1006\|\|FRIDA\|\|17-214-233-1224\|\|12341') | 1993-01-01     | 1993-01-01 | *      |
      | md5('1006') | Frida         | 17-214-233-1234 | 12341     | md5('1006\|\|FRIDA\|\|17-214-233-1234\|\|12341') | 1993-01-01     | 1993-01-01 | *      |
      | md5('1002') | Bob           | 17-214-233-1215 | 12311     | md5('1002\|\|BOB\|\|17-214-233-1215\|\|12311')   | 1993-01-02     | 1993-01-02 | *      |
      | md5('1002') | Bob           | 17-214-233-1215 | 12312     | md5('1002\|\|BOB\|\|17-214-233-1215\|\|12312')   | 1993-01-02     | 1993-01-02 | *      |
      | md5('1002') | Bob           | 17-214-233-1215 | 12314     | md5('1002\|\|BOB\|\|17-214-233-1215\|\|12314')   | 1993-01-02     | 1993-01-02 | *      |
      | md5('1003') | Chad          | 17-214-233-1216 | 12321     | md5('1003\|\|CHAD\|\|17-214-233-1216\|\|12321')  | 1993-01-02     | 1993-01-02 | *      |
      | md5('1003') | Chad          | 17-214-233-1216 | 12324     | md5('1003\|\|CHAD\|\|17-214-233-1216\|\|12324')  | 1993-01-02     | 1993-01-02 | *      |
      | md5('1003') | Chad          | 17-214-233-1216 | 12325     | md5('1003\|\|CHAD\|\|17-214-233-1216\|\|12325')  | 1993-01-02     | 1993-01-02 | *      |
      | md5('1004') | Dom           | 17-214-233-1217 | 12331     | md5('1004\|\|DOM\|\|17-214-233-1217\|\|12331')   | 1993-01-02     | 1993-01-02 | *      |
      | md5('1004') | Dom           | 17-214-233-1227 | 12331     | md5('1004\|\|DOM\|\|17-214-233-1227\|\|12331')   | 1993-01-02     | 1993-01-02 | *      |
      | md5('1004') | Dom           | 17-214-233-1247 | 12331     | md5('1004\|\|DOM\|\|17-214-233-1247\|\|12331')   | 1993-01-02     | 1993-01-02 | *      |
      | md5('1006') | Frida         | 17-214-233-1214 | 12341     | md5('1006\|\|FRIDA\|\|17-214-233-1214\|\|12341') | 1993-01-02     | 1993-01-02 | *      |
      | md5('1006') | Frida         | 17-214-233-1244 | 12341     | md5('1006\|\|FRIDA\|\|17-214-233-1244\|\|12341') | 1993-01-02     | 1993-01-02 | *      |
      | md5('1006') | Frida         | 17-214-233-1254 | 12341     | md5('1006\|\|FRIDA\|\|17-214-233-1254\|\|12341') | 1993-01-02     | 1993-01-02 | *      |

  @fixture.multi_active_satellite
  Scenario: [BQ-MAS-2CD-I-06] Load data into a populated multi-active satellite where sets maintain group size but some records have different hashdiffs
    Given the MULTI_ACTIVE_SATELLITE_TWO_CDK ma_sat is already populated with data
      | CUSTOMER_PK | CUSTOMER_NAME | CUSTOMER_PHONE  | EXTENSION | HASHDIFF                                         | EFFECTIVE_FROM | LOAD_DATE  | SOURCE |
      | md5('1002') | Bob           | 17-214-233-1215 | 12311     | md5('1002\|\|BOB\|\|17-214-233-1215\|\|12311')   | 1993-01-01     | 1993-01-01 | *      |
      | md5('1002') | Bob           | 17-214-233-1215 | 12312     | md5('1002\|\|BOB\|\|17-214-233-1215\|\|12312')   | 1993-01-01     | 1993-01-01 | *      |
      | md5('1002') | Bob           | 17-214-233-1215 | 12313     | md5('1002\|\|BOB\|\|17-214-233-1215\|\|12313')   | 1993-01-01     | 1993-01-01 | *      |
      | md5('1003') | Chad          | 17-214-233-1216 | 12321     | md5('1003\|\|CHAD\|\|17-214-233-1216\|\|12321')  | 1993-01-01     | 1993-01-01 | *      |
      | md5('1003') | Chad          | 17-214-233-1216 | 12322     | md5('1003\|\|CHAD\|\|17-214-233-1216\|\|12322')  | 1993-01-01     | 1993-01-01 | *      |
      | md5('1003') | Chad          | 17-214-233-1216 | 12323     | md5('1003\|\|CHAD\|\|17-214-233-1216\|\|12323')  | 1993-01-01     | 1993-01-01 | *      |
      | md5('1004') | Dom           | 17-214-233-1217 | 12331     | md5('1004\|\|DOM\|\|17-214-233-1217\|\|12331')   | 1993-01-01     | 1993-01-01 | *      |
      | md5('1004') | Dom           | 17-214-233-1227 | 12331     | md5('1004\|\|DOM\|\|17-214-233-1227\|\|12331')   | 1993-01-01     | 1993-01-01 | *      |
      | md5('1004') | Dom           | 17-214-233-1237 | 12331     | md5('1004\|\|DOM\|\|17-214-233-1237\|\|12331')   | 1993-01-01     | 1993-01-01 | *      |
      | md5('1006') | Frida         | 17-214-233-1214 | 12341     | md5('1006\|\|FRIDA\|\|17-214-233-1214\|\|12341') | 1993-01-01     | 1993-01-01 | *      |
      | md5('1006') | Frida         | 17-214-233-1224 | 12341     | md5('1006\|\|FRIDA\|\|17-214-233-1224\|\|12341') | 1993-01-01     | 1993-01-01 | *      |
      | md5('1006') | Frida         | 17-214-233-1234 | 12341     | md5('1006\|\|FRIDA\|\|17-214-233-1234\|\|12341') | 1993-01-01     | 1993-01-01 | *      |

    And the RAW_STAGE_TWO_CDK table contains data
      | CUSTOMER_ID | CUSTOMER_NAME | CUSTOMER_PHONE  | EXTENSION | LOAD_DATE  | SOURCE |
      | 1003        | Chad          | 17-214-233-1316 | 12321     | 1993-01-02 | *      |
      | 1003        | Chad          | 17-214-233-1216 | 12322     | 1993-01-02 | *      |
      | 1003        | Chad          | 17-214-233-1216 | 12323     | 1993-01-02 | *      |
      | 1004        | Dom           | 17-214-233-1217 | 92331     | 1993-01-02 | *      |
      | 1004        | Dom           | 17-214-233-1227 | 12331     | 1993-01-02 | *      |
      | 1004        | Dom           | 17-214-233-1237 | 12331     | 1993-01-02 | *      |
      | 1006        | Fridax        | 17-214-233-1214 | 12341     | 1993-01-02 | *      |
      | 1006        | Frida         | 17-214-233-1224 | 12341     | 1993-01-02 | *      |
      | 1006        | Frida         | 17-214-233-1234 | 12341     | 1993-01-02 | *      |
    And I stage the STG_CUSTOMER_TWO_CDK data
    When I load the MULTI_ACTIVE_SATELLITE_TWO_CDK ma_sat
    Then the MULTI_ACTIVE_SATELLITE_TWO_CDK table should contain expected data
      | CUSTOMER_PK | CUSTOMER_NAME | CUSTOMER_PHONE  | EXTENSION | HASHDIFF                                          | EFFECTIVE_FROM | LOAD_DATE  | SOURCE |
      | md5('1002') | Bob           | 17-214-233-1215 | 12311     | md5('1002\|\|BOB\|\|17-214-233-1215\|\|12311')    | 1993-01-01     | 1993-01-01 | *      |
      | md5('1002') | Bob           | 17-214-233-1215 | 12312     | md5('1002\|\|BOB\|\|17-214-233-1215\|\|12312')    | 1993-01-01     | 1993-01-01 | *      |
      | md5('1002') | Bob           | 17-214-233-1215 | 12313     | md5('1002\|\|BOB\|\|17-214-233-1215\|\|12313')    | 1993-01-01     | 1993-01-01 | *      |
      | md5('1003') | Chad          | 17-214-233-1216 | 12321     | md5('1003\|\|CHAD\|\|17-214-233-1216\|\|12321')   | 1993-01-01     | 1993-01-01 | *      |
      | md5('1003') | Chad          | 17-214-233-1216 | 12322     | md5('1003\|\|CHAD\|\|17-214-233-1216\|\|12322')   | 1993-01-01     | 1993-01-01 | *      |
      | md5('1003') | Chad          | 17-214-233-1216 | 12323     | md5('1003\|\|CHAD\|\|17-214-233-1216\|\|12323')   | 1993-01-01     | 1993-01-01 | *      |
      | md5('1004') | Dom           | 17-214-233-1217 | 12331     | md5('1004\|\|DOM\|\|17-214-233-1217\|\|12331')    | 1993-01-01     | 1993-01-01 | *      |
      | md5('1004') | Dom           | 17-214-233-1227 | 12331     | md5('1004\|\|DOM\|\|17-214-233-1227\|\|12331')    | 1993-01-01     | 1993-01-01 | *      |
      | md5('1004') | Dom           | 17-214-233-1237 | 12331     | md5('1004\|\|DOM\|\|17-214-233-1237\|\|12331')    | 1993-01-01     | 1993-01-01 | *      |
      | md5('1006') | Frida         | 17-214-233-1214 | 12341     | md5('1006\|\|FRIDA\|\|17-214-233-1214\|\|12341')  | 1993-01-01     | 1993-01-01 | *      |
      | md5('1006') | Frida         | 17-214-233-1224 | 12341     | md5('1006\|\|FRIDA\|\|17-214-233-1224\|\|12341')  | 1993-01-01     | 1993-01-01 | *      |
      | md5('1006') | Frida         | 17-214-233-1234 | 12341     | md5('1006\|\|FRIDA\|\|17-214-233-1234\|\|12341')  | 1993-01-01     | 1993-01-01 | *      |
      | md5('1003') | Chad          | 17-214-233-1316 | 12321     | md5('1003\|\|CHAD\|\|17-214-233-1316\|\|12321')   | 1993-01-02     | 1993-01-02 | *      |
      | md5('1003') | Chad          | 17-214-233-1216 | 12322     | md5('1003\|\|CHAD\|\|17-214-233-1216\|\|12322')   | 1993-01-02     | 1993-01-02 | *      |
      | md5('1003') | Chad          | 17-214-233-1216 | 12323     | md5('1003\|\|CHAD\|\|17-214-233-1216\|\|12323')   | 1993-01-02     | 1993-01-02 | *      |
      | md5('1004') | Dom           | 17-214-233-1217 | 92331     | md5('1004\|\|DOM\|\|17-214-233-1217\|\|92331')    | 1993-01-02     | 1993-01-02 | *      |
      | md5('1004') | Dom           | 17-214-233-1227 | 12331     | md5('1004\|\|DOM\|\|17-214-233-1227\|\|12331')    | 1993-01-02     | 1993-01-02 | *      |
      | md5('1004') | Dom           | 17-214-233-1237 | 12331     | md5('1004\|\|DOM\|\|17-214-233-1237\|\|12331')    | 1993-01-02     | 1993-01-02 | *      |
      | md5('1006') | Fridax        | 17-214-233-1214 | 12341     | md5('1006\|\|FRIDAX\|\|17-214-233-1214\|\|12341') | 1993-01-02     | 1993-01-02 | *      |
      | md5('1006') | Frida         | 17-214-233-1224 | 12341     | md5('1006\|\|FRIDA\|\|17-214-233-1224\|\|12341')  | 1993-01-02     | 1993-01-02 | *      |
      | md5('1006') | Frida         | 17-214-233-1234 | 12341     | md5('1006\|\|FRIDA\|\|17-214-233-1234\|\|12341')  | 1993-01-02     | 1993-01-02 | *      |

  @fixture.multi_active_satellite
  Scenario: [BQ-MAS-2CD-I-07] Load data into a populated multi-active satellite where sets of records have varying group size and some have different hashdiffs
    Given the MULTI_ACTIVE_SATELLITE_TWO_CDK ma_sat is already populated with data
      | CUSTOMER_PK | CUSTOMER_NAME | CUSTOMER_PHONE  | EXTENSION | HASHDIFF                                         | EFFECTIVE_FROM | LOAD_DATE  | SOURCE |
      | md5('1002') | Bob           | 17-214-233-1215 | 12311     | md5('1002\|\|BOB\|\|17-214-233-1215\|\|12311')   | 1993-01-01     | 1993-01-01 | *      |
      | md5('1002') | Bob           | 17-214-233-1215 | 12312     | md5('1002\|\|BOB\|\|17-214-233-1215\|\|12312')   | 1993-01-01     | 1993-01-01 | *      |
      | md5('1002') | Bob           | 17-214-233-1215 | 12313     | md5('1002\|\|BOB\|\|17-214-233-1215\|\|12313')   | 1993-01-01     | 1993-01-01 | *      |
      | md5('1003') | Chad          | 17-214-233-1216 | 12321     | md5('1003\|\|CHAD\|\|17-214-233-1216\|\|12321')  | 1993-01-01     | 1993-01-01 | *      |
      | md5('1003') | Chad          | 17-214-233-1216 | 12322     | md5('1003\|\|CHAD\|\|17-214-233-1216\|\|12322')  | 1993-01-01     | 1993-01-01 | *      |
      | md5('1003') | Chad          | 17-214-233-1216 | 12323     | md5('1003\|\|CHAD\|\|17-214-233-1216\|\|12323')  | 1993-01-01     | 1993-01-01 | *      |
      | md5('1004') | Dom           | 17-214-233-1217 | 12331     | md5('1004\|\|DOM\|\|17-214-233-1217\|\|12331')   | 1993-01-01     | 1993-01-01 | *      |
      | md5('1004') | Dom           | 17-214-233-1227 | 12331     | md5('1004\|\|DOM\|\|17-214-233-1227\|\|12331')   | 1993-01-01     | 1993-01-01 | *      |
      | md5('1004') | Dom           | 17-214-233-1237 | 12331     | md5('1004\|\|DOM\|\|17-214-233-1237\|\|12331')   | 1993-01-01     | 1993-01-01 | *      |
      | md5('1005') | Eric          | 17-214-233-1218 | 12331     | md5('1004\|\|ERIC\|\|17-214-233-1218\|\|12331')  | 1993-01-01     | 1993-01-01 | *      |
      | md5('1005') | Eric          | 17-214-233-1228 | 12331     | md5('1004\|\|ERIC\|\|17-214-233-1228\|\|12331')  | 1993-01-01     | 1993-01-01 | *      |
      | md5('1005') | Eric          | 17-214-233-1238 | 12331     | md5('1004\|\|ERIC\|\|17-214-233-1238\|\|12331')  | 1993-01-01     | 1993-01-01 | *      |
      | md5('1006') | Frida         | 17-214-233-1214 | 12341     | md5('1006\|\|FRIDA\|\|17-214-233-1214\|\|12341') | 1993-01-01     | 1993-01-01 | *      |
      | md5('1006') | Frida         | 17-214-233-1224 | 12341     | md5('1006\|\|FRIDA\|\|17-214-233-1224\|\|12341') | 1993-01-01     | 1993-01-01 | *      |
      | md5('1006') | Frida         | 17-214-233-1234 | 12341     | md5('1006\|\|FRIDA\|\|17-214-233-1234\|\|12341') | 1993-01-01     | 1993-01-01 | *      |

    And the RAW_STAGE_TWO_CDK table contains data
      | CUSTOMER_ID | CUSTOMER_NAME | CUSTOMER_PHONE  | EXTENSION | LOAD_DATE  | SOURCE |
      | 1001        | Alice         | 17-214-233-1214 | 12301     | 1993-01-02 | *      |
      | 1001        | Alice         | 17-214-233-1214 | 12302     | 1993-01-02 | *      |
      | 1001        | Alice         | 17-214-233-1214 | 12303     | 1993-01-02 | *      |
      | 1002        | Bob           | 17-214-233-1215 | 12311     | 1993-01-02 | *      |
      | 1002        | Bob           | 17-214-233-1215 | 12312     | 1993-01-02 | *      |
      | 1003        | Chad          | 17-214-233-1216 | 12321     | 1993-01-02 | *      |
      | 1003        | Chad          | 17-214-233-1216 | 12322     | 1993-01-02 | *      |
      | 1003        | Chad          | 17-214-233-1216 | 12323     | 1993-01-02 | *      |
      | 1003        | Chad          | 17-214-233-1216 | 12324     | 1993-01-02 | *      |
      | 1004        | Dom           | 17-214-233-1217 | 12331     | 1993-01-02 | *      |
      | 1004        | Dom           | 17-214-233-1227 | 12331     | 1993-01-02 | *      |
      | 1005        | Eric          | 17-214-233-1218 | 92351     | 1993-01-02 | *      |
      | 1005        | Eric          | 17-214-233-1228 | 12351     | 1993-01-02 | *      |
      | 1005        | Eric          | 17-214-233-1238 | 12351     | 1993-01-02 | *      |
      | 1006        | Frida         | 17-214-233-1214 | 12341     | 1993-01-02 | *      |
      | 1006        | Fridax        | 17-214-233-1224 | 12341     | 1993-01-02 | *      |
      | 1006        | Frida         | 17-214-233-1234 | 12341     | 1993-01-02 | *      |

    And I stage the STG_CUSTOMER_TWO_CDK data
    When I load the MULTI_ACTIVE_SATELLITE_TWO_CDK ma_sat
    Then the MULTI_ACTIVE_SATELLITE_TWO_CDK table should contain expected data
      | CUSTOMER_PK | CUSTOMER_NAME | CUSTOMER_PHONE  | EXTENSION | HASHDIFF                                          | EFFECTIVE_FROM | LOAD_DATE  | SOURCE |
      | md5('1002') | Bob           | 17-214-233-1215 | 12311     | md5('1002\|\|BOB\|\|17-214-233-1215\|\|12311')    | 1993-01-01     | 1993-01-01 | *      |
      | md5('1002') | Bob           | 17-214-233-1215 | 12312     | md5('1002\|\|BOB\|\|17-214-233-1215\|\|12312')    | 1993-01-01     | 1993-01-01 | *      |
      | md5('1002') | Bob           | 17-214-233-1215 | 12313     | md5('1002\|\|BOB\|\|17-214-233-1215\|\|12313')    | 1993-01-01     | 1993-01-01 | *      |
      | md5('1003') | Chad          | 17-214-233-1216 | 12321     | md5('1003\|\|CHAD\|\|17-214-233-1216\|\|12321')   | 1993-01-01     | 1993-01-01 | *      |
      | md5('1003') | Chad          | 17-214-233-1216 | 12322     | md5('1003\|\|CHAD\|\|17-214-233-1216\|\|12322')   | 1993-01-01     | 1993-01-01 | *      |
      | md5('1003') | Chad          | 17-214-233-1216 | 12323     | md5('1003\|\|CHAD\|\|17-214-233-1216\|\|12323')   | 1993-01-01     | 1993-01-01 | *      |
      | md5('1004') | Dom           | 17-214-233-1217 | 12331     | md5('1004\|\|DOM\|\|17-214-233-1217\|\|12331')    | 1993-01-01     | 1993-01-01 | *      |
      | md5('1004') | Dom           | 17-214-233-1227 | 12331     | md5('1004\|\|DOM\|\|17-214-233-1227\|\|12331')    | 1993-01-01     | 1993-01-01 | *      |
      | md5('1004') | Dom           | 17-214-233-1237 | 12331     | md5('1004\|\|DOM\|\|17-214-233-1237\|\|12331')    | 1993-01-01     | 1993-01-01 | *      |
      | md5('1005') | Eric          | 17-214-233-1218 | 12331     | md5('1004\|\|ERIC\|\|17-214-233-1218\|\|12331')   | 1993-01-01     | 1993-01-01 | *      |
      | md5('1005') | Eric          | 17-214-233-1228 | 12331     | md5('1004\|\|ERIC\|\|17-214-233-1228\|\|12331')   | 1993-01-01     | 1993-01-01 | *      |
      | md5('1005') | Eric          | 17-214-233-1238 | 12331     | md5('1004\|\|ERIC\|\|17-214-233-1238\|\|12331')   | 1993-01-01     | 1993-01-01 | *      |
      | md5('1006') | Frida         | 17-214-233-1214 | 12341     | md5('1006\|\|FRIDA\|\|17-214-233-1214\|\|12341')  | 1993-01-01     | 1993-01-01 | *      |
      | md5('1006') | Frida         | 17-214-233-1224 | 12341     | md5('1006\|\|FRIDA\|\|17-214-233-1224\|\|12341')  | 1993-01-01     | 1993-01-01 | *      |
      | md5('1006') | Frida         | 17-214-233-1234 | 12341     | md5('1006\|\|FRIDA\|\|17-214-233-1234\|\|12341')  | 1993-01-01     | 1993-01-01 | *      |
      | md5('1001') | Alice         | 17-214-233-1214 | 12301     | md5('1001\|\|ALICE\|\|17-214-233-1214\|\|12301')  | 1993-01-02     | 1993-01-02 | *      |
      | md5('1001') | Alice         | 17-214-233-1214 | 12302     | md5('1001\|\|ALICE\|\|17-214-233-1214\|\|12302')  | 1993-01-02     | 1993-01-02 | *      |
      | md5('1001') | Alice         | 17-214-233-1214 | 12303     | md5('1001\|\|ALICE\|\|17-214-233-1214\|\|12303')  | 1993-01-02     | 1993-01-02 | *      |
      | md5('1002') | Bob           | 17-214-233-1215 | 12311     | md5('1002\|\|BOB\|\|17-214-233-1215\|\|12311')    | 1993-01-02     | 1993-01-02 | *      |
      | md5('1002') | Bob           | 17-214-233-1215 | 12312     | md5('1002\|\|BOB\|\|17-214-233-1215\|\|12312')    | 1993-01-02     | 1993-01-02 | *      |
      | md5('1003') | Chad          | 17-214-233-1216 | 12321     | md5('1003\|\|CHAD\|\|17-214-233-1216\|\|12321')   | 1993-01-02     | 1993-01-02 | *      |
      | md5('1003') | Chad          | 17-214-233-1216 | 12322     | md5('1003\|\|CHAD\|\|17-214-233-1216\|\|12322')   | 1993-01-02     | 1993-01-02 | *      |
      | md5('1003') | Chad          | 17-214-233-1216 | 12323     | md5('1003\|\|CHAD\|\|17-214-233-1216\|\|12323')   | 1993-01-02     | 1993-01-02 | *      |
      | md5('1003') | Chad          | 17-214-233-1216 | 12324     | md5('1003\|\|CHAD\|\|17-214-233-1216\|\|12324')   | 1993-01-02     | 1993-01-02 | *      |
      | md5('1004') | Dom           | 17-214-233-1217 | 12331     | md5('1004\|\|DOM\|\|17-214-233-1217\|\|12331')    | 1993-01-02     | 1993-01-02 | *      |
      | md5('1004') | Dom           | 17-214-233-1227 | 12331     | md5('1004\|\|DOM\|\|17-214-233-1227\|\|12331')    | 1993-01-02     | 1993-01-02 | *      |
      | md5('1005') | Eric          | 17-214-233-1218 | 92351     | md5('1005\|\|ERIC\|\|17-214-233-1218\|\|92351')   | 1993-01-02     | 1993-01-02 | *      |
      | md5('1005') | Eric          | 17-214-233-1228 | 12351     | md5('1005\|\|ERIC\|\|17-214-233-1228\|\|12351')   | 1993-01-02     | 1993-01-02 | *      |
      | md5('1005') | Eric          | 17-214-233-1238 | 12351     | md5('1005\|\|ERIC\|\|17-214-233-1238\|\|12351')   | 1993-01-02     | 1993-01-02 | *      |
      | md5('1006') | Frida         | 17-214-233-1214 | 12341     | md5('1006\|\|FRIDA\|\|17-214-233-1214\|\|12341')  | 1993-01-02     | 1993-01-02 | *      |
      | md5('1006') | Fridax        | 17-214-233-1224 | 12341     | md5('1006\|\|FRIDAX\|\|17-214-233-1224\|\|12341') | 1993-01-02     | 1993-01-02 | *      |
      | md5('1006') | Frida         | 17-214-233-1234 | 12341     | md5('1006\|\|FRIDA\|\|17-214-233-1234\|\|12341')  | 1993-01-02     | 1993-01-02 | *      |

  @fixture.multi_active_satellite
  Scenario: [BQ-MAS-2CD-I-08] Load data into a populated satellite where either the PK(s) or the CDK(s) are NULL - with existent PK(s)/CDK(s)
    Given the MULTI_ACTIVE_SATELLITE_TWO_CDK ma_sat is already populated with data
      | CUSTOMER_PK | CUSTOMER_NAME | CUSTOMER_PHONE  | EXTENSION | HASHDIFF                                         | EFFECTIVE_FROM | LOAD_DATE  | SOURCE |
      | md5('1002') | Bob           | 17-214-233-1212 | 12311     | md5('1002\|\|BOB\|\|17-214-233-1212\|\|12311')   | 1993-01-01     | 1993-01-01 | *      |
      | md5('1002') | Bob           | 17-214-233-1222 | 12311     | md5('1002\|\|BOB\|\|17-214-233-1222\|\|12311')   | 1993-01-01     | 1993-01-01 | *      |
      | md5('1002') | Bob           | 17-214-233-1232 | 12311     | md5('1002\|\|BOB\|\|17-214-233-1232\|\|12311')   | 1993-01-01     | 1993-01-01 | *      |
      | md5('1004') | Dom           | 17-214-233-1214 | 12321     | md5('1004\|\|DOM\|\|17-214-233-1214\|\|12321')   | 1993-01-01     | 1993-01-01 | *      |
      | md5('1004') | Dom           | 17-214-233-1214 | 12322     | md5('1004\|\|DOM\|\|17-214-233-1214\|\|12322')   | 1993-01-01     | 1993-01-01 | *      |
      | md5('1004') | Dom           | 17-214-233-1214 | 12323     | md5('1004\|\|DOM\|\|17-214-233-1214\|\|12323')   | 1993-01-01     | 1993-01-01 | *      |
      | md5('1006') | Frida         | 17-214-233-1216 | 12322     | md5('1006\|\|FRIDA\|\|17-214-233-1216\|\|12322') | 1993-01-01     | 1993-01-01 | *      |
      | md5('1008') | Jenny         | 17-214-233-1218 | 12311     | md5('1008\|\|JENNY\|\|17-214-233-1218\|\|12311') | 1993-01-01     | 1993-01-01 | *      |
    And the RAW_STAGE_TWO_CDK table contains data
      | CUSTOMER_ID | CUSTOMER_NAME | CUSTOMER_PHONE  | EXTENSION | LOAD_DATE  | SOURCE |
      | 1002        | <null>        | <null>          | <null>    | 1993-01-02 | *      |
      | <null>      | <null>        | <null>          | 12311     | 1993-01-02 | *      |
      | <null>      | <null>        | 17-214-233-1212 | <null>    | 1993-01-02 | *      |
      | <null>      | Bob           | <null>          | <null>    | 1993-01-02 | *      |
      | 1002        | Bob           | <null>          | <null>    | 1993-01-02 | *      |
      | <null>      | <null>        | 17-214-233-1212 | 12311     | 1993-01-02 | *      |
      | 1002        | <null>        | <null>          | 12311     | 1993-01-02 | *      |
      | <null>      | Bob           | 17-214-233-1212 | <null>    | 1993-01-02 | *      |
      | 1002        | Bob           | 17-214-233-1212 | <null>    | 1993-01-02 | *      |
      | 1002        | Bob           | <null>          | 12311     | 1993-01-02 | *      |
      | 1002        | <null>        | 17-214-233-1212 | 12311     | 1993-01-02 | *      |
      | <null>      | Bob           | 17-214-233-1212 | <null>    | 1993-01-02 | *      |
    And I stage the STG_CUSTOMER_TWO_CDK data
    When I load the MULTI_ACTIVE_SATELLITE_TWO_CDK ma_sat
    Then the MULTI_ACTIVE_SATELLITE_TWO_CDK table should contain expected data
      | CUSTOMER_PK | CUSTOMER_NAME | CUSTOMER_PHONE  | EXTENSION | HASHDIFF                                         | EFFECTIVE_FROM | LOAD_DATE  | SOURCE |
      | md5('1002') | Bob           | 17-214-233-1212 | 12311     | md5('1002\|\|BOB\|\|17-214-233-1212\|\|12311')   | 1993-01-01     | 1993-01-01 | *      |
      | md5('1002') | Bob           | 17-214-233-1222 | 12311     | md5('1002\|\|BOB\|\|17-214-233-1222\|\|12311')   | 1993-01-01     | 1993-01-01 | *      |
      | md5('1002') | Bob           | 17-214-233-1232 | 12311     | md5('1002\|\|BOB\|\|17-214-233-1232\|\|12311')   | 1993-01-01     | 1993-01-01 | *      |
      | md5('1004') | Dom           | 17-214-233-1214 | 12321     | md5('1004\|\|DOM\|\|17-214-233-1214\|\|12321')   | 1993-01-01     | 1993-01-01 | *      |
      | md5('1004') | Dom           | 17-214-233-1214 | 12322     | md5('1004\|\|DOM\|\|17-214-233-1214\|\|12322')   | 1993-01-01     | 1993-01-01 | *      |
      | md5('1004') | Dom           | 17-214-233-1214 | 12323     | md5('1004\|\|DOM\|\|17-214-233-1214\|\|12323')   | 1993-01-01     | 1993-01-01 | *      |
      | md5('1006') | Frida         | 17-214-233-1216 | 12322     | md5('1006\|\|FRIDA\|\|17-214-233-1216\|\|12322') | 1993-01-01     | 1993-01-01 | *      |
      | md5('1008') | Jenny         | 17-214-233-1218 | 12311     | md5('1008\|\|JENNY\|\|17-214-233-1218\|\|12311') | 1993-01-01     | 1993-01-01 | *      |
      | md5('1002') | <null>        | 17-214-233-1212 | 12311     | md5('1002\|\|^^\|\|17-214-233-1212\|\|12311')    | 1993-01-02     | 1993-01-02 | *      |

  @fixture.multi_active_satellite
  Scenario: [BQ-MAS-2CD-I-09] Load data into a populated satellite where either the PK(s) or the CDK(s) are NULL - with new PK(s)/CDK(s)
    Given the MULTI_ACTIVE_SATELLITE_TWO_CDK ma_sat is already populated with data
      | CUSTOMER_PK | CUSTOMER_NAME | CUSTOMER_PHONE  | EXTENSION | HASHDIFF                                         | EFFECTIVE_FROM | LOAD_DATE  | SOURCE |
      | md5('1004') | Dom           | 17-214-233-1214 | 12311     | md5('1004\|\|DOM\|\|17-214-233-1214\|\|12311')   | 1993-01-01     | 1993-01-01 | *      |
      | md5('1004') | Dom           | 17-214-233-1224 | 12311     | md5('1004\|\|DOM\|\|17-214-233-1224\|\|12311')   | 1993-01-01     | 1993-01-01 | *      |
      | md5('1004') | Dom           | 17-214-233-1234 | 12311     | md5('1004\|\|DOM\|\|17-214-233-1234\|\|12311')   | 1993-01-01     | 1993-01-01 | *      |
      | md5('1006') | Frida         | 17-214-233-1216 | 12321     | md5('1006\|\|FRIDA\|\|17-214-233-1216\|\|12321') | 1993-01-01     | 1993-01-01 | *      |
      | md5('1006') | Frida         | 17-214-233-1216 | 12322     | md5('1006\|\|FRIDA\|\|17-214-233-1216\|\|12322') | 1993-01-01     | 1993-01-01 | *      |
      | md5('1006') | Frida         | 17-214-233-1216 | 12323     | md5('1006\|\|FRIDA\|\|17-214-233-1216\|\|12323') | 1993-01-01     | 1993-01-01 | *      |
    And the RAW_STAGE_TWO_CDK table contains data
      | CUSTOMER_ID | CUSTOMER_NAME | CUSTOMER_PHONE  | EXTENSION | LOAD_DATE  | SOURCE |
      | 1002        | <null>        | <null>          | <null>    | 1993-01-02 | *      |
      | <null>      | <null>        | <null>          | 12311     | 1993-01-02 | *      |
      | <null>      | <null>        | 17-214-233-1212 | <null>    | 1993-01-02 | *      |
      | <null>      | Bob           | <null>          | <null>    | 1993-01-02 | *      |
      | 1002        | Bob           | <null>          | <null>    | 1993-01-02 | *      |
      | <null>      | <null>        | 17-214-233-1212 | 12311     | 1993-01-02 | *      |
      | 1002        | <null>        | <null>          | 12311     | 1993-01-02 | *      |
      | <null>      | Bob           | 17-214-233-1212 | <null>    | 1993-01-02 | *      |
      | 1002        | Bob           | 17-214-233-1212 | <null>    | 1993-01-02 | *      |
      | 1002        | Bob           | <null>          | 12311     | 1993-01-02 | *      |
      | 1002        | <null>        | 17-214-233-1212 | 12311     | 1993-01-02 | *      |
      | <null>      | Bob           | 17-214-233-1212 | <null>    | 1993-01-02 | *      |
    And I stage the STG_CUSTOMER_TWO_CDK data
    When I load the MULTI_ACTIVE_SATELLITE_TWO_CDK ma_sat
    Then the MULTI_ACTIVE_SATELLITE_TWO_CDK table should contain expected data
      | CUSTOMER_PK | CUSTOMER_NAME | CUSTOMER_PHONE  | EXTENSION | HASHDIFF                                         | EFFECTIVE_FROM | LOAD_DATE  | SOURCE |
      | md5('1004') | Dom           | 17-214-233-1214 | 12311     | md5('1004\|\|DOM\|\|17-214-233-1214\|\|12311')   | 1993-01-01     | 1993-01-01 | *      |
      | md5('1004') | Dom           | 17-214-233-1224 | 12311     | md5('1004\|\|DOM\|\|17-214-233-1224\|\|12311')   | 1993-01-01     | 1993-01-01 | *      |
      | md5('1004') | Dom           | 17-214-233-1234 | 12311     | md5('1004\|\|DOM\|\|17-214-233-1234\|\|12311')   | 1993-01-01     | 1993-01-01 | *      |
      | md5('1006') | Frida         | 17-214-233-1216 | 12321     | md5('1006\|\|FRIDA\|\|17-214-233-1216\|\|12321') | 1993-01-01     | 1993-01-01 | *      |
      | md5('1006') | Frida         | 17-214-233-1216 | 12322     | md5('1006\|\|FRIDA\|\|17-214-233-1216\|\|12322') | 1993-01-01     | 1993-01-01 | *      |
      | md5('1006') | Frida         | 17-214-233-1216 | 12323     | md5('1006\|\|FRIDA\|\|17-214-233-1216\|\|12323') | 1993-01-01     | 1993-01-01 | *      |
      | md5('1002') | <null>        | 17-214-233-1212 | 12311     | md5('1002\|\|^^\|\|17-214-233-1212\|\|12311')    | 1993-01-02     | 1993-01-02 | *      |

  @fixture.multi_active_satellite
  Scenario: [BQ-MAS-2CD-I-010] Load data into a populated satellite where the stage records include NULL PK(s) and NULL CDK(s)
    Given the MULTI_ACTIVE_SATELLITE_TWO_CDK ma_sat is already populated with data
      | CUSTOMER_PK | CUSTOMER_NAME | CUSTOMER_PHONE  | EXTENSION | HASHDIFF                                         | EFFECTIVE_FROM | LOAD_DATE  | SOURCE |
      | md5('1004') | Dom           | 17-214-233-1214 | 12311     | md5('1004\|\|DOM\|\|17-214-233-1214\|\|12311')   | 1993-01-01     | 1993-01-01 | *      |
      | md5('1004') | Dom           | 17-214-233-1224 | 12311     | md5('1004\|\|DOM\|\|17-214-233-1224\|\|12311')   | 1993-01-01     | 1993-01-01 | *      |
      | md5('1004') | Dom           | 17-214-233-1234 | 12311     | md5('1004\|\|DOM\|\|17-214-233-1234\|\|12311')   | 1993-01-01     | 1993-01-01 | *      |
      | md5('1006') | Frida         | 17-214-233-1216 | 12321     | md5('1006\|\|FRIDA\|\|17-214-233-1216\|\|12321') | 1993-01-01     | 1993-01-01 | *      |
      | md5('1006') | Frida         | 17-214-233-1226 | 12322     | md5('1006\|\|FRIDA\|\|17-214-233-1216\|\|12322') | 1993-01-01     | 1993-01-01 | *      |
      | md5('1006') | Frida         | 17-214-233-1236 | 12323     | md5('1006\|\|FRIDA\|\|17-214-233-1216\|\|12323') | 1993-01-01     | 1993-01-01 | *      |
    And the RAW_STAGE_TWO_CDK table contains data
      | CUSTOMER_ID | CUSTOMER_NAME | CUSTOMER_PHONE | EXTENSION | LOAD_DATE  | SOURCE |
      | <null>      | <null>        | <null>         | <null>    | 1993-01-02 | *      |
    And I stage the STG_CUSTOMER_TWO_CDK data
    When I load the MULTI_ACTIVE_SATELLITE_TWO_CDK ma_sat
    Then the MULTI_ACTIVE_SATELLITE_TWO_CDK table should contain expected data
      | CUSTOMER_PK | CUSTOMER_NAME | CUSTOMER_PHONE  | EXTENSION | HASHDIFF                                         | EFFECTIVE_FROM | LOAD_DATE  | SOURCE |
      | md5('1004') | Dom           | 17-214-233-1214 | 12311     | md5('1004\|\|DOM\|\|17-214-233-1214\|\|12311')   | 1993-01-01     | 1993-01-01 | *      |
      | md5('1004') | Dom           | 17-214-233-1224 | 12311     | md5('1004\|\|DOM\|\|17-214-233-1224\|\|12311')   | 1993-01-01     | 1993-01-01 | *      |
      | md5('1004') | Dom           | 17-214-233-1234 | 12311     | md5('1004\|\|DOM\|\|17-214-233-1234\|\|12311')   | 1993-01-01     | 1993-01-01 | *      |
      | md5('1006') | Frida         | 17-214-233-1216 | 12321     | md5('1006\|\|FRIDA\|\|17-214-233-1216\|\|12321') | 1993-01-01     | 1993-01-01 | *      |
      | md5('1006') | Frida         | 17-214-233-1226 | 12322     | md5('1006\|\|FRIDA\|\|17-214-233-1216\|\|12322') | 1993-01-01     | 1993-01-01 | *      |
      | md5('1006') | Frida         | 17-214-233-1236 | 12323     | md5('1006\|\|FRIDA\|\|17-214-233-1216\|\|12323') | 1993-01-01     | 1993-01-01 | *      |

  @fixture.multi_active_satellite
  Scenario: [BQ-MAS-2CD-I-011] Load data into a populated multi-active satellite where hashdiff does not include CDKs
    Given the MULTI_ACTIVE_SATELLITE_TWO_CDK_NO_CDK_HASHDIFF ma_sat is already populated with data
      | CUSTOMER_PK | CUSTOMER_NAME | CUSTOMER_PHONE  | EXTENSION | HASHDIFF             | EFFECTIVE_FROM | LOAD_DATE  | SOURCE |
      | md5('1003') | Chad          | 17-214-233-1216 | 12311     | md5('1003\|\|CHAD')  | 1993-01-01     | 1993-01-01 | *      |
      | md5('1003') | Chad          | 17-214-233-1226 | 12311     | md5('1003\|\|CHAD')  | 1993-01-01     | 1993-01-01 | *      |
      | md5('1003') | Chad          | 17-214-233-1236 | 12311     | md5('1003\|\|CHAD')  | 1993-01-01     | 1993-01-01 | *      |
      | md5('1005') | Dom           | 17-214-233-1217 | 12321     | md5('1005\|\|DOM')   | 1993-01-01     | 1993-01-01 | *      |
      | md5('1005') | Dom           | 17-214-233-1217 | 12322     | md5('1005\|\|DOM')   | 1993-01-01     | 1993-01-01 | *      |
      | md5('1005') | Dom           | 17-214-233-1217 | 12323     | md5('1005\|\|DOM')   | 1993-01-01     | 1993-01-01 | *      |
      | md5('1007') | Frida         | 17-214-233-1218 | 12331     | md5('1007\|\|FRIDA') | 1993-01-01     | 1993-01-01 | *      |
      | md5('1007') | Frida         | 17-214-233-1228 | 12332     | md5('1007\|\|FRIDA') | 1993-01-01     | 1993-01-01 | *      |
      | md5('1007') | Frida         | 17-214-233-1238 | 12333     | md5('1007\|\|FRIDA') | 1993-01-01     | 1993-01-01 | *      |
    And the RAW_STAGE table contains data
      | CUSTOMER_ID | CUSTOMER_NAME | CUSTOMER_PHONE  | EXTENSION | LOAD_DATE  | SOURCE |
      | 1003        | Chad          | 17-214-233-1216 | 12311     | 1993-01-02 | *      |
      | 1003        | Chad          | 17-214-233-1226 | 12311     | 1993-01-02 | *      |
      | 1003        | Chad          | 17-214-233-1246 | 12311     | 1993-01-02 | *      |
      | 1005        | Dom           | 17-214-233-1217 | 12321     | 1993-01-02 | *      |
      | 1005        | Dom           | 17-214-233-1217 | 12322     | 1993-01-02 | *      |
      | 1005        | Dom           | 17-214-233-1217 | 12324     | 1993-01-02 | *      |
      | 1007        | Frida         | 17-214-233-1218 | 12331     | 1993-01-02 | *      |
      | 1007        | Frida         | 17-214-233-1228 | 12332     | 1993-01-02 | *      |
      | 1007        | Frida         | 17-214-233-1248 | 12334     | 1993-01-02 | *      |
    And I stage the STG_CUSTOMER_TWO_CDK_NO_CDK_HASHDIFF data
    When I load the MULTI_ACTIVE_SATELLITE_TWO_CDK_NO_CDK_HASHDIFF ma_sat
    Then the MULTI_ACTIVE_SATELLITE_TWO_CDK_NO_CDK_HASHDIFF table should contain expected data
      | CUSTOMER_PK | CUSTOMER_NAME | CUSTOMER_PHONE  | EXTENSION | HASHDIFF             | EFFECTIVE_FROM | LOAD_DATE  | SOURCE |
      | md5('1003') | Chad          | 17-214-233-1216 | 12311     | md5('1003\|\|CHAD')  | 1993-01-01     | 1993-01-01 | *      |
      | md5('1003') | Chad          | 17-214-233-1226 | 12311     | md5('1003\|\|CHAD')  | 1993-01-01     | 1993-01-01 | *      |
      | md5('1003') | Chad          | 17-214-233-1236 | 12311     | md5('1003\|\|CHAD')  | 1993-01-01     | 1993-01-01 | *      |
      | md5('1005') | Dom           | 17-214-233-1217 | 12321     | md5('1005\|\|DOM')   | 1993-01-01     | 1993-01-01 | *      |
      | md5('1005') | Dom           | 17-214-233-1217 | 12322     | md5('1005\|\|DOM')   | 1993-01-01     | 1993-01-01 | *      |
      | md5('1005') | Dom           | 17-214-233-1217 | 12323     | md5('1005\|\|DOM')   | 1993-01-01     | 1993-01-01 | *      |
      | md5('1007') | Frida         | 17-214-233-1218 | 12331     | md5('1007\|\|FRIDA') | 1993-01-01     | 1993-01-01 | *      |
      | md5('1007') | Frida         | 17-214-233-1228 | 12332     | md5('1007\|\|FRIDA') | 1993-01-01     | 1993-01-01 | *      |
      | md5('1007') | Frida         | 17-214-233-1238 | 12333     | md5('1007\|\|FRIDA') | 1993-01-01     | 1993-01-01 | *      |
      | md5('1003') | Chad          | 17-214-233-1216 | 12311     | md5('1003\|\|CHAD')  | 1993-01-02     | 1993-01-02 | *      |
      | md5('1003') | Chad          | 17-214-233-1226 | 12311     | md5('1003\|\|CHAD')  | 1993-01-02     | 1993-01-02 | *      |
      | md5('1003') | Chad          | 17-214-233-1246 | 12311     | md5('1003\|\|CHAD')  | 1993-01-02     | 1993-01-02 | *      |
      | md5('1005') | Dom           | 17-214-233-1217 | 12321     | md5('1005\|\|DOM')   | 1993-01-02     | 1993-01-02 | *      |
      | md5('1005') | Dom           | 17-214-233-1217 | 12322     | md5('1005\|\|DOM')   | 1993-01-02     | 1993-01-02 | *      |
      | md5('1005') | Dom           | 17-214-233-1217 | 12324     | md5('1005\|\|DOM')   | 1993-01-02     | 1993-01-02 | *      |
      | md5('1007') | Frida         | 17-214-233-1218 | 12331     | md5('1007\|\|FRIDA') | 1993-01-02     | 1993-01-02 | *      |
      | md5('1007') | Frida         | 17-214-233-1228 | 12332     | md5('1007\|\|FRIDA') | 1993-01-02     | 1993-01-02 | *      |
      | md5('1007') | Frida         | 17-214-233-1248 | 12334     | md5('1007\|\|FRIDA') | 1993-01-02     | 1993-01-02 | *      |

  @fixture.multi_active_satellite
  Scenario: [BQ-MAS-2CD-I-012] Load data into a populated multi-active satellite where no matching record and hashdiff does not include CDKs
    Given the MULTI_ACTIVE_SATELLITE_TWO_CDK_NO_CDK_HASHDIFF ma_sat is already populated with data
      | CUSTOMER_PK | CUSTOMER_NAME | CUSTOMER_PHONE  | EXTENSION | HASHDIFF             | EFFECTIVE_FROM | LOAD_DATE  | SOURCE |
      | md5('1003') | Chad          | 17-214-233-1216 | 12311     | md5('1003\|\|CHAD')  | 1993-01-01     | 1993-01-01 | *      |
      | md5('1003') | Chad          | 17-214-233-1226 | 12311     | md5('1003\|\|CHAD')  | 1993-01-01     | 1993-01-01 | *      |
      | md5('1003') | Chad          | 17-214-233-1236 | 12311     | md5('1003\|\|CHAD')  | 1993-01-01     | 1993-01-01 | *      |
      | md5('1005') | Dom           | 17-214-233-1217 | 12321     | md5('1005\|\|DOM')   | 1993-01-01     | 1993-01-01 | *      |
      | md5('1005') | Dom           | 17-214-233-1217 | 12322     | md5('1005\|\|DOM')   | 1993-01-01     | 1993-01-01 | *      |
      | md5('1005') | Dom           | 17-214-233-1217 | 12323     | md5('1005\|\|DOM')   | 1993-01-01     | 1993-01-01 | *      |
      | md5('1007') | Frida         | 17-214-233-1218 | 12331     | md5('1007\|\|FRIDA') | 1993-01-01     | 1993-01-01 | *      |
      | md5('1007') | Frida         | 17-214-233-1228 | 12332     | md5('1007\|\|FRIDA') | 1993-01-01     | 1993-01-01 | *      |
      | md5('1007') | Frida         | 17-214-233-1238 | 12333     | md5('1007\|\|FRIDA') | 1993-01-01     | 1993-01-01 | *      |
    And the RAW_STAGE table contains data
      | CUSTOMER_ID | CUSTOMER_NAME | CUSTOMER_PHONE  | EXTENSION | LOAD_DATE  | SOURCE |
      | 1003        | Chad          | 17-214-233-1246 | 12311     | 1993-01-02 | *      |
      | 1005        | Dom           | 17-214-233-1217 | 12324     | 1993-01-02 | *      |
      | 1005        | Dom           | 17-214-233-1217 | 12325     | 1993-01-02 | *      |
    And I stage the STG_CUSTOMER_TWO_CDK_NO_CDK_HASHDIFF data
    When I load the MULTI_ACTIVE_SATELLITE_TWO_CDK_NO_CDK_HASHDIFF ma_sat
    Then the MULTI_ACTIVE_SATELLITE_TWO_CDK_NO_CDK_HASHDIFF table should contain expected data
      | CUSTOMER_PK | CUSTOMER_NAME | CUSTOMER_PHONE  | EXTENSION | HASHDIFF             | EFFECTIVE_FROM | LOAD_DATE  | SOURCE |
      | md5('1003') | Chad          | 17-214-233-1216 | 12311     | md5('1003\|\|CHAD')  | 1993-01-01     | 1993-01-01 | *      |
      | md5('1003') | Chad          | 17-214-233-1226 | 12311     | md5('1003\|\|CHAD')  | 1993-01-01     | 1993-01-01 | *      |
      | md5('1003') | Chad          | 17-214-233-1236 | 12311     | md5('1003\|\|CHAD')  | 1993-01-01     | 1993-01-01 | *      |
      | md5('1005') | Dom           | 17-214-233-1217 | 12321     | md5('1005\|\|DOM')   | 1993-01-01     | 1993-01-01 | *      |
      | md5('1005') | Dom           | 17-214-233-1217 | 12322     | md5('1005\|\|DOM')   | 1993-01-01     | 1993-01-01 | *      |
      | md5('1005') | Dom           | 17-214-233-1217 | 12323     | md5('1005\|\|DOM')   | 1993-01-01     | 1993-01-01 | *      |
      | md5('1007') | Frida         | 17-214-233-1218 | 12331     | md5('1007\|\|FRIDA') | 1993-01-01     | 1993-01-01 | *      |
      | md5('1007') | Frida         | 17-214-233-1228 | 12332     | md5('1007\|\|FRIDA') | 1993-01-01     | 1993-01-01 | *      |
      | md5('1007') | Frida         | 17-214-233-1238 | 12333     | md5('1007\|\|FRIDA') | 1993-01-01     | 1993-01-01 | *      |
      | md5('1003') | Chad          | 17-214-233-1246 | 12311     | md5('1003\|\|CHAD')  | 1993-01-02     | 1993-01-02 | *      |
      | md5('1005') | Dom           | 17-214-233-1217 | 12324     | md5('1005\|\|DOM')   | 1993-01-02     | 1993-01-02 | *      |
      | md5('1005') | Dom           | 17-214-233-1217 | 12325     | md5('1005\|\|DOM')   | 1993-01-02     | 1993-01-02 | *      |

  @fixture.multi_active_satellite
  Scenario: [BQ-MAS-2CD-I-013] Load data into a populated multi-active satellite where hashdiff does not include PK nor CDKs
    Given the MULTI_ACTIVE_SATELLITE_TWO_CDK_NO_PK_CDK_HASHDIFF ma_sat is already populated with data
      | CUSTOMER_PK | CUSTOMER_NAME | CUSTOMER_PHONE  | EXTENSION | HASHDIFF     | EFFECTIVE_FROM | LOAD_DATE  | SOURCE |
      | md5('1003') | Chad          | 17-214-233-1216 | 12311     | md5('CHAD')  | 1993-01-01     | 1993-01-01 | *      |
      | md5('1003') | Chad          | 17-214-233-1226 | 12311     | md5('CHAD')  | 1993-01-01     | 1993-01-01 | *      |
      | md5('1003') | Chad          | 17-214-233-1236 | 12311     | md5('CHAD')  | 1993-01-01     | 1993-01-01 | *      |
      | md5('1005') | Dom           | 17-214-233-1217 | 12321     | md5('DOM')   | 1993-01-01     | 1993-01-01 | *      |
      | md5('1005') | Dom           | 17-214-233-1217 | 12322     | md5('DOM')   | 1993-01-01     | 1993-01-01 | *      |
      | md5('1005') | Dom           | 17-214-233-1217 | 12323     | md5('DOM')   | 1993-01-01     | 1993-01-01 | *      |
      | md5('1007') | Frida         | 17-214-233-1218 | 12331     | md5('FRIDA') | 1993-01-01     | 1993-01-01 | *      |
      | md5('1007') | Frida         | 17-214-233-1228 | 12332     | md5('FRIDA') | 1993-01-01     | 1993-01-01 | *      |
      | md5('1007') | Frida         | 17-214-233-1238 | 12333     | md5('FRIDA') | 1993-01-01     | 1993-01-01 | *      |
    And the RAW_STAGE table contains data
      | CUSTOMER_ID | CUSTOMER_NAME | CUSTOMER_PHONE  | EXTENSION | LOAD_DATE  | SOURCE |
      | 1003        | Chad          | 17-214-233-1216 | 12311     | 1993-01-02 | *      |
      | 1003        | Chad          | 17-214-233-1226 | 12311     | 1993-01-02 | *      |
      | 1003        | Chad          | 17-214-233-1246 | 12311     | 1993-01-02 | *      |
      | 1005        | Dom           | 17-214-233-1217 | 12321     | 1993-01-02 | *      |
      | 1005        | Dom           | 17-214-233-1217 | 12322     | 1993-01-02 | *      |
      | 1005        | Dom           | 17-214-233-1217 | 12324     | 1993-01-02 | *      |
      | 1007        | Frida         | 17-214-233-1218 | 12331     | 1993-01-02 | *      |
      | 1007        | Frida         | 17-214-233-1228 | 12332     | 1993-01-02 | *      |
      | 1007        | Frida         | 17-214-233-1248 | 12334     | 1993-01-02 | *      |
    And I stage the STG_CUSTOMER_TWO_CDK_NO_PK_CDK_HASHDIFF data
    When I load the MULTI_ACTIVE_SATELLITE_TWO_CDK_NO_PK_CDK_HASHDIFF ma_sat
    Then the MULTI_ACTIVE_SATELLITE_TWO_CDK_NO_PK_CDK_HASHDIFF table should contain expected data
      | CUSTOMER_PK | CUSTOMER_NAME | CUSTOMER_PHONE  | EXTENSION | HASHDIFF     | EFFECTIVE_FROM | LOAD_DATE  | SOURCE |
      | md5('1003') | Chad          | 17-214-233-1216 | 12311     | md5('CHAD')  | 1993-01-01     | 1993-01-01 | *      |
      | md5('1003') | Chad          | 17-214-233-1226 | 12311     | md5('CHAD')  | 1993-01-01     | 1993-01-01 | *      |
      | md5('1003') | Chad          | 17-214-233-1236 | 12311     | md5('CHAD')  | 1993-01-01     | 1993-01-01 | *      |
      | md5('1005') | Dom           | 17-214-233-1217 | 12321     | md5('DOM')   | 1993-01-01     | 1993-01-01 | *      |
      | md5('1005') | Dom           | 17-214-233-1217 | 12322     | md5('DOM')   | 1993-01-01     | 1993-01-01 | *      |
      | md5('1005') | Dom           | 17-214-233-1217 | 12323     | md5('DOM')   | 1993-01-01     | 1993-01-01 | *      |
      | md5('1007') | Frida         | 17-214-233-1218 | 12331     | md5('FRIDA') | 1993-01-01     | 1993-01-01 | *      |
      | md5('1007') | Frida         | 17-214-233-1228 | 12332     | md5('FRIDA') | 1993-01-01     | 1993-01-01 | *      |
      | md5('1007') | Frida         | 17-214-233-1238 | 12333     | md5('FRIDA') | 1993-01-01     | 1993-01-01 | *      |
      | md5('1003') | Chad          | 17-214-233-1216 | 12311     | md5('CHAD')  | 1993-01-02     | 1993-01-02 | *      |
      | md5('1003') | Chad          | 17-214-233-1226 | 12311     | md5('CHAD')  | 1993-01-02     | 1993-01-02 | *      |
      | md5('1003') | Chad          | 17-214-233-1246 | 12311     | md5('CHAD')  | 1993-01-02     | 1993-01-02 | *      |
      | md5('1005') | Dom           | 17-214-233-1217 | 12321     | md5('DOM')   | 1993-01-02     | 1993-01-02 | *      |
      | md5('1005') | Dom           | 17-214-233-1217 | 12322     | md5('DOM')   | 1993-01-02     | 1993-01-02 | *      |
      | md5('1005') | Dom           | 17-214-233-1217 | 12324     | md5('DOM')   | 1993-01-02     | 1993-01-02 | *      |
      | md5('1007') | Frida         | 17-214-233-1218 | 12331     | md5('FRIDA') | 1993-01-02     | 1993-01-02 | *      |
      | md5('1007') | Frida         | 17-214-233-1228 | 12332     | md5('FRIDA') | 1993-01-02     | 1993-01-02 | *      |
      | md5('1007') | Frida         | 17-214-233-1248 | 12334     | md5('FRIDA') | 1993-01-02     | 1993-01-02 | *      |

  @fixture.multi_active_satellite
  Scenario: [BQ-MAS-2CD-I-014] Load data into a populated multi-active satellite where no matching record and hashdiff does not include PK nor CDKs
    Given the MULTI_ACTIVE_SATELLITE_TWO_CDK_NO_PK_CDK_HASHDIFF ma_sat is already populated with data
      | CUSTOMER_PK | CUSTOMER_NAME | CUSTOMER_PHONE  | EXTENSION | HASHDIFF     | EFFECTIVE_FROM | LOAD_DATE  | SOURCE |
      | md5('1003') | Chad          | 17-214-233-1216 | 12311     | md5('CHAD')  | 1993-01-01     | 1993-01-01 | *      |
      | md5('1003') | Chad          | 17-214-233-1226 | 12311     | md5('CHAD')  | 1993-01-01     | 1993-01-01 | *      |
      | md5('1003') | Chad          | 17-214-233-1236 | 12311     | md5('CHAD')  | 1993-01-01     | 1993-01-01 | *      |
      | md5('1005') | Dom           | 17-214-233-1217 | 12321     | md5('DOM')   | 1993-01-01     | 1993-01-01 | *      |
      | md5('1005') | Dom           | 17-214-233-1217 | 12322     | md5('DOM')   | 1993-01-01     | 1993-01-01 | *      |
      | md5('1005') | Dom           | 17-214-233-1217 | 12323     | md5('DOM')   | 1993-01-01     | 1993-01-01 | *      |
      | md5('1007') | Frida         | 17-214-233-1218 | 12331     | md5('FRIDA') | 1993-01-01     | 1993-01-01 | *      |
      | md5('1007') | Frida         | 17-214-233-1228 | 12332     | md5('FRIDA') | 1993-01-01     | 1993-01-01 | *      |
      | md5('1007') | Frida         | 17-214-233-1238 | 12333     | md5('FRIDA') | 1993-01-01     | 1993-01-01 | *      |
    And the RAW_STAGE table contains data
      | CUSTOMER_ID | CUSTOMER_NAME | CUSTOMER_PHONE  | EXTENSION | LOAD_DATE  | SOURCE |
      | 1003        | Chad          | 17-214-233-1246 | 12311     | 1993-01-02 | *      |
      | 1005        | Dom           | 17-214-233-1217 | 12324     | 1993-01-02 | *      |
      | 1005        | Dom           | 17-214-233-1217 | 12325     | 1993-01-02 | *      |
    And I stage the STG_CUSTOMER_TWO_CDK_NO_PK_CDK_HASHDIFF data
    When I load the MULTI_ACTIVE_SATELLITE_TWO_CDK_NO_PK_CDK_HASHDIFF ma_sat
    Then the MULTI_ACTIVE_SATELLITE_TWO_CDK_NO_PK_CDK_HASHDIFF table should contain expected data
      | CUSTOMER_PK | CUSTOMER_NAME | CUSTOMER_PHONE  | EXTENSION | HASHDIFF     | EFFECTIVE_FROM | LOAD_DATE  | SOURCE |
      | md5('1003') | Chad          | 17-214-233-1216 | 12311     | md5('CHAD')  | 1993-01-01     | 1993-01-01 | *      |
      | md5('1003') | Chad          | 17-214-233-1226 | 12311     | md5('CHAD')  | 1993-01-01     | 1993-01-01 | *      |
      | md5('1003') | Chad          | 17-214-233-1236 | 12311     | md5('CHAD')  | 1993-01-01     | 1993-01-01 | *      |
      | md5('1005') | Dom           | 17-214-233-1217 | 12321     | md5('DOM')   | 1993-01-01     | 1993-01-01 | *      |
      | md5('1005') | Dom           | 17-214-233-1217 | 12322     | md5('DOM')   | 1993-01-01     | 1993-01-01 | *      |
      | md5('1005') | Dom           | 17-214-233-1217 | 12323     | md5('DOM')   | 1993-01-01     | 1993-01-01 | *      |
      | md5('1007') | Frida         | 17-214-233-1218 | 12331     | md5('FRIDA') | 1993-01-01     | 1993-01-01 | *      |
      | md5('1007') | Frida         | 17-214-233-1228 | 12332     | md5('FRIDA') | 1993-01-01     | 1993-01-01 | *      |
      | md5('1007') | Frida         | 17-214-233-1238 | 12333     | md5('FRIDA') | 1993-01-01     | 1993-01-01 | *      |
      | md5('1003') | Chad          | 17-214-233-1246 | 12311     | md5('CHAD')  | 1993-01-02     | 1993-01-02 | *      |
      | md5('1005') | Dom           | 17-214-233-1217 | 12324     | md5('DOM')   | 1993-01-02     | 1993-01-02 | *      |
      | md5('1005') | Dom           | 17-214-233-1217 | 12325     | md5('DOM')   | 1993-01-02     | 1993-01-02 | *      |

  @fixture.multi_active_satellite_cycle
  Scenario: [BQ-MAS-2CD-I-015] Load over several cycles with sets of records keeping the count of records the same while having one or more records changed
    Given the RAW_STAGE_TWO_CDK stage is empty
    And the MULTI_ACTIVE_SATELLITE_TWO_CDK ma_sat is empty

    # ================ DAY 1 ===================
    When the RAW_STAGE_TWO_CDK is loaded
      | CUSTOMER_ID | CUSTOMER_NAME | CUSTOMER_PHONE  | EXTENSION | EFFECTIVE_FROM | LOAD_DATE  | SOURCE |
      | 1001        | Albert        | 17-214-233-1211 | 12301     | 2019-01-01     | 2019-01-01 | *      |
      | 1001        | Albert        | 17-214-233-1211 | 12302     | 2019-01-01     | 2019-01-01 | *      |
      | 1001        | Albert        | 17-214-233-1211 | 12303     | 2019-01-01     | 2019-01-01 | *      |
      | 1002        | Beth          | 17-214-233-1212 | 12311     | 2019-01-01     | 2019-01-01 | *      |
      | 1002        | Beth          | 17-214-233-1212 | 12312     | 2019-01-01     | 2019-01-01 | *      |
      | 1002        | Beth          | 17-214-233-1212 | 12313     | 2019-01-01     | 2019-01-01 | *      |
      | 1003        | Charley       | 17-214-233-1213 | 12321     | 2019-01-01     | 2019-01-01 | *      |
      | 1003        | Charley       | 17-214-233-1223 | 12321     | 2019-01-01     | 2019-01-01 | *      |
      | 1003        | Charley       | 17-214-233-1233 | 12321     | 2019-01-01     | 2019-01-01 | *      |
      | 1010        | Jenny         | 17-214-233-1214 | 12331     | 2019-01-01     | 2019-01-01 | *      |
      | 1010        | Jenny         | 17-214-233-1224 | 12331     | 2019-01-01     | 2019-01-01 | *      |
      | 1010        | Jenny         | 17-214-233-1234 | 12331     | 2019-01-01     | 2019-01-01 | *      |

    And I stage the STG_CUSTOMER_TWO_CDK data
    And I load the MULTI_ACTIVE_SATELLITE_TWO_CDK ma_sat

    # ================ DAY 2 ===================
    When the RAW_STAGE_TWO_CDK is loaded
      | CUSTOMER_ID | CUSTOMER_NAME | CUSTOMER_PHONE  | EXTENSION | EFFECTIVE_FROM | LOAD_DATE  | SOURCE |
      | 1001        | Albert        | 17-214-233-1211 | 12301     | 2019-01-02     | 2019-01-02 | *      |
      | 1001        | Albert        | 17-214-233-1211 | 12302     | 2019-01-02     | 2019-01-02 | *      |
      | 1001        | Albert        | 17-214-233-1211 | 12304     | 2019-01-02     | 2019-01-02 | *      |
      | 1003        | Charley       | 17-214-233-1213 | 12321     | 2019-01-02     | 2019-01-02 | *      |
      | 1003        | Charley       | 17-214-233-1223 | 12321     | 2019-01-02     | 2019-01-02 | *      |
      | 1003        | Charley       | 17-214-233-1243 | 12321     | 2019-01-02     | 2019-01-02 | *      |

    And I stage the STG_CUSTOMER_TWO_CDK data
    And I load the MULTI_ACTIVE_SATELLITE_TWO_CDK ma_sat

    # ================ DAY 3 ===================
    When the RAW_STAGE_TWO_CDK is loaded
      | CUSTOMER_ID | CUSTOMER_NAME | CUSTOMER_PHONE  | EXTENSION | EFFECTIVE_FROM | LOAD_DATE  | SOURCE |
      | 1002        | Beth          | 17-214-233-1212 | 12311     | 2019-01-03     | 2019-01-03 | *      |
      | 1002        | Beah          | 17-214-233-1212 | 12314     | 2019-01-03     | 2019-01-03 | *      |
      | 1002        | Beth          | 17-214-233-1212 | 12315     | 2019-01-03     | 2019-01-03 | *      |
      | 1010        | Jenny         | 17-214-233-1214 | 12331     | 2019-01-03     | 2019-01-03 | *      |
      | 1010        | Jenny         | 17-214-233-1244 | 12331     | 2019-01-03     | 2019-01-03 | *      |
      | 1010        | Jenny         | 17-214-233-1254 | 12331     | 2019-01-03     | 2019-01-03 | *      |

    And I stage the STG_CUSTOMER_TWO_CDK data
    And I load the MULTI_ACTIVE_SATELLITE_TWO_CDK ma_sat

    # =============== CHECKS ===================
    Then the MULTI_ACTIVE_SATELLITE_TWO_CDK table should contain expected data
      | CUSTOMER_PK | HASHDIFF                                           | CUSTOMER_NAME | CUSTOMER_PHONE  | EXTENSION | EFFECTIVE_FROM | LOAD_DATE  | SOURCE |
      | md5('1001') | md5('1001\|\|ALBERT\|\|17-214-233-1211\|\|12301')  | Albert        | 17-214-233-1211 | 12301     | 2019-01-01     | 2019-01-01 | *      |
      | md5('1001') | md5('1001\|\|ALBERT\|\|17-214-233-1211\|\|12302')  | Albert        | 17-214-233-1211 | 12302     | 2019-01-01     | 2019-01-01 | *      |
      | md5('1001') | md5('1001\|\|ALBERT\|\|17-214-233-1211\|\|12303')  | Albert        | 17-214-233-1211 | 12303     | 2019-01-01     | 2019-01-01 | *      |
      | md5('1002') | md5('1002\|\|BETH\|\|17-214-233-1212\|\|12311')    | Beth          | 17-214-233-1212 | 12311     | 2019-01-01     | 2019-01-01 | *      |
      | md5('1002') | md5('1002\|\|BETH\|\|17-214-233-1212\|\|12312')    | Beth          | 17-214-233-1212 | 12312     | 2019-01-01     | 2019-01-01 | *      |
      | md5('1002') | md5('1002\|\|BETH\|\|17-214-233-1212\|\|12313')    | Beth          | 17-214-233-1212 | 12313     | 2019-01-01     | 2019-01-01 | *      |
      | md5('1003') | md5('1003\|\|CHARLEY\|\|17-214-233-1213\|\|12321') | Charley       | 17-214-233-1213 | 12321     | 2019-01-01     | 2019-01-01 | *      |
      | md5('1003') | md5('1003\|\|CHARLEY\|\|17-214-233-1223\|\|12321') | Charley       | 17-214-233-1223 | 12321     | 2019-01-01     | 2019-01-01 | *      |
      | md5('1003') | md5('1003\|\|CHARLEY\|\|17-214-233-1233\|\|12321') | Charley       | 17-214-233-1233 | 12321     | 2019-01-01     | 2019-01-01 | *      |
      | md5('1010') | md5('1010\|\|JENNY\|\|17-214-233-1214\|\|12331')   | Jenny         | 17-214-233-1214 | 12331     | 2019-01-01     | 2019-01-01 | *      |
      | md5('1010') | md5('1010\|\|JENNY\|\|17-214-233-1224\|\|12331')   | Jenny         | 17-214-233-1224 | 12331     | 2019-01-01     | 2019-01-01 | *      |
      | md5('1010') | md5('1010\|\|JENNY\|\|17-214-233-1234\|\|12331')   | Jenny         | 17-214-233-1234 | 12331     | 2019-01-01     | 2019-01-01 | *      |
      | md5('1001') | md5('1001\|\|ALBERT\|\|17-214-233-1211\|\|12301')  | Albert        | 17-214-233-1211 | 12301     | 2019-01-02     | 2019-01-02 | *      |
      | md5('1001') | md5('1001\|\|ALBERT\|\|17-214-233-1211\|\|12302')  | Albert        | 17-214-233-1211 | 12302     | 2019-01-02     | 2019-01-02 | *      |
      | md5('1001') | md5('1001\|\|ALBERT\|\|17-214-233-1211\|\|12304')  | Albert        | 17-214-233-1211 | 12304     | 2019-01-02     | 2019-01-02 | *      |
      | md5('1003') | md5('1003\|\|CHARLEY\|\|17-214-233-1213\|\|12321') | Charley       | 17-214-233-1213 | 12321     | 2019-01-02     | 2019-01-02 | *      |
      | md5('1003') | md5('1003\|\|CHARLEY\|\|17-214-233-1223\|\|12321') | Charley       | 17-214-233-1223 | 12321     | 2019-01-02     | 2019-01-02 | *      |
      | md5('1003') | md5('1003\|\|CHARLEY\|\|17-214-233-1243\|\|12321') | Charley       | 17-214-233-1243 | 12321     | 2019-01-02     | 2019-01-02 | *      |
      | md5('1002') | md5('1002\|\|BETH\|\|17-214-233-1212\|\|12311')    | Beth          | 17-214-233-1212 | 12311     | 2019-01-03     | 2019-01-03 | *      |
      | md5('1002') | md5('1002\|\|BEAH\|\|17-214-233-1212\|\|12314')    | Beah          | 17-214-233-1212 | 12314     | 2019-01-03     | 2019-01-03 | *      |
      | md5('1002') | md5('1002\|\|BETH\|\|17-214-233-1212\|\|12315')    | Beth          | 17-214-233-1212 | 12315     | 2019-01-03     | 2019-01-03 | *      |
      | md5('1010') | md5('1010\|\|JENNY\|\|17-214-233-1214\|\|12331')   | Jenny         | 17-214-233-1214 | 12331     | 2019-01-03     | 2019-01-03 | *      |
      | md5('1010') | md5('1010\|\|JENNY\|\|17-214-233-1244\|\|12331')   | Jenny         | 17-214-233-1244 | 12331     | 2019-01-03     | 2019-01-03 | *      |
      | md5('1010') | md5('1010\|\|JENNY\|\|17-214-233-1254\|\|12331')   | Jenny         | 17-214-233-1254 | 12331     | 2019-01-03     | 2019-01-03 | *      |

  @fixture.multi_active_satellite_cycle
  Scenario: [BQ-MAS-2CD-I-016] Load over several cycles
    Given the RAW_STAGE_TWO_CDK stage is empty
    And the MULTI_ACTIVE_SATELLITE_TWO_CDK ma_sat is empty

    # ================ DAY 1 ===================
    When the RAW_STAGE_TWO_CDK is loaded
      | CUSTOMER_ID | CUSTOMER_NAME | CUSTOMER_PHONE  | EXTENSION | EFFECTIVE_FROM | LOAD_DATE  | SOURCE |
      | 1001        | Albert        | 17-214-233-1211 | 12301     | 2019-01-01     | 2019-01-01 | *      |
      | 1001        | Albert        | 17-214-233-1211 | 12302     | 2019-01-01     | 2019-01-01 | *      |
      | 1001        | Albert        | 17-214-233-1211 | 12303     | 2019-01-01     | 2019-01-01 | *      |
      | 1002        | Beth          | 17-214-233-1212 | 12311     | 2019-01-01     | 2019-01-01 | *      |
      | 1002        | Beth          | 17-214-233-1212 | 12312     | 2019-01-01     | 2019-01-01 | *      |
      | 1002        | Beth          | 17-214-233-1212 | 12313     | 2019-01-01     | 2019-01-01 | *      |
      | 1003        | Charley       | 17-214-233-1213 | 12321     | 2019-01-01     | 2019-01-01 | *      |
      | 1003        | Charley       | 17-214-233-1223 | 12321     | 2019-01-01     | 2019-01-01 | *      |
      | 1003        | Charley       | 17-214-233-1233 | 12321     | 2019-01-01     | 2019-01-01 | *      |
      | 1010        | Jenny         | 17-214-233-1214 | 12331     | 2019-01-01     | 2019-01-01 | *      |
      | 1010        | Jenny         | 17-214-233-1224 | 12331     | 2019-01-01     | 2019-01-01 | *      |
      | 1010        | Jenny         | 17-214-233-1234 | 12331     | 2019-01-01     | 2019-01-01 | *      |
      | 1012        | Albert        | 17-214-233-1215 | 12341     | 2019-01-01     | 2019-01-01 | *      |
      | 1012        | Albert        | 17-214-233-1225 | 12341     | 2019-01-01     | 2019-01-01 | *      |
      | 1012        | Albert        | 17-214-233-1235 | 12341     | 2019-01-01     | 2019-01-01 | *      |
    And I stage the STG_CUSTOMER_TWO_CDK data
    And I load the MULTI_ACTIVE_SATELLITE_TWO_CDK ma_sat

    # ================ DAY 2 ===================
    # Albert(hd), Beah (hd-), Chris (hd-), David (new), Jenny (+), Albert (hd)
    When the RAW_STAGE_TWO_CDK is loaded
      | CUSTOMER_ID | CUSTOMER_NAME | CUSTOMER_PHONE  | EXTENSION | EFFECTIVE_FROM | LOAD_DATE  | SOURCE |
      | 1001        | Albert        | 17-214-233-1311 | 12301     | 2019-01-02     | 2019-01-02 | *      |
      | 1001        | Albert        | 17-214-233-1211 | 12302     | 2019-01-02     | 2019-01-02 | *      |
      | 1001        | Albert        | 17-214-233-1211 | 12303     | 2019-01-02     | 2019-01-02 | *      |
      | 1002        | Beah          | 17-214-233-1212 | 12311     | 2019-01-02     | 2019-01-02 | *      |
      | 1002        | Beah          | 17-214-233-1212 | 12312     | 2019-01-02     | 2019-01-02 | *      |
      | 1003        | Chris         | 17-214-233-1223 | 12321     | 2019-01-02     | 2019-01-02 | *      |
      | 1004        | David         | 17-214-233-1216 | 12311     | 2019-01-02     | 2019-01-02 | *      |
      | 1004        | David         | 17-214-233-1226 | 12311     | 2019-01-02     | 2019-01-02 | *      |
      | 1004        | David         | 17-214-233-1236 | 12311     | 2019-01-02     | 2019-01-02 | *      |
      | 1010        | Jenny         | 17-214-233-1214 | 12331     | 2019-01-02     | 2019-01-02 | *      |
      | 1010        | Jenny         | 17-214-233-1224 | 12331     | 2019-01-02     | 2019-01-02 | *      |
      | 1010        | Jenny         | 17-214-233-1234 | 12331     | 2019-01-02     | 2019-01-02 | *      |
      | 1010        | Jenny         | 17-214-233-1244 | 12331     | 2019-01-02     | 2019-01-02 | *      |
      | 1012        | Albert        | 17-214-233-1215 | 92341     | 2019-01-02     | 2019-01-02 | *      |
      | 1012        | Albert        | 17-214-233-1225 | 12341     | 2019-01-02     | 2019-01-02 | *      |
      | 1012        | Albert        | 17-214-233-1235 | 12341     | 2019-01-02     | 2019-01-02 | *      |
    And I stage the STG_CUSTOMER_TWO_CDK data
    And I load the MULTI_ACTIVE_SATELLITE_TWO_CDK ma_sat

    # ================ DAY 3 ===================
    # Beth (hd+), David (-), Freia (new, dupl)
    When the RAW_STAGE_TWO_CDK is loaded
      | CUSTOMER_ID | CUSTOMER_NAME | CUSTOMER_PHONE  | EXTENSION | EFFECTIVE_FROM | LOAD_DATE  | SOURCE |
      | 1002        | Beth          | 17-214-233-1212 | 92301     | 2019-01-03     | 2019-01-03 | *      |
      | 1002        | Beth          | 17-214-233-1212 | 12302     | 2019-01-03     | 2019-01-03 | *      |
      | 1002        | Beth          | 17-214-233-1212 | 12303     | 2019-01-03     | 2019-01-03 | *      |
      | 1004        | David         | 17-214-233-1216 | 12311     | 2019-01-03     | 2019-01-03 | *      |
      | 1004        | David         | 17-214-233-1226 | 12311     | 2019-01-03     | 2019-01-03 | *      |
      | 1006        | Freia         | 17-214-233-1212 | 12311     | 2019-01-03     | 2019-01-03 | *      |
      | 1006        | Freia         | 17-214-233-1212 | 12311     | 2019-01-03     | 2019-01-03 | *      |
      | 1003        | Chris         | 17-214-233-1223 | 12321     | 2019-01-03     | 2019-01-03 | *      |
      | 1003        | Chris         | 17-214-233-1224 | 12321     | 2019-01-03     | 2019-01-03 | *      |
      | 1003        | Chriss        | 17-214-233-1223 | 12321     | 2019-01-03     | 2019-01-03 | *      |

    And I stage the STG_CUSTOMER_TWO_CDK data
    And I load the MULTI_ACTIVE_SATELLITE_TWO_CDK ma_sat

    # ================ DAY 4 ===================
    # Beah (hd, dupl), Charley (hd), David (+), Freia (hd), Jenny (hd),
    When the RAW_STAGE_TWO_CDK is loaded
      | CUSTOMER_ID | CUSTOMER_NAME | CUSTOMER_PHONE  | EXTENSION | EFFECTIVE_FROM | LOAD_DATE  | SOURCE |
      | 1002        | Beah          | 17-214-233-1312 | 12311     | 2019-01-04     | 2019-01-04 | *      |
      | 1002        | Beah          | 17-214-233-1212 | 12311     | 2019-01-04     | 2019-01-04 | *      |
      | 1002        | Beah          | 17-214-233-1212 | 12311     | 2019-01-04     | 2019-01-04 | *      |
      | 1003        | Charley       | 17-214-233-1223 | 12321     | 2019-01-04     | 2019-01-04 | *      |
      | 1004        | David         | 17-214-233-1216 | 12311     | 2019-01-04     | 2019-01-04 | *      |
      | 1004        | David         | 17-214-233-1226 | 12311     | 2019-01-04     | 2019-01-04 | *      |
      | 1004        | David         | 17-214-233-1236 | 12311     | 2019-01-04     | 2019-01-04 | *      |
      | 1006        | Freia         | 17-214-233-1312 | 12311     | 2019-01-04     | 2019-01-04 | *      |
      | 1010        | Jenny         | 17-214-233-1314 | 12331     | 2019-01-04     | 2019-01-04 | *      |
      | 1010        | Jenny         | 17-214-233-1324 | 12331     | 2019-01-04     | 2019-01-04 | *      |
      | 1010        | Jenny         | 17-214-233-1334 | 12331     | 2019-01-04     | 2019-01-04 | *      |
      | 1010        | Jenny         | 17-214-233-1344 | 12331     | 2019-01-04     | 2019-01-04 | *      |

    And I stage the STG_CUSTOMER_TWO_CDK data
    And I load the MULTI_ACTIVE_SATELLITE_TWO_CDK ma_sat

    # =============== CHECKS ===================
    Then the MULTI_ACTIVE_SATELLITE_TWO_CDK table should contain expected data
      | CUSTOMER_PK | HASHDIFF                                           | CUSTOMER_NAME | CUSTOMER_PHONE  | EXTENSION | EFFECTIVE_FROM | LOAD_DATE  | SOURCE |
      | md5('1001') | md5('1001\|\|ALBERT\|\|17-214-233-1211\|\|12301')  | Albert        | 17-214-233-1211 | 12301     | 2019-01-01     | 2019-01-01 | *      |
      | md5('1001') | md5('1001\|\|ALBERT\|\|17-214-233-1211\|\|12302')  | Albert        | 17-214-233-1211 | 12302     | 2019-01-01     | 2019-01-01 | *      |
      | md5('1001') | md5('1001\|\|ALBERT\|\|17-214-233-1211\|\|12303')  | Albert        | 17-214-233-1211 | 12303     | 2019-01-01     | 2019-01-01 | *      |
      | md5('1002') | md5('1002\|\|BETH\|\|17-214-233-1212\|\|12311')    | Beth          | 17-214-233-1212 | 12311     | 2019-01-01     | 2019-01-01 | *      |
      | md5('1002') | md5('1002\|\|BETH\|\|17-214-233-1212\|\|12312')    | Beth          | 17-214-233-1212 | 12312     | 2019-01-01     | 2019-01-01 | *      |
      | md5('1002') | md5('1002\|\|BETH\|\|17-214-233-1212\|\|12313')    | Beth          | 17-214-233-1212 | 12313     | 2019-01-01     | 2019-01-01 | *      |
      | md5('1003') | md5('1003\|\|CHARLEY\|\|17-214-233-1213\|\|12321') | Charley       | 17-214-233-1213 | 12321     | 2019-01-01     | 2019-01-01 | *      |
      | md5('1003') | md5('1003\|\|CHARLEY\|\|17-214-233-1223\|\|12321') | Charley       | 17-214-233-1223 | 12321     | 2019-01-01     | 2019-01-01 | *      |
      | md5('1003') | md5('1003\|\|CHARLEY\|\|17-214-233-1233\|\|12321') | Charley       | 17-214-233-1233 | 12321     | 2019-01-01     | 2019-01-01 | *      |
      | md5('1010') | md5('1010\|\|JENNY\|\|17-214-233-1214\|\|12331')   | Jenny         | 17-214-233-1214 | 12331     | 2019-01-01     | 2019-01-01 | *      |
      | md5('1010') | md5('1010\|\|JENNY\|\|17-214-233-1224\|\|12331')   | Jenny         | 17-214-233-1224 | 12331     | 2019-01-01     | 2019-01-01 | *      |
      | md5('1010') | md5('1010\|\|JENNY\|\|17-214-233-1234\|\|12331')   | Jenny         | 17-214-233-1234 | 12331     | 2019-01-01     | 2019-01-01 | *      |
      | md5('1012') | md5('1012\|\|ALBERT\|\|17-214-233-1215\|\|12341')  | Albert        | 17-214-233-1215 | 12341     | 2019-01-01     | 2019-01-01 | *      |
      | md5('1012') | md5('1012\|\|ALBERT\|\|17-214-233-1225\|\|12341')  | Albert        | 17-214-233-1225 | 12341     | 2019-01-01     | 2019-01-01 | *      |
      | md5('1012') | md5('1012\|\|ALBERT\|\|17-214-233-1235\|\|12341')  | Albert        | 17-214-233-1235 | 12341     | 2019-01-01     | 2019-01-01 | *      |
      | md5('1001') | md5('1001\|\|ALBERT\|\|17-214-233-1311\|\|12301')  | Albert        | 17-214-233-1311 | 12301     | 2019-01-02     | 2019-01-02 | *      |
      | md5('1001') | md5('1001\|\|ALBERT\|\|17-214-233-1211\|\|12302')  | Albert        | 17-214-233-1211 | 12302     | 2019-01-02     | 2019-01-02 | *      |
      | md5('1001') | md5('1001\|\|ALBERT\|\|17-214-233-1211\|\|12303')  | Albert        | 17-214-233-1211 | 12303     | 2019-01-02     | 2019-01-02 | *      |
      | md5('1002') | md5('1002\|\|BEAH\|\|17-214-233-1212\|\|12311')    | Beah          | 17-214-233-1212 | 12311     | 2019-01-02     | 2019-01-02 | *      |
      | md5('1002') | md5('1002\|\|BEAH\|\|17-214-233-1212\|\|12312')    | Beah          | 17-214-233-1212 | 12312     | 2019-01-02     | 2019-01-02 | *      |
      | md5('1003') | md5('1003\|\|CHRIS\|\|17-214-233-1223\|\|12321')   | Chris         | 17-214-233-1223 | 12321     | 2019-01-02     | 2019-01-02 | *      |
      | md5('1004') | md5('1004\|\|DAVID\|\|17-214-233-1216\|\|12311')   | David         | 17-214-233-1216 | 12311     | 2019-01-02     | 2019-01-02 | *      |
      | md5('1004') | md5('1004\|\|DAVID\|\|17-214-233-1226\|\|12311')   | David         | 17-214-233-1226 | 12311     | 2019-01-02     | 2019-01-02 | *      |
      | md5('1004') | md5('1004\|\|DAVID\|\|17-214-233-1236\|\|12311')   | David         | 17-214-233-1236 | 12311     | 2019-01-02     | 2019-01-02 | *      |
      | md5('1010') | md5('1010\|\|JENNY\|\|17-214-233-1214\|\|12331')   | Jenny         | 17-214-233-1214 | 12331     | 2019-01-02     | 2019-01-02 | *      |
      | md5('1010') | md5('1010\|\|JENNY\|\|17-214-233-1224\|\|12331')   | Jenny         | 17-214-233-1224 | 12331     | 2019-01-02     | 2019-01-02 | *      |
      | md5('1010') | md5('1010\|\|JENNY\|\|17-214-233-1234\|\|12331')   | Jenny         | 17-214-233-1234 | 12331     | 2019-01-02     | 2019-01-02 | *      |
      | md5('1010') | md5('1010\|\|JENNY\|\|17-214-233-1244\|\|12331')   | Jenny         | 17-214-233-1244 | 12331     | 2019-01-02     | 2019-01-02 | *      |
      | md5('1012') | md5('1012\|\|ALBERT\|\|17-214-233-1215\|\|92341')  | Albert        | 17-214-233-1215 | 92341     | 2019-01-02     | 2019-01-02 | *      |
      | md5('1012') | md5('1012\|\|ALBERT\|\|17-214-233-1225\|\|12341')  | Albert        | 17-214-233-1225 | 12341     | 2019-01-02     | 2019-01-02 | *      |
      | md5('1012') | md5('1012\|\|ALBERT\|\|17-214-233-1235\|\|12341')  | Albert        | 17-214-233-1235 | 12341     | 2019-01-02     | 2019-01-02 | *      |
      | md5('1002') | md5('1002\|\|BETH\|\|17-214-233-1212\|\|92301')    | Beth          | 17-214-233-1212 | 92301     | 2019-01-03     | 2019-01-03 | *      |
      | md5('1002') | md5('1002\|\|BETH\|\|17-214-233-1212\|\|12302')    | Beth          | 17-214-233-1212 | 12302     | 2019-01-03     | 2019-01-03 | *      |
      | md5('1002') | md5('1002\|\|BETH\|\|17-214-233-1212\|\|12303')    | Beth          | 17-214-233-1212 | 12303     | 2019-01-03     | 2019-01-03 | *      |
      | md5('1004') | md5('1004\|\|DAVID\|\|17-214-233-1216\|\|12311')   | David         | 17-214-233-1216 | 12311     | 2019-01-03     | 2019-01-03 | *      |
      | md5('1004') | md5('1004\|\|DAVID\|\|17-214-233-1226\|\|12311')   | David         | 17-214-233-1226 | 12311     | 2019-01-03     | 2019-01-03 | *      |
      | md5('1006') | md5('1006\|\|FREIA\|\|17-214-233-1212\|\|12311')   | Freia         | 17-214-233-1212 | 12311     | 2019-01-03     | 2019-01-03 | *      |
      | md5('1002') | md5('1002\|\|BEAH\|\|17-214-233-1312\|\|12311')    | Beah          | 17-214-233-1312 | 12311     | 2019-01-04     | 2019-01-04 | *      |
      | md5('1002') | md5('1002\|\|BEAH\|\|17-214-233-1212\|\|12311')    | Beah          | 17-214-233-1212 | 12311     | 2019-01-04     | 2019-01-04 | *      |
      | md5('1003') | md5('1003\|\|CHARLEY\|\|17-214-233-1223\|\|12321') | Charley       | 17-214-233-1223 | 12321     | 2019-01-04     | 2019-01-04 | *      |
      | md5('1004') | md5('1004\|\|DAVID\|\|17-214-233-1216\|\|12311')   | David         | 17-214-233-1216 | 12311     | 2019-01-04     | 2019-01-04 | *      |
      | md5('1004') | md5('1004\|\|DAVID\|\|17-214-233-1226\|\|12311')   | David         | 17-214-233-1226 | 12311     | 2019-01-04     | 2019-01-04 | *      |
      | md5('1004') | md5('1004\|\|DAVID\|\|17-214-233-1236\|\|12311')   | David         | 17-214-233-1236 | 12311     | 2019-01-04     | 2019-01-04 | *      |
      | md5('1006') | md5('1006\|\|FREIA\|\|17-214-233-1312\|\|12311')   | Freia         | 17-214-233-1312 | 12311     | 2019-01-04     | 2019-01-04 | *      |
      | md5('1010') | md5('1010\|\|JENNY\|\|17-214-233-1314\|\|12331')   | Jenny         | 17-214-233-1314 | 12331     | 2019-01-04     | 2019-01-04 | *      |
      | md5('1010') | md5('1010\|\|JENNY\|\|17-214-233-1324\|\|12331')   | Jenny         | 17-214-233-1324 | 12331     | 2019-01-04     | 2019-01-04 | *      |
      | md5('1010') | md5('1010\|\|JENNY\|\|17-214-233-1334\|\|12331')   | Jenny         | 17-214-233-1334 | 12331     | 2019-01-04     | 2019-01-04 | *      |
      | md5('1010') | md5('1010\|\|JENNY\|\|17-214-233-1344\|\|12331')   | Jenny         | 17-214-233-1344 | 12331     | 2019-01-04     | 2019-01-04 | *      |
      | md5('1003') | md5('1003\|\|CHRIS\|\|17-214-233-1223\|\|12321')   | Chris         | 17-214-233-1223 | 12321     | 2019-01-03     | 2019-01-03 | *      |
      | md5('1003') | md5('1003\|\|CHRIS\|\|17-214-233-1224\|\|12321')   | Chris         | 17-214-233-1224 | 12321     | 2019-01-03     | 2019-01-03 | *      |
      | md5('1003') | md5('1003\|\|CHRISS\|\|17-214-233-1223\|\|12321')  | Chriss        | 17-214-233-1223 | 12321     | 2019-01-03     | 2019-01-03 | *      |

  @fixture.multi_active_satellite_cycle
  Scenario: [BQ-MAS-2CD-I-017] Load over several cycles with Timestamps
    Given the RAW_STAGE_TWO_CDK_TS stage is empty
    And the MULTI_ACTIVE_SATELLITE_TWO_CDK_TS ma_sat is empty

    # ================ DAY 1 ===================
    When the RAW_STAGE_TWO_CDK_TS is loaded
      | CUSTOMER_ID | CUSTOMER_NAME | CUSTOMER_PHONE  | EXTENSION | EFFECTIVE_FROM          | LOAD_DATETIME           | SOURCE |
      | 1001        | Albert        | 17-214-233-1211 | 12301     | 2019-01-01 11:14:54.396 | 2019-01-01 11:14:54.396 | *      |
      | 1001        | Albert        | 17-214-233-1211 | 12302     | 2019-01-01 11:14:54.396 | 2019-01-01 11:14:54.396 | *      |
      | 1001        | Albert        | 17-214-233-1211 | 12303     | 2019-01-01 11:14:54.396 | 2019-01-01 11:14:54.396 | *      |
      | 1002        | Beth          | 17-214-233-1212 | 12311     | 2019-01-01 11:14:54.396 | 2019-01-01 11:14:54.396 | *      |
      | 1002        | Beth          | 17-214-233-1212 | 12312     | 2019-01-01 11:14:54.396 | 2019-01-01 11:14:54.396 | *      |
      | 1002        | Beth          | 17-214-233-1212 | 12313     | 2019-01-01 11:14:54.396 | 2019-01-01 11:14:54.396 | *      |
      | 1003        | Charley       | 17-214-233-1213 | 12321     | 2019-01-01 11:14:54.396 | 2019-01-01 11:14:54.396 | *      |
      | 1003        | Charley       | 17-214-233-1223 | 12321     | 2019-01-01 11:14:54.396 | 2019-01-01 11:14:54.396 | *      |
      | 1003        | Charley       | 17-214-233-1233 | 12321     | 2019-01-01 11:14:54.396 | 2019-01-01 11:14:54.396 | *      |
      | 1010        | Jenny         | 17-214-233-1214 | 12331     | 2019-01-01 11:14:54.396 | 2019-01-01 11:14:54.396 | *      |
      | 1010        | Jenny         | 17-214-233-1224 | 12331     | 2019-01-01 11:14:54.396 | 2019-01-01 11:14:54.396 | *      |
      | 1010        | Jenny         | 17-214-233-1234 | 12331     | 2019-01-01 11:14:54.396 | 2019-01-01 11:14:54.396 | *      |
      | 1012        | Albert        | 17-214-233-1215 | 12341     | 2019-01-01 11:14:54.396 | 2019-01-01 11:14:54.396 | *      |
      | 1012        | Albert        | 17-214-233-1225 | 12341     | 2019-01-01 11:14:54.396 | 2019-01-01 11:14:54.396 | *      |
      | 1012        | Albert        | 17-214-233-1235 | 12341     | 2019-01-01 11:14:54.396 | 2019-01-01 11:14:54.396 | *      |
    And I stage the STG_CUSTOMER_TWO_CDK_TS data
    And I load the MULTI_ACTIVE_SATELLITE_TWO_CDK_TS ma_sat

    # ================ DAY 2 ===================
    # Albert(hd), Beah (hd-), Chris (hd-), David (new), Jenny (+), Albert (hd)
    When the RAW_STAGE_TWO_CDK_TS is loaded
      | CUSTOMER_ID | CUSTOMER_NAME | CUSTOMER_PHONE  | EXTENSION | EFFECTIVE_FROM          | LOAD_DATETIME           | SOURCE |
      | 1001        | Albert        | 17-214-233-1311 | 12301     | 2019-01-02 11:14:54.396 | 2019-01-02 11:14:54.396 | *      |
      | 1001        | Albert        | 17-214-233-1211 | 12302     | 2019-01-02 11:14:54.396 | 2019-01-02 11:14:54.396 | *      |
      | 1001        | Albert        | 17-214-233-1211 | 12303     | 2019-01-02 11:14:54.396 | 2019-01-02 11:14:54.396 | *      |
      | 1002        | Beah          | 17-214-233-1212 | 12311     | 2019-01-02 11:14:54.396 | 2019-01-02 11:14:54.396 | *      |
      | 1002        | Beah          | 17-214-233-1212 | 12312     | 2019-01-02 11:14:54.396 | 2019-01-02 11:14:54.396 | *      |
      | 1003        | Chris         | 17-214-233-1223 | 12321     | 2019-01-02 11:14:54.396 | 2019-01-02 11:14:54.396 | *      |
      | 1004        | David         | 17-214-233-1216 | 12311     | 2019-01-02 11:14:54.396 | 2019-01-02 11:14:54.396 | *      |
      | 1004        | David         | 17-214-233-1226 | 12311     | 2019-01-02 11:14:54.396 | 2019-01-02 11:14:54.396 | *      |
      | 1004        | David         | 17-214-233-1236 | 12311     | 2019-01-02 11:14:54.396 | 2019-01-02 11:14:54.396 | *      |
      | 1010        | Jenny         | 17-214-233-1214 | 12331     | 2019-01-02 11:14:54.396 | 2019-01-02 11:14:54.396 | *      |
      | 1010        | Jenny         | 17-214-233-1224 | 12331     | 2019-01-02 11:14:54.396 | 2019-01-02 11:14:54.396 | *      |
      | 1010        | Jenny         | 17-214-233-1234 | 12331     | 2019-01-02 11:14:54.396 | 2019-01-02 11:14:54.396 | *      |
      | 1010        | Jenny         | 17-214-233-1244 | 12331     | 2019-01-02 11:14:54.396 | 2019-01-02 11:14:54.396 | *      |
      | 1012        | Albert        | 17-214-233-1215 | 92341     | 2019-01-02 11:14:54.396 | 2019-01-02 11:14:54.396 | *      |
      | 1012        | Albert        | 17-214-233-1225 | 12341     | 2019-01-02 11:14:54.396 | 2019-01-02 11:14:54.396 | *      |
      | 1012        | Albert        | 17-214-233-1235 | 12341     | 2019-01-02 11:14:54.396 | 2019-01-02 11:14:54.396 | *      |
    And I stage the STG_CUSTOMER_TWO_CDK_TS data
    And I load the MULTI_ACTIVE_SATELLITE_TWO_CDK_TS ma_sat

    # ================ DAY 3 ===================
    # Beth (hd+), David (-), Freia (new, dupl)
    When the RAW_STAGE_TWO_CDK_TS is loaded
      | CUSTOMER_ID | CUSTOMER_NAME | CUSTOMER_PHONE  | EXTENSION | EFFECTIVE_FROM          | LOAD_DATETIME           | SOURCE |
      | 1002        | Beth          | 17-214-233-1212 | 92301     | 2019-01-03 11:14:54.396 | 2019-01-03 11:14:54.396 | *      |
      | 1002        | Beth          | 17-214-233-1212 | 12302     | 2019-01-03 11:14:54.396 | 2019-01-03 11:14:54.396 | *      |
      | 1002        | Beth          | 17-214-233-1212 | 12303     | 2019-01-03 11:14:54.396 | 2019-01-03 11:14:54.396 | *      |
      | 1004        | David         | 17-214-233-1216 | 12311     | 2019-01-03 11:14:54.396 | 2019-01-03 11:14:54.396 | *      |
      | 1004        | David         | 17-214-233-1226 | 12311     | 2019-01-03 11:14:54.396 | 2019-01-03 11:14:54.396 | *      |
      | 1006        | Freia         | 17-214-233-1212 | 12311     | 2019-01-03 11:14:54.396 | 2019-01-03 11:14:54.396 | *      |
      | 1006        | Freia         | 17-214-233-1212 | 12311     | 2019-01-03 11:14:54.396 | 2019-01-03 11:14:54.396 | *      |
#      | 1003        | Chris         | 17-214-233-1223 | 12321     | 2019-01-03 11:14:54.396 | 2019-01-03 11:14:54.396 | *      |

    And I stage the STG_CUSTOMER_TWO_CDK_TS data
    And I load the MULTI_ACTIVE_SATELLITE_TWO_CDK_TS ma_sat

    # ================ DAY 4 ===================
    # Beah (hd, dupl), Charley (hd), David (+), Freia (hd), Jenny (hd),
    When the RAW_STAGE_TWO_CDK_TS is loaded
      | CUSTOMER_ID | CUSTOMER_NAME | CUSTOMER_PHONE  | EXTENSION | EFFECTIVE_FROM          | LOAD_DATETIME           | SOURCE |
      | 1002        | Beah          | 17-214-233-1312 | 12311     | 2019-01-04 11:14:54.396 | 2019-01-04 11:14:54.396 | *      |
      | 1002        | Beah          | 17-214-233-1212 | 12311     | 2019-01-04 11:14:54.396 | 2019-01-04 11:14:54.396 | *      |
      | 1002        | Beah          | 17-214-233-1212 | 12311     | 2019-01-04 11:14:54.396 | 2019-01-04 11:14:54.396 | *      |
      | 1003        | Charley       | 17-214-233-1223 | 12321     | 2019-01-04 11:14:54.396 | 2019-01-04 11:14:54.396 | *      |
      | 1004        | David         | 17-214-233-1216 | 12311     | 2019-01-04 11:14:54.396 | 2019-01-04 11:14:54.396 | *      |
      | 1004        | David         | 17-214-233-1226 | 12311     | 2019-01-04 11:14:54.396 | 2019-01-04 11:14:54.396 | *      |
      | 1004        | David         | 17-214-233-1236 | 12311     | 2019-01-04 11:14:54.396 | 2019-01-04 11:14:54.396 | *      |
      | 1006        | Freia         | 17-214-233-1312 | 12311     | 2019-01-04 11:14:54.396 | 2019-01-04 11:14:54.396 | *      |
      | 1010        | Jenny         | 17-214-233-1314 | 12331     | 2019-01-04 11:14:54.396 | 2019-01-04 11:14:54.396 | *      |
      | 1010        | Jenny         | 17-214-233-1324 | 12331     | 2019-01-04 11:14:54.396 | 2019-01-04 11:14:54.396 | *      |
      | 1010        | Jenny         | 17-214-233-1334 | 12331     | 2019-01-04 11:14:54.396 | 2019-01-04 11:14:54.396 | *      |
      | 1010        | Jenny         | 17-214-233-1344 | 12331     | 2019-01-04 11:14:54.396 | 2019-01-04 11:14:54.396 | *      |

    And I stage the STG_CUSTOMER_TWO_CDK_TS data
    And I load the MULTI_ACTIVE_SATELLITE_TWO_CDK_TS ma_sat

    # =============== CHECKS ===================
    Then the MULTI_ACTIVE_SATELLITE_TWO_CDK_TS table should contain expected data
      | CUSTOMER_PK | HASHDIFF                                           | CUSTOMER_NAME | CUSTOMER_PHONE  | EXTENSION | EFFECTIVE_FROM          | LOAD_DATETIME           | SOURCE |
      | md5('1001') | md5('1001\|\|ALBERT\|\|17-214-233-1211\|\|12301')  | Albert        | 17-214-233-1211 | 12301     | 2019-01-01 11:14:54.396 | 2019-01-01 11:14:54.396 | *      |
      | md5('1001') | md5('1001\|\|ALBERT\|\|17-214-233-1211\|\|12302')  | Albert        | 17-214-233-1211 | 12302     | 2019-01-01 11:14:54.396 | 2019-01-01 11:14:54.396 | *      |
      | md5('1001') | md5('1001\|\|ALBERT\|\|17-214-233-1211\|\|12303')  | Albert        | 17-214-233-1211 | 12303     | 2019-01-01 11:14:54.396 | 2019-01-01 11:14:54.396 | *      |
      | md5('1002') | md5('1002\|\|BETH\|\|17-214-233-1212\|\|12311')    | Beth          | 17-214-233-1212 | 12311     | 2019-01-01 11:14:54.396 | 2019-01-01 11:14:54.396 | *      |
      | md5('1002') | md5('1002\|\|BETH\|\|17-214-233-1212\|\|12312')    | Beth          | 17-214-233-1212 | 12312     | 2019-01-01 11:14:54.396 | 2019-01-01 11:14:54.396 | *      |
      | md5('1002') | md5('1002\|\|BETH\|\|17-214-233-1212\|\|12313')    | Beth          | 17-214-233-1212 | 12313     | 2019-01-01 11:14:54.396 | 2019-01-01 11:14:54.396 | *      |
      | md5('1003') | md5('1003\|\|CHARLEY\|\|17-214-233-1213\|\|12321') | Charley       | 17-214-233-1213 | 12321     | 2019-01-01 11:14:54.396 | 2019-01-01 11:14:54.396 | *      |
      | md5('1003') | md5('1003\|\|CHARLEY\|\|17-214-233-1223\|\|12321') | Charley       | 17-214-233-1223 | 12321     | 2019-01-01 11:14:54.396 | 2019-01-01 11:14:54.396 | *      |
      | md5('1003') | md5('1003\|\|CHARLEY\|\|17-214-233-1233\|\|12321') | Charley       | 17-214-233-1233 | 12321     | 2019-01-01 11:14:54.396 | 2019-01-01 11:14:54.396 | *      |
      | md5('1010') | md5('1010\|\|JENNY\|\|17-214-233-1214\|\|12331')   | Jenny         | 17-214-233-1214 | 12331     | 2019-01-01 11:14:54.396 | 2019-01-01 11:14:54.396 | *      |
      | md5('1010') | md5('1010\|\|JENNY\|\|17-214-233-1224\|\|12331')   | Jenny         | 17-214-233-1224 | 12331     | 2019-01-01 11:14:54.396 | 2019-01-01 11:14:54.396 | *      |
      | md5('1010') | md5('1010\|\|JENNY\|\|17-214-233-1234\|\|12331')   | Jenny         | 17-214-233-1234 | 12331     | 2019-01-01 11:14:54.396 | 2019-01-01 11:14:54.396 | *      |
      | md5('1012') | md5('1012\|\|ALBERT\|\|17-214-233-1215\|\|12341')  | Albert        | 17-214-233-1215 | 12341     | 2019-01-01 11:14:54.396 | 2019-01-01 11:14:54.396 | *      |
      | md5('1012') | md5('1012\|\|ALBERT\|\|17-214-233-1225\|\|12341')  | Albert        | 17-214-233-1225 | 12341     | 2019-01-01 11:14:54.396 | 2019-01-01 11:14:54.396 | *      |
      | md5('1012') | md5('1012\|\|ALBERT\|\|17-214-233-1235\|\|12341')  | Albert        | 17-214-233-1235 | 12341     | 2019-01-01 11:14:54.396 | 2019-01-01 11:14:54.396 | *      |
      | md5('1001') | md5('1001\|\|ALBERT\|\|17-214-233-1311\|\|12301')  | Albert        | 17-214-233-1311 | 12301     | 2019-01-02 11:14:54.396 | 2019-01-02 11:14:54.396 | *      |
      | md5('1001') | md5('1001\|\|ALBERT\|\|17-214-233-1211\|\|12302')  | Albert        | 17-214-233-1211 | 12302     | 2019-01-02 11:14:54.396 | 2019-01-02 11:14:54.396 | *      |
      | md5('1001') | md5('1001\|\|ALBERT\|\|17-214-233-1211\|\|12303')  | Albert        | 17-214-233-1211 | 12303     | 2019-01-02 11:14:54.396 | 2019-01-02 11:14:54.396 | *      |
      | md5('1002') | md5('1002\|\|BEAH\|\|17-214-233-1212\|\|12311')    | Beah          | 17-214-233-1212 | 12311     | 2019-01-02 11:14:54.396 | 2019-01-02 11:14:54.396 | *      |
      | md5('1002') | md5('1002\|\|BEAH\|\|17-214-233-1212\|\|12312')    | Beah          | 17-214-233-1212 | 12312     | 2019-01-02 11:14:54.396 | 2019-01-02 11:14:54.396 | *      |
      | md5('1003') | md5('1003\|\|CHRIS\|\|17-214-233-1223\|\|12321')   | Chris         | 17-214-233-1223 | 12321     | 2019-01-02 11:14:54.396 | 2019-01-02 11:14:54.396 | *      |
      | md5('1004') | md5('1004\|\|DAVID\|\|17-214-233-1216\|\|12311')   | David         | 17-214-233-1216 | 12311     | 2019-01-02 11:14:54.396 | 2019-01-02 11:14:54.396 | *      |
      | md5('1004') | md5('1004\|\|DAVID\|\|17-214-233-1226\|\|12311')   | David         | 17-214-233-1226 | 12311     | 2019-01-02 11:14:54.396 | 2019-01-02 11:14:54.396 | *      |
      | md5('1004') | md5('1004\|\|DAVID\|\|17-214-233-1236\|\|12311')   | David         | 17-214-233-1236 | 12311     | 2019-01-02 11:14:54.396 | 2019-01-02 11:14:54.396 | *      |
      | md5('1010') | md5('1010\|\|JENNY\|\|17-214-233-1214\|\|12331')   | Jenny         | 17-214-233-1214 | 12331     | 2019-01-02 11:14:54.396 | 2019-01-02 11:14:54.396 | *      |
      | md5('1010') | md5('1010\|\|JENNY\|\|17-214-233-1224\|\|12331')   | Jenny         | 17-214-233-1224 | 12331     | 2019-01-02 11:14:54.396 | 2019-01-02 11:14:54.396 | *      |
      | md5('1010') | md5('1010\|\|JENNY\|\|17-214-233-1234\|\|12331')   | Jenny         | 17-214-233-1234 | 12331     | 2019-01-02 11:14:54.396 | 2019-01-02 11:14:54.396 | *      |
      | md5('1010') | md5('1010\|\|JENNY\|\|17-214-233-1244\|\|12331')   | Jenny         | 17-214-233-1244 | 12331     | 2019-01-02 11:14:54.396 | 2019-01-02 11:14:54.396 | *      |
      | md5('1012') | md5('1012\|\|ALBERT\|\|17-214-233-1215\|\|92341')  | Albert        | 17-214-233-1215 | 92341     | 2019-01-02 11:14:54.396 | 2019-01-02 11:14:54.396 | *      |
      | md5('1012') | md5('1012\|\|ALBERT\|\|17-214-233-1225\|\|12341')  | Albert        | 17-214-233-1225 | 12341     | 2019-01-02 11:14:54.396 | 2019-01-02 11:14:54.396 | *      |
      | md5('1012') | md5('1012\|\|ALBERT\|\|17-214-233-1235\|\|12341')  | Albert        | 17-214-233-1235 | 12341     | 2019-01-02 11:14:54.396 | 2019-01-02 11:14:54.396 | *      |
      | md5('1002') | md5('1002\|\|BETH\|\|17-214-233-1212\|\|92301')    | Beth          | 17-214-233-1212 | 92301     | 2019-01-03 11:14:54.396 | 2019-01-03 11:14:54.396 | *      |
      | md5('1002') | md5('1002\|\|BETH\|\|17-214-233-1212\|\|12302')    | Beth          | 17-214-233-1212 | 12302     | 2019-01-03 11:14:54.396 | 2019-01-03 11:14:54.396 | *      |
      | md5('1002') | md5('1002\|\|BETH\|\|17-214-233-1212\|\|12303')    | Beth          | 17-214-233-1212 | 12303     | 2019-01-03 11:14:54.396 | 2019-01-03 11:14:54.396 | *      |
      | md5('1004') | md5('1004\|\|DAVID\|\|17-214-233-1216\|\|12311')   | David         | 17-214-233-1216 | 12311     | 2019-01-03 11:14:54.396 | 2019-01-03 11:14:54.396 | *      |
      | md5('1004') | md5('1004\|\|DAVID\|\|17-214-233-1226\|\|12311')   | David         | 17-214-233-1226 | 12311     | 2019-01-03 11:14:54.396 | 2019-01-03 11:14:54.396 | *      |
      | md5('1006') | md5('1006\|\|FREIA\|\|17-214-233-1212\|\|12311')   | Freia         | 17-214-233-1212 | 12311     | 2019-01-03 11:14:54.396 | 2019-01-03 11:14:54.396 | *      |
      | md5('1002') | md5('1002\|\|BEAH\|\|17-214-233-1312\|\|12311')    | Beah          | 17-214-233-1312 | 12311     | 2019-01-04 11:14:54.396 | 2019-01-04 11:14:54.396 | *      |
      | md5('1002') | md5('1002\|\|BEAH\|\|17-214-233-1212\|\|12311')    | Beah          | 17-214-233-1212 | 12311     | 2019-01-04 11:14:54.396 | 2019-01-04 11:14:54.396 | *      |
      | md5('1003') | md5('1003\|\|CHARLEY\|\|17-214-233-1223\|\|12321') | Charley       | 17-214-233-1223 | 12321     | 2019-01-04 11:14:54.396 | 2019-01-04 11:14:54.396 | *      |
      | md5('1004') | md5('1004\|\|DAVID\|\|17-214-233-1216\|\|12311')   | David         | 17-214-233-1216 | 12311     | 2019-01-04 11:14:54.396 | 2019-01-04 11:14:54.396 | *      |
      | md5('1004') | md5('1004\|\|DAVID\|\|17-214-233-1226\|\|12311')   | David         | 17-214-233-1226 | 12311     | 2019-01-04 11:14:54.396 | 2019-01-04 11:14:54.396 | *      |
      | md5('1004') | md5('1004\|\|DAVID\|\|17-214-233-1236\|\|12311')   | David         | 17-214-233-1236 | 12311     | 2019-01-04 11:14:54.396 | 2019-01-04 11:14:54.396 | *      |
      | md5('1006') | md5('1006\|\|FREIA\|\|17-214-233-1312\|\|12311')   | Freia         | 17-214-233-1312 | 12311     | 2019-01-04 11:14:54.396 | 2019-01-04 11:14:54.396 | *      |
      | md5('1010') | md5('1010\|\|JENNY\|\|17-214-233-1314\|\|12331')   | Jenny         | 17-214-233-1314 | 12331     | 2019-01-04 11:14:54.396 | 2019-01-04 11:14:54.396 | *      |
      | md5('1010') | md5('1010\|\|JENNY\|\|17-214-233-1324\|\|12331')   | Jenny         | 17-214-233-1324 | 12331     | 2019-01-04 11:14:54.396 | 2019-01-04 11:14:54.396 | *      |
      | md5('1010') | md5('1010\|\|JENNY\|\|17-214-233-1334\|\|12331')   | Jenny         | 17-214-233-1334 | 12331     | 2019-01-04 11:14:54.396 | 2019-01-04 11:14:54.396 | *      |
      | md5('1010') | md5('1010\|\|JENNY\|\|17-214-233-1344\|\|12331')   | Jenny         | 17-214-233-1344 | 12331     | 2019-01-04 11:14:54.396 | 2019-01-04 11:14:54.396 | *      |

  @fixture.multi_active_satellite_cycle
  Scenario: [BQ-MAS-2CD-I-018] Load over several cycles with NULL records
    Given the RAW_STAGE_TWO_CDK stage is empty
    And the MULTI_ACTIVE_SATELLITE_TWO_CDK ma_sat is empty

    # ================ DAY 1 ===================
    When the RAW_STAGE_TWO_CDK is loaded
      | CUSTOMER_ID | CUSTOMER_NAME | CUSTOMER_PHONE  | EXTENSION | EFFECTIVE_FROM | LOAD_DATE  | SOURCE |
      | 1001        | Albert        | 17-214-233-1211 | 12301     | 2019-01-01     | 2019-01-01 | *      |
      | 1001        | Albert        | 17-214-233-1221 | 12301     | 2019-01-01     | 2019-01-01 | *      |
      | 1001        | Albert        | 17-214-233-1231 | 12301     | 2019-01-01     | 2019-01-01 | *      |
      | 1002        | Beth          | 17-214-233-1212 | 12311     | 2019-01-01     | 2019-01-01 | *      |
      | 1002        | Beth          | 17-214-233-1212 | 12312     | 2019-01-01     | 2019-01-01 | *      |
      | 1002        | Beth          | 17-214-233-1212 | 12313     | 2019-01-01     | 2019-01-01 | *      |
      | 1003        | Charley       | 17-214-233-1213 | 12321     | 2019-01-01     | 2019-01-01 | *      |
      | 1003        | Charley       | 17-214-233-1223 | 12322     | 2019-01-01     | 2019-01-01 | *      |
      | 1003        | Charley       | 17-214-233-1233 | 12323     | 2019-01-01     | 2019-01-01 | *      |
    And I stage the STG_CUSTOMER_TWO_CDK data
    And I load the MULTI_ACTIVE_SATELLITE_TWO_CDK ma_sat

    # ================ DAY 2 ===================
    When the RAW_STAGE_TWO_CDK is loaded
      | CUSTOMER_ID | CUSTOMER_NAME | CUSTOMER_PHONE  | EXTENSION | EFFECTIVE_FROM | LOAD_DATE  | SOURCE |
      | <null>      | <null>        | <null>          | 12301     | 2019-01-02     | 2019-01-02 | *      |
      | <null>      | <null>        | 17-214-233-1211 | <null>    | 2019-01-02     | 2019-01-02 | *      |
      | <null>      | Albert        | <null>          | <null>    | 2019-01-02     | 2019-01-02 | *      |
      | 1001        | <null>        | <null>          | <null>    | 2019-01-02     | 2019-01-02 | *      |
      | 1001        | Albert        | <null>          | <null>    | 2019-01-02     | 2019-01-02 | *      |
      | <null>      | <null>        | 17-214-233-1211 | 12301     | 2019-01-02     | 2019-01-02 | *      |
      | <null>      | Albert        | 17-214-233-1211 | <null>    | 2019-01-02     | 2019-01-02 | *      |
      | 1001        | <null>        | <null>          | 12301     | 2019-01-02     | 2019-01-02 | *      |
      | 1001        | Albert        | 17-214-233-1211 | <null>    | 2019-01-02     | 2019-01-02 | *      |
      | 1001        | Albert        | <null>          | 12301     | 2019-01-02     | 2019-01-02 | *      |
      | 1001        | <null>        | 17-214-233-1211 | 12301     | 2019-01-02     | 2019-01-02 | *      |
      | <null>      | Albert        | 17-214-233-1211 | 12301     | 2019-01-02     | 2019-01-02 | *      |
      | 1001        | Albert        | 17-214-233-1221 | 12301     | 2019-01-02     | 2019-01-02 | *      |
    And I stage the STG_CUSTOMER_TWO_CDK data
    And I load the MULTI_ACTIVE_SATELLITE_TWO_CDK ma_sat

    # ================ DAY 3 ===================
    When the RAW_STAGE_TWO_CDK is loaded
      | CUSTOMER_ID | CUSTOMER_NAME | CUSTOMER_PHONE  | EXTENSION | EFFECTIVE_FROM | LOAD_DATE  | SOURCE |
      | <null>      | <null>        | <null>          | 12311     | 2019-01-03     | 2019-01-03 | *      |
      | <null>      | <null>        | 17-214-233-1212 | <null>    | 2019-01-03     | 2019-01-03 | *      |
      | <null>      | Beth          | <null>          | <null>    | 2019-01-03     | 2019-01-03 | *      |
      | 1002        | <null>        | <null>          | <null>    | 2019-01-03     | 2019-01-03 | *      |
      | 1002        | Beth          | <null>          | <null>    | 2019-01-03     | 2019-01-03 | *      |
      | <null>      | <null>        | 17-214-233-1212 | 12311     | 2019-01-03     | 2019-01-03 | *      |
      | <null>      | Beth          | 17-214-233-1212 | <null>    | 2019-01-03     | 2019-01-03 | *      |
      | 1002        | <null>        | <null>          | 12311     | 2019-01-03     | 2019-01-03 | *      |
      | 1002        | Beth          | 17-214-233-1212 | <null>    | 2019-01-03     | 2019-01-03 | *      |
      | 1002        | Beth          | <null>          | 12311     | 2019-01-03     | 2019-01-03 | *      |
      | 1002        | <null>        | 17-214-233-1212 | 12311     | 2019-01-03     | 2019-01-03 | *      |
      | <null>      | Beth          | 17-214-233-1212 | 12311     | 2019-01-03     | 2019-01-03 | *      |
      | 1002        | Beth          | 17-214-233-1222 | 12312     | 2019-01-03     | 2019-01-03 | *      |
      | 1002        | Beah          | 17-214-233-1232 | 12313     | 2019-01-03     | 2019-01-03 | *      |

    And I stage the STG_CUSTOMER_TWO_CDK data
    And I load the MULTI_ACTIVE_SATELLITE_TWO_CDK ma_sat

    # ================ DAY 4 ===================
    When the RAW_STAGE_TWO_CDK is loaded
      | CUSTOMER_ID | CUSTOMER_NAME | CUSTOMER_PHONE  | EXTENSION | EFFECTIVE_FROM | LOAD_DATE  | SOURCE |
      | <null>      | <null>        | <null>          | 12321     | 2019-01-04     | 2019-01-04 | *      |
      | <null>      | <null>        | 17-214-233-1213 | <null>    | 2019-01-04     | 2019-01-04 | *      |
      | <null>      | Charley       | <null>          | <null>    | 2019-01-04     | 2019-01-04 | *      |
      | 1003        | <null>        | <null>          | <null>    | 2019-01-04     | 2019-01-04 | *      |
      | 1003        | Charley       | <null>          | <null>    | 2019-01-04     | 2019-01-04 | *      |
      | <null>      | <null>        | 17-214-233-1213 | 12321     | 2019-01-04     | 2019-01-04 | *      |
      | <null>      | Charley       | 17-214-233-1213 | <null>    | 2019-01-04     | 2019-01-04 | *      |
      | 1003        | <null>        | <null>          | 12321     | 2019-01-04     | 2019-01-04 | *      |
      | 1003        | Charley       | 17-214-233-1213 | <null>    | 2019-01-04     | 2019-01-04 | *      |
      | 1003        | Charley       | <null>          | 12321     | 2019-01-04     | 2019-01-04 | *      |
      | <null>      | Charley       | 17-214-233-1213 | 12321     | 2019-01-04     | 2019-01-04 | *      |

    And I stage the STG_CUSTOMER_TWO_CDK data
    And I load the MULTI_ACTIVE_SATELLITE_TWO_CDK ma_sat

    # =============== CHECKS ===================
    Then the MULTI_ACTIVE_SATELLITE_TWO_CDK table should contain expected data
      | CUSTOMER_PK | HASHDIFF                                           | CUSTOMER_NAME | CUSTOMER_PHONE  | EXTENSION | EFFECTIVE_FROM | LOAD_DATE  | SOURCE |
      | md5('1001') | md5('1001\|\|ALBERT\|\|17-214-233-1211\|\|12301')  | Albert        | 17-214-233-1211 | 12301     | 2019-01-01     | 2019-01-01 | *      |
      | md5('1001') | md5('1001\|\|ALBERT\|\|17-214-233-1221\|\|12301')  | Albert        | 17-214-233-1221 | 12301     | 2019-01-01     | 2019-01-01 | *      |
      | md5('1001') | md5('1001\|\|ALBERT\|\|17-214-233-1231\|\|12301')  | Albert        | 17-214-233-1231 | 12301     | 2019-01-01     | 2019-01-01 | *      |
      | md5('1002') | md5('1002\|\|BETH\|\|17-214-233-1212\|\|12311')    | Beth          | 17-214-233-1212 | 12311     | 2019-01-01     | 2019-01-01 | *      |
      | md5('1002') | md5('1002\|\|BETH\|\|17-214-233-1212\|\|12312')    | Beth          | 17-214-233-1212 | 12312     | 2019-01-01     | 2019-01-01 | *      |
      | md5('1002') | md5('1002\|\|BETH\|\|17-214-233-1212\|\|12313')    | Beth          | 17-214-233-1212 | 12313     | 2019-01-01     | 2019-01-01 | *      |
      | md5('1003') | md5('1003\|\|CHARLEY\|\|17-214-233-1213\|\|12321') | Charley       | 17-214-233-1213 | 12321     | 2019-01-01     | 2019-01-01 | *      |
      | md5('1003') | md5('1003\|\|CHARLEY\|\|17-214-233-1223\|\|12322') | Charley       | 17-214-233-1223 | 12322     | 2019-01-01     | 2019-01-01 | *      |
      | md5('1003') | md5('1003\|\|CHARLEY\|\|17-214-233-1233\|\|12323') | Charley       | 17-214-233-1233 | 12323     | 2019-01-01     | 2019-01-01 | *      |
      | md5('1001') | md5('1001\|\|^^\|\|17-214-233-1211\|\|12301')      | <null>        | 17-214-233-1211 | 12301     | 2019-01-02     | 2019-01-02 | *      |
      | md5('1001') | md5('1001\|\|ALBERT\|\|17-214-233-1221\|\|12301')  | Albert        | 17-214-233-1221 | 12301     | 2019-01-02     | 2019-01-02 | *      |
      | md5('1002') | md5('1002\|\|^^\|\|17-214-233-1212\|\|12311')      | <null>        | 17-214-233-1212 | 12311     | 2019-01-03     | 2019-01-03 | *      |
      | md5('1002') | md5('1002\|\|BETH\|\|17-214-233-1222\|\|12312')    | Beth          | 17-214-233-1222 | 12312     | 2019-01-03     | 2019-01-03 | *      |
      | md5('1002') | md5('1002\|\|BEAH\|\|17-214-233-1232\|\|12313')    | Beah          | 17-214-233-1232 | 12313     | 2019-01-03     | 2019-01-03 | *      |

  @fixture.multi_active_satellite_cycle
  @fixture.enable_sha
  Scenario: [BQ-MAS-2CD-I-019] Load over several cycles
    Given the RAW_STAGE_TWO_CDK stage is empty
    And the MULTI_ACTIVE_SATELLITE_TWO_CDK ma_sat is empty

    # ================ DAY 1 ===================
    When the RAW_STAGE_TWO_CDK is loaded
      | CUSTOMER_ID | CUSTOMER_NAME | CUSTOMER_PHONE  | EXTENSION | EFFECTIVE_FROM | LOAD_DATE  | SOURCE |
      | 1001        | Albert        | 17-214-233-1211 | 12301     | 2019-01-01     | 2019-01-01 | *      |
      | 1001        | Albert        | 17-214-233-1211 | 12302     | 2019-01-01     | 2019-01-01 | *      |
      | 1001        | Albert        | 17-214-233-1211 | 12303     | 2019-01-01     | 2019-01-01 | *      |
      | 1002        | Beth          | 17-214-233-1212 | 12311     | 2019-01-01     | 2019-01-01 | *      |
      | 1002        | Beth          | 17-214-233-1212 | 12312     | 2019-01-01     | 2019-01-01 | *      |
      | 1002        | Beth          | 17-214-233-1212 | 12313     | 2019-01-01     | 2019-01-01 | *      |
      | 1003        | Charley       | 17-214-233-1213 | 12321     | 2019-01-01     | 2019-01-01 | *      |
      | 1003        | Charley       | 17-214-233-1223 | 12321     | 2019-01-01     | 2019-01-01 | *      |
      | 1003        | Charley       | 17-214-233-1233 | 12321     | 2019-01-01     | 2019-01-01 | *      |
      | 1010        | Jenny         | 17-214-233-1214 | 12331     | 2019-01-01     | 2019-01-01 | *      |
      | 1010        | Jenny         | 17-214-233-1224 | 12331     | 2019-01-01     | 2019-01-01 | *      |
      | 1010        | Jenny         | 17-214-233-1234 | 12331     | 2019-01-01     | 2019-01-01 | *      |
      | 1012        | Albert        | 17-214-233-1215 | 12341     | 2019-01-01     | 2019-01-01 | *      |
      | 1012        | Albert        | 17-214-233-1225 | 12341     | 2019-01-01     | 2019-01-01 | *      |
      | 1012        | Albert        | 17-214-233-1235 | 12341     | 2019-01-01     | 2019-01-01 | *      |
    And I stage the STG_CUSTOMER_TWO_CDK data
    And I load the MULTI_ACTIVE_SATELLITE_TWO_CDK ma_sat

    # ================ DAY 2 ===================
    # Albert(hd), Beah (hd-), Chris (hd-), David (new), Jenny (+), Albert (hd)
    When the RAW_STAGE_TWO_CDK is loaded
      | CUSTOMER_ID | CUSTOMER_NAME | CUSTOMER_PHONE  | EXTENSION | EFFECTIVE_FROM | LOAD_DATE  | SOURCE |
      | 1001        | Albert        | 17-214-233-1311 | 12301     | 2019-01-02     | 2019-01-02 | *      |
      | 1001        | Albert        | 17-214-233-1211 | 12302     | 2019-01-02     | 2019-01-02 | *      |
      | 1001        | Albert        | 17-214-233-1211 | 12303     | 2019-01-02     | 2019-01-02 | *      |
      | 1002        | Beah          | 17-214-233-1212 | 12311     | 2019-01-02     | 2019-01-02 | *      |
      | 1002        | Beah          | 17-214-233-1212 | 12312     | 2019-01-02     | 2019-01-02 | *      |
      | 1003        | Chris         | 17-214-233-1223 | 12321     | 2019-01-02     | 2019-01-02 | *      |
      | 1004        | David         | 17-214-233-1216 | 12311     | 2019-01-02     | 2019-01-02 | *      |
      | 1004        | David         | 17-214-233-1226 | 12311     | 2019-01-02     | 2019-01-02 | *      |
      | 1004        | David         | 17-214-233-1236 | 12311     | 2019-01-02     | 2019-01-02 | *      |
      | 1010        | Jenny         | 17-214-233-1214 | 12331     | 2019-01-02     | 2019-01-02 | *      |
      | 1010        | Jenny         | 17-214-233-1224 | 12331     | 2019-01-02     | 2019-01-02 | *      |
      | 1010        | Jenny         | 17-214-233-1234 | 12331     | 2019-01-02     | 2019-01-02 | *      |
      | 1010        | Jenny         | 17-214-233-1244 | 12331     | 2019-01-02     | 2019-01-02 | *      |
      | 1012        | Albert        | 17-214-233-1215 | 92341     | 2019-01-02     | 2019-01-02 | *      |
      | 1012        | Albert        | 17-214-233-1225 | 12341     | 2019-01-02     | 2019-01-02 | *      |
      | 1012        | Albert        | 17-214-233-1235 | 12341     | 2019-01-02     | 2019-01-02 | *      |
    And I stage the STG_CUSTOMER_TWO_CDK data
    And I load the MULTI_ACTIVE_SATELLITE_TWO_CDK ma_sat

    # ================ DAY 3 ===================
    # Beth (hd+), David (-), Freia (new, dupl)
    When the RAW_STAGE_TWO_CDK is loaded
      | CUSTOMER_ID | CUSTOMER_NAME | CUSTOMER_PHONE  | EXTENSION | EFFECTIVE_FROM | LOAD_DATE  | SOURCE |
      | 1002        | Beth          | 17-214-233-1212 | 92301     | 2019-01-03     | 2019-01-03 | *      |
      | 1002        | Beth          | 17-214-233-1212 | 12302     | 2019-01-03     | 2019-01-03 | *      |
      | 1002        | Beth          | 17-214-233-1212 | 12303     | 2019-01-03     | 2019-01-03 | *      |
      | 1004        | David         | 17-214-233-1216 | 12311     | 2019-01-03     | 2019-01-03 | *      |
      | 1004        | David         | 17-214-233-1226 | 12311     | 2019-01-03     | 2019-01-03 | *      |
      | 1006        | Freia         | 17-214-233-1212 | 12311     | 2019-01-03     | 2019-01-03 | *      |
      | 1006        | Freia         | 17-214-233-1212 | 12311     | 2019-01-03     | 2019-01-03 | *      |
#      | 1003        | Chris         | 17-214-233-1223 | 12321     | 2019-01-03     | 2019-01-03 | *      |

    And I stage the STG_CUSTOMER_TWO_CDK data
    And I load the MULTI_ACTIVE_SATELLITE_TWO_CDK ma_sat

    # ================ DAY 4 ===================
    # Beah (hd, dupl), Charley (hd), David (+), Freia (hd), Jenny (hd),
    When the RAW_STAGE_TWO_CDK is loaded
      | CUSTOMER_ID | CUSTOMER_NAME | CUSTOMER_PHONE  | EXTENSION | EFFECTIVE_FROM | LOAD_DATE  | SOURCE |
      | 1002        | Beah          | 17-214-233-1312 | 12311     | 2019-01-04     | 2019-01-04 | *      |
      | 1002        | Beah          | 17-214-233-1212 | 12311     | 2019-01-04     | 2019-01-04 | *      |
      | 1002        | Beah          | 17-214-233-1212 | 12311     | 2019-01-04     | 2019-01-04 | *      |
      | 1003        | Charley       | 17-214-233-1223 | 12321     | 2019-01-04     | 2019-01-04 | *      |
      | 1004        | David         | 17-214-233-1216 | 12311     | 2019-01-04     | 2019-01-04 | *      |
      | 1004        | David         | 17-214-233-1226 | 12311     | 2019-01-04     | 2019-01-04 | *      |
      | 1004        | David         | 17-214-233-1236 | 12311     | 2019-01-04     | 2019-01-04 | *      |
      | 1006        | Freia         | 17-214-233-1312 | 12311     | 2019-01-04     | 2019-01-04 | *      |
      | 1010        | Jenny         | 17-214-233-1314 | 12331     | 2019-01-04     | 2019-01-04 | *      |
      | 1010        | Jenny         | 17-214-233-1324 | 12331     | 2019-01-04     | 2019-01-04 | *      |
      | 1010        | Jenny         | 17-214-233-1334 | 12331     | 2019-01-04     | 2019-01-04 | *      |
      | 1010        | Jenny         | 17-214-233-1344 | 12331     | 2019-01-04     | 2019-01-04 | *      |

    And I stage the STG_CUSTOMER_TWO_CDK data
    And I load the MULTI_ACTIVE_SATELLITE_TWO_CDK ma_sat

    # =============== CHECKS ===================
    Then the MULTI_ACTIVE_SATELLITE_TWO_CDK table should contain expected data
      | CUSTOMER_PK | HASHDIFF                                           | CUSTOMER_NAME | CUSTOMER_PHONE  | EXTENSION | EFFECTIVE_FROM | LOAD_DATE  | SOURCE |
      | sha('1001') | sha('1001\|\|ALBERT\|\|17-214-233-1211\|\|12301')  | Albert        | 17-214-233-1211 | 12301     | 2019-01-01     | 2019-01-01 | *      |
      | sha('1001') | sha('1001\|\|ALBERT\|\|17-214-233-1211\|\|12302')  | Albert        | 17-214-233-1211 | 12302     | 2019-01-01     | 2019-01-01 | *      |
      | sha('1001') | sha('1001\|\|ALBERT\|\|17-214-233-1211\|\|12303')  | Albert        | 17-214-233-1211 | 12303     | 2019-01-01     | 2019-01-01 | *      |
      | sha('1002') | sha('1002\|\|BETH\|\|17-214-233-1212\|\|12311')    | Beth          | 17-214-233-1212 | 12311     | 2019-01-01     | 2019-01-01 | *      |
      | sha('1002') | sha('1002\|\|BETH\|\|17-214-233-1212\|\|12312')    | Beth          | 17-214-233-1212 | 12312     | 2019-01-01     | 2019-01-01 | *      |
      | sha('1002') | sha('1002\|\|BETH\|\|17-214-233-1212\|\|12313')    | Beth          | 17-214-233-1212 | 12313     | 2019-01-01     | 2019-01-01 | *      |
      | sha('1003') | sha('1003\|\|CHARLEY\|\|17-214-233-1213\|\|12321') | Charley       | 17-214-233-1213 | 12321     | 2019-01-01     | 2019-01-01 | *      |
      | sha('1003') | sha('1003\|\|CHARLEY\|\|17-214-233-1223\|\|12321') | Charley       | 17-214-233-1223 | 12321     | 2019-01-01     | 2019-01-01 | *      |
      | sha('1003') | sha('1003\|\|CHARLEY\|\|17-214-233-1233\|\|12321') | Charley       | 17-214-233-1233 | 12321     | 2019-01-01     | 2019-01-01 | *      |
      | sha('1010') | sha('1010\|\|JENNY\|\|17-214-233-1214\|\|12331')   | Jenny         | 17-214-233-1214 | 12331     | 2019-01-01     | 2019-01-01 | *      |
      | sha('1010') | sha('1010\|\|JENNY\|\|17-214-233-1224\|\|12331')   | Jenny         | 17-214-233-1224 | 12331     | 2019-01-01     | 2019-01-01 | *      |
      | sha('1010') | sha('1010\|\|JENNY\|\|17-214-233-1234\|\|12331')   | Jenny         | 17-214-233-1234 | 12331     | 2019-01-01     | 2019-01-01 | *      |
      | sha('1012') | sha('1012\|\|ALBERT\|\|17-214-233-1215\|\|12341')  | Albert        | 17-214-233-1215 | 12341     | 2019-01-01     | 2019-01-01 | *      |
      | sha('1012') | sha('1012\|\|ALBERT\|\|17-214-233-1225\|\|12341')  | Albert        | 17-214-233-1225 | 12341     | 2019-01-01     | 2019-01-01 | *      |
      | sha('1012') | sha('1012\|\|ALBERT\|\|17-214-233-1235\|\|12341')  | Albert        | 17-214-233-1235 | 12341     | 2019-01-01     | 2019-01-01 | *      |
      | sha('1001') | sha('1001\|\|ALBERT\|\|17-214-233-1311\|\|12301')  | Albert        | 17-214-233-1311 | 12301     | 2019-01-02     | 2019-01-02 | *      |
      | sha('1001') | sha('1001\|\|ALBERT\|\|17-214-233-1211\|\|12302')  | Albert        | 17-214-233-1211 | 12302     | 2019-01-02     | 2019-01-02 | *      |
      | sha('1001') | sha('1001\|\|ALBERT\|\|17-214-233-1211\|\|12303')  | Albert        | 17-214-233-1211 | 12303     | 2019-01-02     | 2019-01-02 | *      |
      | sha('1002') | sha('1002\|\|BEAH\|\|17-214-233-1212\|\|12311')    | Beah          | 17-214-233-1212 | 12311     | 2019-01-02     | 2019-01-02 | *      |
      | sha('1002') | sha('1002\|\|BEAH\|\|17-214-233-1212\|\|12312')    | Beah          | 17-214-233-1212 | 12312     | 2019-01-02     | 2019-01-02 | *      |
      | sha('1003') | sha('1003\|\|CHRIS\|\|17-214-233-1223\|\|12321')   | Chris         | 17-214-233-1223 | 12321     | 2019-01-02     | 2019-01-02 | *      |
      | sha('1004') | sha('1004\|\|DAVID\|\|17-214-233-1216\|\|12311')   | David         | 17-214-233-1216 | 12311     | 2019-01-02     | 2019-01-02 | *      |
      | sha('1004') | sha('1004\|\|DAVID\|\|17-214-233-1226\|\|12311')   | David         | 17-214-233-1226 | 12311     | 2019-01-02     | 2019-01-02 | *      |
      | sha('1004') | sha('1004\|\|DAVID\|\|17-214-233-1236\|\|12311')   | David         | 17-214-233-1236 | 12311     | 2019-01-02     | 2019-01-02 | *      |
      | sha('1010') | sha('1010\|\|JENNY\|\|17-214-233-1214\|\|12331')   | Jenny         | 17-214-233-1214 | 12331     | 2019-01-02     | 2019-01-02 | *      |
      | sha('1010') | sha('1010\|\|JENNY\|\|17-214-233-1224\|\|12331')   | Jenny         | 17-214-233-1224 | 12331     | 2019-01-02     | 2019-01-02 | *      |
      | sha('1010') | sha('1010\|\|JENNY\|\|17-214-233-1234\|\|12331')   | Jenny         | 17-214-233-1234 | 12331     | 2019-01-02     | 2019-01-02 | *      |
      | sha('1010') | sha('1010\|\|JENNY\|\|17-214-233-1244\|\|12331')   | Jenny         | 17-214-233-1244 | 12331     | 2019-01-02     | 2019-01-02 | *      |
      | sha('1012') | sha('1012\|\|ALBERT\|\|17-214-233-1215\|\|92341')  | Albert        | 17-214-233-1215 | 92341     | 2019-01-02     | 2019-01-02 | *      |
      | sha('1012') | sha('1012\|\|ALBERT\|\|17-214-233-1225\|\|12341')  | Albert        | 17-214-233-1225 | 12341     | 2019-01-02     | 2019-01-02 | *      |
      | sha('1012') | sha('1012\|\|ALBERT\|\|17-214-233-1235\|\|12341')  | Albert        | 17-214-233-1235 | 12341     | 2019-01-02     | 2019-01-02 | *      |
      | sha('1002') | sha('1002\|\|BETH\|\|17-214-233-1212\|\|92301')    | Beth          | 17-214-233-1212 | 92301     | 2019-01-03     | 2019-01-03 | *      |
      | sha('1002') | sha('1002\|\|BETH\|\|17-214-233-1212\|\|12302')    | Beth          | 17-214-233-1212 | 12302     | 2019-01-03     | 2019-01-03 | *      |
      | sha('1002') | sha('1002\|\|BETH\|\|17-214-233-1212\|\|12303')    | Beth          | 17-214-233-1212 | 12303     | 2019-01-03     | 2019-01-03 | *      |
      | sha('1004') | sha('1004\|\|DAVID\|\|17-214-233-1216\|\|12311')   | David         | 17-214-233-1216 | 12311     | 2019-01-03     | 2019-01-03 | *      |
      | sha('1004') | sha('1004\|\|DAVID\|\|17-214-233-1226\|\|12311')   | David         | 17-214-233-1226 | 12311     | 2019-01-03     | 2019-01-03 | *      |
      | sha('1006') | sha('1006\|\|FREIA\|\|17-214-233-1212\|\|12311')   | Freia         | 17-214-233-1212 | 12311     | 2019-01-03     | 2019-01-03 | *      |
      | sha('1002') | sha('1002\|\|BEAH\|\|17-214-233-1312\|\|12311')    | Beah          | 17-214-233-1312 | 12311     | 2019-01-04     | 2019-01-04 | *      |
      | sha('1002') | sha('1002\|\|BEAH\|\|17-214-233-1212\|\|12311')    | Beah          | 17-214-233-1212 | 12311     | 2019-01-04     | 2019-01-04 | *      |
      | sha('1003') | sha('1003\|\|CHARLEY\|\|17-214-233-1223\|\|12321') | Charley       | 17-214-233-1223 | 12321     | 2019-01-04     | 2019-01-04 | *      |
      | sha('1004') | sha('1004\|\|DAVID\|\|17-214-233-1216\|\|12311')   | David         | 17-214-233-1216 | 12311     | 2019-01-04     | 2019-01-04 | *      |
      | sha('1004') | sha('1004\|\|DAVID\|\|17-214-233-1226\|\|12311')   | David         | 17-214-233-1226 | 12311     | 2019-01-04     | 2019-01-04 | *      |
      | sha('1004') | sha('1004\|\|DAVID\|\|17-214-233-1236\|\|12311')   | David         | 17-214-233-1236 | 12311     | 2019-01-04     | 2019-01-04 | *      |
      | sha('1006') | sha('1006\|\|FREIA\|\|17-214-233-1312\|\|12311')   | Freia         | 17-214-233-1312 | 12311     | 2019-01-04     | 2019-01-04 | *      |
      | sha('1010') | sha('1010\|\|JENNY\|\|17-214-233-1314\|\|12331')   | Jenny         | 17-214-233-1314 | 12331     | 2019-01-04     | 2019-01-04 | *      |
      | sha('1010') | sha('1010\|\|JENNY\|\|17-214-233-1324\|\|12331')   | Jenny         | 17-214-233-1324 | 12331     | 2019-01-04     | 2019-01-04 | *      |
      | sha('1010') | sha('1010\|\|JENNY\|\|17-214-233-1334\|\|12331')   | Jenny         | 17-214-233-1334 | 12331     | 2019-01-04     | 2019-01-04 | *      |
      | sha('1010') | sha('1010\|\|JENNY\|\|17-214-233-1344\|\|12331')   | Jenny         | 17-214-233-1344 | 12331     | 2019-01-04     | 2019-01-04 | *      |
