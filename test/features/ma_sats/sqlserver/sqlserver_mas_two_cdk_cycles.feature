Feature: Multi Active Satellites
  Loading in cycles using separate manual loads of MAS behaviour with two CDKs

  @fixture.multi_active_satellite_cycle
  Scenario: [SAT-CYCLE] Load over several cycles with sets of records keeping the count of records the same while having one or more records changed
    Given the RAW_STAGE_TWO_CDK stage is empty
    And the MULTI_ACTIVE_SATELLITE_TWO_CDK ma_sat is empty

    # ================ DAY 1 ===================
    When the RAW_STAGE_TWO_CDK is loaded
      | CUSTOMER_ID | CUSTOMER_NAME | CUSTOMER_PHONE  | EXTENSION | EFFECTIVE_FROM | LOAD_DATE  | SOURCE |
      | 1001        | Albert        | 17-214-233-1211 | 12301     | 2019-01-01     | 2019-01-01 | *      |
      | 1001        | Albert        | 17-214-233-1211 | 12302     | 2019-01-01     | 2019-01-01 | *      |
      | 1001        | Albert        | 17-214-233-1211 | 12303     | 2019-01-01     | 2019-01-01 | *      |
      | 1002        | Beth          | 17-214-233-1212 | 12311     | 2019-01-01     | 2019-01-01 | *      |
      | 1002        | Beth          | 17-214-233-1212 | 12312     | 2019-01-01     | 2019-01-01 | *      |
      | 1002        | Beth          | 17-214-233-1212 | 12313     | 2019-01-01     | 2019-01-01 | *      |
      | 1003        | Charley       | 17-214-233-1213 | 12321     | 2019-01-01     | 2019-01-01 | *      |
      | 1003        | Charley       | 17-214-233-1223 | 12321     | 2019-01-01     | 2019-01-01 | *      |
      | 1003        | Charley       | 17-214-233-1233 | 12321     | 2019-01-01     | 2019-01-01 | *      |
      | 1010        | Jenny         | 17-214-233-1214 | 12331     | 2019-01-01     | 2019-01-01 | *      |
      | 1010        | Jenny         | 17-214-233-1224 | 12331     | 2019-01-01     | 2019-01-01 | *      |
      | 1010        | Jenny         | 17-214-233-1234 | 12331     | 2019-01-01     | 2019-01-01 | *      |

    And I stage the STG_CUSTOMER_TWO_CDK data
    And I load the MULTI_ACTIVE_SATELLITE_TWO_CDK ma_sat

    # ================ DAY 2 ===================
    When the RAW_STAGE_TWO_CDK is loaded
      | CUSTOMER_ID | CUSTOMER_NAME | CUSTOMER_PHONE  | EXTENSION | EFFECTIVE_FROM | LOAD_DATE  | SOURCE |
      | 1001        | Albert        | 17-214-233-1211 | 12301     | 2019-01-02     | 2019-01-02 | *      |
      | 1001        | Albert        | 17-214-233-1211 | 12302     | 2019-01-02     | 2019-01-02 | *      |
      | 1001        | Albert        | 17-214-233-1211 | 12304     | 2019-01-02     | 2019-01-02 | *      |
      | 1003        | Charley       | 17-214-233-1213 | 12321     | 2019-01-02     | 2019-01-02 | *      |
      | 1003        | Charley       | 17-214-233-1223 | 12321     | 2019-01-02     | 2019-01-02 | *      |
      | 1003        | Charley       | 17-214-233-1243 | 12321     | 2019-01-02     | 2019-01-02 | *      |

    And I stage the STG_CUSTOMER_TWO_CDK data
    And I load the MULTI_ACTIVE_SATELLITE_TWO_CDK ma_sat

    # ================ DAY 3 ===================
    When the RAW_STAGE_TWO_CDK is loaded
      | CUSTOMER_ID | CUSTOMER_NAME | CUSTOMER_PHONE  | EXTENSION | EFFECTIVE_FROM | LOAD_DATE  | SOURCE |
      | 1002        | Beth          | 17-214-233-1212 | 12311     | 2019-01-03     | 2019-01-03 | *      |
      | 1002        | Beah          | 17-214-233-1212 | 12314     | 2019-01-03     | 2019-01-03 | *      |
      | 1002        | Beth          | 17-214-233-1212 | 12315     | 2019-01-03     | 2019-01-03 | *      |
      | 1010        | Jenny         | 17-214-233-1214 | 12331     | 2019-01-03     | 2019-01-03 | *      |
      | 1010        | Jenny         | 17-214-233-1244 | 12331     | 2019-01-03     | 2019-01-03 | *      |
      | 1010        | Jenny         | 17-214-233-1254 | 12331     | 2019-01-03     | 2019-01-03 | *      |

    And I stage the STG_CUSTOMER_TWO_CDK data
    And I load the MULTI_ACTIVE_SATELLITE_TWO_CDK ma_sat

    # =============== CHECKS ===================
    Then the MULTI_ACTIVE_SATELLITE_TWO_CDK table should contain expected data
      | CUSTOMER_PK | HASHDIFF                                           | CUSTOMER_NAME | CUSTOMER_PHONE  | EXTENSION | EFFECTIVE_FROM | LOAD_DATE  | SOURCE |
      | md5('1001') | md5('1001\|\|ALBERT\|\|17-214-233-1211\|\|12301')  | Albert        | 17-214-233-1211 | 12301     | 2019-01-01     | 2019-01-01 | *      |
      | md5('1001') | md5('1001\|\|ALBERT\|\|17-214-233-1211\|\|12302')  | Albert        | 17-214-233-1211 | 12302     | 2019-01-01     | 2019-01-01 | *      |
      | md5('1001') | md5('1001\|\|ALBERT\|\|17-214-233-1211\|\|12303')  | Albert        | 17-214-233-1211 | 12303     | 2019-01-01     | 2019-01-01 | *      |
      | md5('1002') | md5('1002\|\|BETH\|\|17-214-233-1212\|\|12311')    | Beth          | 17-214-233-1212 | 12311     | 2019-01-01     | 2019-01-01 | *      |
      | md5('1002') | md5('1002\|\|BETH\|\|17-214-233-1212\|\|12312')    | Beth          | 17-214-233-1212 | 12312     | 2019-01-01     | 2019-01-01 | *      |
      | md5('1002') | md5('1002\|\|BETH\|\|17-214-233-1212\|\|12313')    | Beth          | 17-214-233-1212 | 12313     | 2019-01-01     | 2019-01-01 | *      |
      | md5('1003') | md5('1003\|\|CHARLEY\|\|17-214-233-1213\|\|12321') | Charley       | 17-214-233-1213 | 12321     | 2019-01-01     | 2019-01-01 | *      |
      | md5('1003') | md5('1003\|\|CHARLEY\|\|17-214-233-1223\|\|12321') | Charley       | 17-214-233-1223 | 12321     | 2019-01-01     | 2019-01-01 | *      |
      | md5('1003') | md5('1003\|\|CHARLEY\|\|17-214-233-1233\|\|12321') | Charley       | 17-214-233-1233 | 12321     | 2019-01-01     | 2019-01-01 | *      |
      | md5('1010') | md5('1010\|\|JENNY\|\|17-214-233-1214\|\|12331')   | Jenny         | 17-214-233-1214 | 12331     | 2019-01-01     | 2019-01-01 | *      |
      | md5('1010') | md5('1010\|\|JENNY\|\|17-214-233-1224\|\|12331')   | Jenny         | 17-214-233-1224 | 12331     | 2019-01-01     | 2019-01-01 | *      |
      | md5('1010') | md5('1010\|\|JENNY\|\|17-214-233-1234\|\|12331')   | Jenny         | 17-214-233-1234 | 12331     | 2019-01-01     | 2019-01-01 | *      |
      | md5('1001') | md5('1001\|\|ALBERT\|\|17-214-233-1211\|\|12301')  | Albert        | 17-214-233-1211 | 12301     | 2019-01-02     | 2019-01-02 | *      |
      | md5('1001') | md5('1001\|\|ALBERT\|\|17-214-233-1211\|\|12302')  | Albert        | 17-214-233-1211 | 12302     | 2019-01-02     | 2019-01-02 | *      |
      | md5('1001') | md5('1001\|\|ALBERT\|\|17-214-233-1211\|\|12304')  | Albert        | 17-214-233-1211 | 12304     | 2019-01-02     | 2019-01-02 | *      |
      | md5('1003') | md5('1003\|\|CHARLEY\|\|17-214-233-1213\|\|12321') | Charley       | 17-214-233-1213 | 12321     | 2019-01-02     | 2019-01-02 | *      |
      | md5('1003') | md5('1003\|\|CHARLEY\|\|17-214-233-1223\|\|12321') | Charley       | 17-214-233-1223 | 12321     | 2019-01-02     | 2019-01-02 | *      |
      | md5('1003') | md5('1003\|\|CHARLEY\|\|17-214-233-1243\|\|12321') | Charley       | 17-214-233-1243 | 12321     | 2019-01-02     | 2019-01-02 | *      |
      | md5('1002') | md5('1002\|\|BETH\|\|17-214-233-1212\|\|12311')    | Beth          | 17-214-233-1212 | 12311     | 2019-01-03     | 2019-01-03 | *      |
      | md5('1002') | md5('1002\|\|BEAH\|\|17-214-233-1212\|\|12314')    | Beah          | 17-214-233-1212 | 12314     | 2019-01-03     | 2019-01-03 | *      |
      | md5('1002') | md5('1002\|\|BETH\|\|17-214-233-1212\|\|12315')    | Beth          | 17-214-233-1212 | 12315     | 2019-01-03     | 2019-01-03 | *      |
      | md5('1010') | md5('1010\|\|JENNY\|\|17-214-233-1214\|\|12331')   | Jenny         | 17-214-233-1214 | 12331     | 2019-01-03     | 2019-01-03 | *      |
      | md5('1010') | md5('1010\|\|JENNY\|\|17-214-233-1244\|\|12331')   | Jenny         | 17-214-233-1244 | 12331     | 2019-01-03     | 2019-01-03 | *      |
      | md5('1010') | md5('1010\|\|JENNY\|\|17-214-233-1254\|\|12331')   | Jenny         | 17-214-233-1254 | 12331     | 2019-01-03     | 2019-01-03 | *      |

  @fixture.multi_active_satellite_cycle
  Scenario: [SAT-CYCLE] Load over several cycles
    Given the RAW_STAGE_TWO_CDK stage is empty
    And the MULTI_ACTIVE_SATELLITE_TWO_CDK ma_sat is empty

    # ================ DAY 1 ===================
    When the RAW_STAGE_TWO_CDK is loaded
      | CUSTOMER_ID | CUSTOMER_NAME | CUSTOMER_PHONE  | EXTENSION | EFFECTIVE_FROM | LOAD_DATE  | SOURCE |
      | 1001        | Albert        | 17-214-233-1211 | 12301     | 2019-01-01     | 2019-01-01 | *      |
      | 1001        | Albert        | 17-214-233-1211 | 12302     | 2019-01-01     | 2019-01-01 | *      |
      | 1001        | Albert        | 17-214-233-1211 | 12303     | 2019-01-01     | 2019-01-01 | *      |
      | 1002        | Beth          | 17-214-233-1212 | 12311     | 2019-01-01     | 2019-01-01 | *      |
      | 1002        | Beth          | 17-214-233-1212 | 12312     | 2019-01-01     | 2019-01-01 | *      |
      | 1002        | Beth          | 17-214-233-1212 | 12313     | 2019-01-01     | 2019-01-01 | *      |
      | 1003        | Charley       | 17-214-233-1213 | 12321     | 2019-01-01     | 2019-01-01 | *      |
      | 1003        | Charley       | 17-214-233-1223 | 12321     | 2019-01-01     | 2019-01-01 | *      |
      | 1003        | Charley       | 17-214-233-1233 | 12321     | 2019-01-01     | 2019-01-01 | *      |
      | 1010        | Jenny         | 17-214-233-1214 | 12331     | 2019-01-01     | 2019-01-01 | *      |
      | 1010        | Jenny         | 17-214-233-1224 | 12331     | 2019-01-01     | 2019-01-01 | *      |
      | 1010        | Jenny         | 17-214-233-1234 | 12331     | 2019-01-01     | 2019-01-01 | *      |
      | 1012        | Albert        | 17-214-233-1215 | 12341     | 2019-01-01     | 2019-01-01 | *      |
      | 1012        | Albert        | 17-214-233-1225 | 12341     | 2019-01-01     | 2019-01-01 | *      |
      | 1012        | Albert        | 17-214-233-1235 | 12341     | 2019-01-01     | 2019-01-01 | *      |
    And I stage the STG_CUSTOMER_TWO_CDK data
    And I load the MULTI_ACTIVE_SATELLITE_TWO_CDK ma_sat

    # ================ DAY 2 ===================
    # Albert(hd), Beah (hd-), Chris (hd-), David (new), Jenny (+), Albert (hd)
    When the RAW_STAGE_TWO_CDK is loaded
      | CUSTOMER_ID | CUSTOMER_NAME | CUSTOMER_PHONE  | EXTENSION | EFFECTIVE_FROM | LOAD_DATE  | SOURCE |
      | 1001        | Albert        | 17-214-233-1311 | 12301     | 2019-01-02     | 2019-01-02 | *      |
      | 1001        | Albert        | 17-214-233-1211 | 12302     | 2019-01-02     | 2019-01-02 | *      |
      | 1001        | Albert        | 17-214-233-1211 | 12303     | 2019-01-02     | 2019-01-02 | *      |
      | 1002        | Beah          | 17-214-233-1212 | 12311     | 2019-01-02     | 2019-01-02 | *      |
      | 1002        | Beah          | 17-214-233-1212 | 12312     | 2019-01-02     | 2019-01-02 | *      |
      | 1003        | Chris         | 17-214-233-1223 | 12321     | 2019-01-02     | 2019-01-02 | *      |
      | 1004        | David         | 17-214-233-1216 | 12311     | 2019-01-02     | 2019-01-02 | *      |
      | 1004        | David         | 17-214-233-1226 | 12311     | 2019-01-02     | 2019-01-02 | *      |
      | 1004        | David         | 17-214-233-1236 | 12311     | 2019-01-02     | 2019-01-02 | *      |
      | 1010        | Jenny         | 17-214-233-1214 | 12331     | 2019-01-02     | 2019-01-02 | *      |
      | 1010        | Jenny         | 17-214-233-1224 | 12331     | 2019-01-02     | 2019-01-02 | *      |
      | 1010        | Jenny         | 17-214-233-1234 | 12331     | 2019-01-02     | 2019-01-02 | *      |
      | 1010        | Jenny         | 17-214-233-1244 | 12331     | 2019-01-02     | 2019-01-02 | *      |
      | 1012        | Albert        | 17-214-233-1215 | 92341     | 2019-01-02     | 2019-01-02 | *      |
      | 1012        | Albert        | 17-214-233-1225 | 12341     | 2019-01-02     | 2019-01-02 | *      |
      | 1012        | Albert        | 17-214-233-1235 | 12341     | 2019-01-02     | 2019-01-02 | *      |
    And I stage the STG_CUSTOMER_TWO_CDK data
    And I load the MULTI_ACTIVE_SATELLITE_TWO_CDK ma_sat

    # ================ DAY 3 ===================
    # Beth (hd+), David (-), Freia (new, dupl)
    When the RAW_STAGE_TWO_CDK is loaded
      | CUSTOMER_ID | CUSTOMER_NAME | CUSTOMER_PHONE  | EXTENSION | EFFECTIVE_FROM | LOAD_DATE  | SOURCE |
      | 1002        | Beth          | 17-214-233-1212 | 92301     | 2019-01-03     | 2019-01-03 | *      |
      | 1002        | Beth          | 17-214-233-1212 | 12302     | 2019-01-03     | 2019-01-03 | *      |
      | 1002        | Beth          | 17-214-233-1212 | 12303     | 2019-01-03     | 2019-01-03 | *      |
      | 1004        | David         | 17-214-233-1216 | 12311     | 2019-01-03     | 2019-01-03 | *      |
      | 1004        | David         | 17-214-233-1226 | 12311     | 2019-01-03     | 2019-01-03 | *      |
      | 1006        | Freia         | 17-214-233-1212 | 12311     | 2019-01-03     | 2019-01-03 | *      |
      | 1006        | Freia         | 17-214-233-1212 | 12311     | 2019-01-03     | 2019-01-03 | *      |
      | 1003        | Chris         | 17-214-233-1223 | 12321     | 2019-01-03     | 2019-01-03 | *      |
      | 1003        | Chris         | 17-214-233-1224 | 12321     | 2019-01-03     | 2019-01-03 | *      |
      | 1003        | Chriss        | 17-214-233-1223 | 12321     | 2019-01-03     | 2019-01-03 | *      |

    And I stage the STG_CUSTOMER_TWO_CDK data
    And I load the MULTI_ACTIVE_SATELLITE_TWO_CDK ma_sat

    # ================ DAY 4 ===================
    # Beah (hd, dupl), Charley (hd), David (+), Freia (hd), Jenny (hd),
    When the RAW_STAGE_TWO_CDK is loaded
      | CUSTOMER_ID | CUSTOMER_NAME | CUSTOMER_PHONE  | EXTENSION | EFFECTIVE_FROM | LOAD_DATE  | SOURCE |
      | 1002        | Beah          | 17-214-233-1312 | 12311     | 2019-01-04     | 2019-01-04 | *      |
      | 1002        | Beah          | 17-214-233-1212 | 12311     | 2019-01-04     | 2019-01-04 | *      |
      | 1002        | Beah          | 17-214-233-1212 | 12311     | 2019-01-04     | 2019-01-04 | *      |
      | 1003        | Charley       | 17-214-233-1223 | 12321     | 2019-01-04     | 2019-01-04 | *      |
      | 1004        | David         | 17-214-233-1216 | 12311     | 2019-01-04     | 2019-01-04 | *      |
      | 1004        | David         | 17-214-233-1226 | 12311     | 2019-01-04     | 2019-01-04 | *      |
      | 1004        | David         | 17-214-233-1236 | 12311     | 2019-01-04     | 2019-01-04 | *      |
      | 1006        | Freia         | 17-214-233-1312 | 12311     | 2019-01-04     | 2019-01-04 | *      |
      | 1010        | Jenny         | 17-214-233-1314 | 12331     | 2019-01-04     | 2019-01-04 | *      |
      | 1010        | Jenny         | 17-214-233-1324 | 12331     | 2019-01-04     | 2019-01-04 | *      |
      | 1010        | Jenny         | 17-214-233-1334 | 12331     | 2019-01-04     | 2019-01-04 | *      |
      | 1010        | Jenny         | 17-214-233-1344 | 12331     | 2019-01-04     | 2019-01-04 | *      |

    And I stage the STG_CUSTOMER_TWO_CDK data
    And I load the MULTI_ACTIVE_SATELLITE_TWO_CDK ma_sat

    # =============== CHECKS ===================
    Then the MULTI_ACTIVE_SATELLITE_TWO_CDK table should contain expected data
      | CUSTOMER_PK | HASHDIFF                                           | CUSTOMER_NAME | CUSTOMER_PHONE  | EXTENSION | EFFECTIVE_FROM | LOAD_DATE  | SOURCE |
      | md5('1001') | md5('1001\|\|ALBERT\|\|17-214-233-1211\|\|12301')  | Albert        | 17-214-233-1211 | 12301     | 2019-01-01     | 2019-01-01 | *      |
      | md5('1001') | md5('1001\|\|ALBERT\|\|17-214-233-1211\|\|12302')  | Albert        | 17-214-233-1211 | 12302     | 2019-01-01     | 2019-01-01 | *      |
      | md5('1001') | md5('1001\|\|ALBERT\|\|17-214-233-1211\|\|12303')  | Albert        | 17-214-233-1211 | 12303     | 2019-01-01     | 2019-01-01 | *      |
      | md5('1002') | md5('1002\|\|BETH\|\|17-214-233-1212\|\|12311')    | Beth          | 17-214-233-1212 | 12311     | 2019-01-01     | 2019-01-01 | *      |
      | md5('1002') | md5('1002\|\|BETH\|\|17-214-233-1212\|\|12312')    | Beth          | 17-214-233-1212 | 12312     | 2019-01-01     | 2019-01-01 | *      |
      | md5('1002') | md5('1002\|\|BETH\|\|17-214-233-1212\|\|12313')    | Beth          | 17-214-233-1212 | 12313     | 2019-01-01     | 2019-01-01 | *      |
      | md5('1003') | md5('1003\|\|CHARLEY\|\|17-214-233-1213\|\|12321') | Charley       | 17-214-233-1213 | 12321     | 2019-01-01     | 2019-01-01 | *      |
      | md5('1003') | md5('1003\|\|CHARLEY\|\|17-214-233-1223\|\|12321') | Charley       | 17-214-233-1223 | 12321     | 2019-01-01     | 2019-01-01 | *      |
      | md5('1003') | md5('1003\|\|CHARLEY\|\|17-214-233-1233\|\|12321') | Charley       | 17-214-233-1233 | 12321     | 2019-01-01     | 2019-01-01 | *      |
      | md5('1010') | md5('1010\|\|JENNY\|\|17-214-233-1214\|\|12331')   | Jenny         | 17-214-233-1214 | 12331     | 2019-01-01     | 2019-01-01 | *      |
      | md5('1010') | md5('1010\|\|JENNY\|\|17-214-233-1224\|\|12331')   | Jenny         | 17-214-233-1224 | 12331     | 2019-01-01     | 2019-01-01 | *      |
      | md5('1010') | md5('1010\|\|JENNY\|\|17-214-233-1234\|\|12331')   | Jenny         | 17-214-233-1234 | 12331     | 2019-01-01     | 2019-01-01 | *      |
      | md5('1012') | md5('1012\|\|ALBERT\|\|17-214-233-1215\|\|12341')  | Albert        | 17-214-233-1215 | 12341     | 2019-01-01     | 2019-01-01 | *      |
      | md5('1012') | md5('1012\|\|ALBERT\|\|17-214-233-1225\|\|12341')  | Albert        | 17-214-233-1225 | 12341     | 2019-01-01     | 2019-01-01 | *      |
      | md5('1012') | md5('1012\|\|ALBERT\|\|17-214-233-1235\|\|12341')  | Albert        | 17-214-233-1235 | 12341     | 2019-01-01     | 2019-01-01 | *      |
      | md5('1001') | md5('1001\|\|ALBERT\|\|17-214-233-1311\|\|12301')  | Albert        | 17-214-233-1311 | 12301     | 2019-01-02     | 2019-01-02 | *      |
      | md5('1001') | md5('1001\|\|ALBERT\|\|17-214-233-1211\|\|12302')  | Albert        | 17-214-233-1211 | 12302     | 2019-01-02     | 2019-01-02 | *      |
      | md5('1001') | md5('1001\|\|ALBERT\|\|17-214-233-1211\|\|12303')  | Albert        | 17-214-233-1211 | 12303     | 2019-01-02     | 2019-01-02 | *      |
      | md5('1002') | md5('1002\|\|BEAH\|\|17-214-233-1212\|\|12311')    | Beah          | 17-214-233-1212 | 12311     | 2019-01-02     | 2019-01-02 | *      |
      | md5('1002') | md5('1002\|\|BEAH\|\|17-214-233-1212\|\|12312')    | Beah          | 17-214-233-1212 | 12312     | 2019-01-02     | 2019-01-02 | *      |
      | md5('1003') | md5('1003\|\|CHRIS\|\|17-214-233-1223\|\|12321')   | Chris         | 17-214-233-1223 | 12321     | 2019-01-02     | 2019-01-02 | *      |
      | md5('1004') | md5('1004\|\|DAVID\|\|17-214-233-1216\|\|12311')   | David         | 17-214-233-1216 | 12311     | 2019-01-02     | 2019-01-02 | *      |
      | md5('1004') | md5('1004\|\|DAVID\|\|17-214-233-1226\|\|12311')   | David         | 17-214-233-1226 | 12311     | 2019-01-02     | 2019-01-02 | *      |
      | md5('1004') | md5('1004\|\|DAVID\|\|17-214-233-1236\|\|12311')   | David         | 17-214-233-1236 | 12311     | 2019-01-02     | 2019-01-02 | *      |
      | md5('1010') | md5('1010\|\|JENNY\|\|17-214-233-1214\|\|12331')   | Jenny         | 17-214-233-1214 | 12331     | 2019-01-02     | 2019-01-02 | *      |
      | md5('1010') | md5('1010\|\|JENNY\|\|17-214-233-1224\|\|12331')   | Jenny         | 17-214-233-1224 | 12331     | 2019-01-02     | 2019-01-02 | *      |
      | md5('1010') | md5('1010\|\|JENNY\|\|17-214-233-1234\|\|12331')   | Jenny         | 17-214-233-1234 | 12331     | 2019-01-02     | 2019-01-02 | *      |
      | md5('1010') | md5('1010\|\|JENNY\|\|17-214-233-1244\|\|12331')   | Jenny         | 17-214-233-1244 | 12331     | 2019-01-02     | 2019-01-02 | *      |
      | md5('1012') | md5('1012\|\|ALBERT\|\|17-214-233-1215\|\|92341')  | Albert        | 17-214-233-1215 | 92341     | 2019-01-02     | 2019-01-02 | *      |
      | md5('1012') | md5('1012\|\|ALBERT\|\|17-214-233-1225\|\|12341')  | Albert        | 17-214-233-1225 | 12341     | 2019-01-02     | 2019-01-02 | *      |
      | md5('1012') | md5('1012\|\|ALBERT\|\|17-214-233-1235\|\|12341')  | Albert        | 17-214-233-1235 | 12341     | 2019-01-02     | 2019-01-02 | *      |
      | md5('1002') | md5('1002\|\|BETH\|\|17-214-233-1212\|\|92301')    | Beth          | 17-214-233-1212 | 92301     | 2019-01-03     | 2019-01-03 | *      |
      | md5('1002') | md5('1002\|\|BETH\|\|17-214-233-1212\|\|12302')    | Beth          | 17-214-233-1212 | 12302     | 2019-01-03     | 2019-01-03 | *      |
      | md5('1002') | md5('1002\|\|BETH\|\|17-214-233-1212\|\|12303')    | Beth          | 17-214-233-1212 | 12303     | 2019-01-03     | 2019-01-03 | *      |
      | md5('1004') | md5('1004\|\|DAVID\|\|17-214-233-1216\|\|12311')   | David         | 17-214-233-1216 | 12311     | 2019-01-03     | 2019-01-03 | *      |
      | md5('1004') | md5('1004\|\|DAVID\|\|17-214-233-1226\|\|12311')   | David         | 17-214-233-1226 | 12311     | 2019-01-03     | 2019-01-03 | *      |
      | md5('1006') | md5('1006\|\|FREIA\|\|17-214-233-1212\|\|12311')   | Freia         | 17-214-233-1212 | 12311     | 2019-01-03     | 2019-01-03 | *      |
      | md5('1002') | md5('1002\|\|BEAH\|\|17-214-233-1312\|\|12311')    | Beah          | 17-214-233-1312 | 12311     | 2019-01-04     | 2019-01-04 | *      |
      | md5('1002') | md5('1002\|\|BEAH\|\|17-214-233-1212\|\|12311')    | Beah          | 17-214-233-1212 | 12311     | 2019-01-04     | 2019-01-04 | *      |
      | md5('1003') | md5('1003\|\|CHARLEY\|\|17-214-233-1223\|\|12321') | Charley       | 17-214-233-1223 | 12321     | 2019-01-04     | 2019-01-04 | *      |
      | md5('1004') | md5('1004\|\|DAVID\|\|17-214-233-1216\|\|12311')   | David         | 17-214-233-1216 | 12311     | 2019-01-04     | 2019-01-04 | *      |
      | md5('1004') | md5('1004\|\|DAVID\|\|17-214-233-1226\|\|12311')   | David         | 17-214-233-1226 | 12311     | 2019-01-04     | 2019-01-04 | *      |
      | md5('1004') | md5('1004\|\|DAVID\|\|17-214-233-1236\|\|12311')   | David         | 17-214-233-1236 | 12311     | 2019-01-04     | 2019-01-04 | *      |
      | md5('1006') | md5('1006\|\|FREIA\|\|17-214-233-1312\|\|12311')   | Freia         | 17-214-233-1312 | 12311     | 2019-01-04     | 2019-01-04 | *      |
      | md5('1010') | md5('1010\|\|JENNY\|\|17-214-233-1314\|\|12331')   | Jenny         | 17-214-233-1314 | 12331     | 2019-01-04     | 2019-01-04 | *      |
      | md5('1010') | md5('1010\|\|JENNY\|\|17-214-233-1324\|\|12331')   | Jenny         | 17-214-233-1324 | 12331     | 2019-01-04     | 2019-01-04 | *      |
      | md5('1010') | md5('1010\|\|JENNY\|\|17-214-233-1334\|\|12331')   | Jenny         | 17-214-233-1334 | 12331     | 2019-01-04     | 2019-01-04 | *      |
      | md5('1010') | md5('1010\|\|JENNY\|\|17-214-233-1344\|\|12331')   | Jenny         | 17-214-233-1344 | 12331     | 2019-01-04     | 2019-01-04 | *      |
      | md5('1003') | md5('1003\|\|CHRIS\|\|17-214-233-1223\|\|12321')   | Chris         | 17-214-233-1223 | 12321     | 2019-01-03     | 2019-01-03 | *      |
      | md5('1003') | md5('1003\|\|CHRIS\|\|17-214-233-1224\|\|12321')   | Chris         | 17-214-233-1224 | 12321     | 2019-01-03     | 2019-01-03 | *      |
      | md5('1003') | md5('1003\|\|CHRISS\|\|17-214-233-1223\|\|12321')  | Chriss        | 17-214-233-1223 | 12321     | 2019-01-03     | 2019-01-03 | *      |

  @fixture.multi_active_satellite_cycle
  Scenario: [SAT-CYCLE] Load over several cycles with Timestamps
    Given the RAW_STAGE_TWO_CDK_TS stage is empty
    And the MULTI_ACTIVE_SATELLITE_TWO_CDK_TS ma_sat is empty

    # ================ DAY 1 ===================
    When the RAW_STAGE_TWO_CDK_TS is loaded
      | CUSTOMER_ID | CUSTOMER_NAME | CUSTOMER_PHONE  | EXTENSION | EFFECTIVE_FROM          | LOAD_DATETIME           | SOURCE |
      | 1001        | Albert        | 17-214-233-1211 | 12301     | 2019-01-01 11:14:54.396 | 2019-01-01 11:14:54.396 | *      |
      | 1001        | Albert        | 17-214-233-1211 | 12302     | 2019-01-01 11:14:54.396 | 2019-01-01 11:14:54.396 | *      |
      | 1001        | Albert        | 17-214-233-1211 | 12303     | 2019-01-01 11:14:54.396 | 2019-01-01 11:14:54.396 | *      |
      | 1002        | Beth          | 17-214-233-1212 | 12311     | 2019-01-01 11:14:54.396 | 2019-01-01 11:14:54.396 | *      |
      | 1002        | Beth          | 17-214-233-1212 | 12312     | 2019-01-01 11:14:54.396 | 2019-01-01 11:14:54.396 | *      |
      | 1002        | Beth          | 17-214-233-1212 | 12313     | 2019-01-01 11:14:54.396 | 2019-01-01 11:14:54.396 | *      |
      | 1003        | Charley       | 17-214-233-1213 | 12321     | 2019-01-01 11:14:54.396 | 2019-01-01 11:14:54.396 | *      |
      | 1003        | Charley       | 17-214-233-1223 | 12321     | 2019-01-01 11:14:54.396 | 2019-01-01 11:14:54.396 | *      |
      | 1003        | Charley       | 17-214-233-1233 | 12321     | 2019-01-01 11:14:54.396 | 2019-01-01 11:14:54.396 | *      |
      | 1010        | Jenny         | 17-214-233-1214 | 12331     | 2019-01-01 11:14:54.396 | 2019-01-01 11:14:54.396 | *      |
      | 1010        | Jenny         | 17-214-233-1224 | 12331     | 2019-01-01 11:14:54.396 | 2019-01-01 11:14:54.396 | *      |
      | 1010        | Jenny         | 17-214-233-1234 | 12331     | 2019-01-01 11:14:54.396 | 2019-01-01 11:14:54.396 | *      |
      | 1012        | Albert        | 17-214-233-1215 | 12341     | 2019-01-01 11:14:54.396 | 2019-01-01 11:14:54.396 | *      |
      | 1012        | Albert        | 17-214-233-1225 | 12341     | 2019-01-01 11:14:54.396 | 2019-01-01 11:14:54.396 | *      |
      | 1012        | Albert        | 17-214-233-1235 | 12341     | 2019-01-01 11:14:54.396 | 2019-01-01 11:14:54.396 | *      |
    And I stage the STG_CUSTOMER_TWO_CDK_TS data
    And I load the MULTI_ACTIVE_SATELLITE_TWO_CDK_TS ma_sat

    # ================ DAY 2 ===================
    # Albert(hd), Beah (hd-), Chris (hd-), David (new), Jenny (+), Albert (hd)
    When the RAW_STAGE_TWO_CDK_TS is loaded
      | CUSTOMER_ID | CUSTOMER_NAME | CUSTOMER_PHONE  | EXTENSION | EFFECTIVE_FROM          | LOAD_DATETIME           | SOURCE |
      | 1001        | Albert        | 17-214-233-1311 | 12301     | 2019-01-02 11:14:54.396 | 2019-01-02 11:14:54.396 | *      |
      | 1001        | Albert        | 17-214-233-1211 | 12302     | 2019-01-02 11:14:54.396 | 2019-01-02 11:14:54.396 | *      |
      | 1001        | Albert        | 17-214-233-1211 | 12303     | 2019-01-02 11:14:54.396 | 2019-01-02 11:14:54.396 | *      |
      | 1002        | Beah          | 17-214-233-1212 | 12311     | 2019-01-02 11:14:54.396 | 2019-01-02 11:14:54.396 | *      |
      | 1002        | Beah          | 17-214-233-1212 | 12312     | 2019-01-02 11:14:54.396 | 2019-01-02 11:14:54.396 | *      |
      | 1003        | Chris         | 17-214-233-1223 | 12321     | 2019-01-02 11:14:54.396 | 2019-01-02 11:14:54.396 | *      |
      | 1004        | David         | 17-214-233-1216 | 12311     | 2019-01-02 11:14:54.396 | 2019-01-02 11:14:54.396 | *      |
      | 1004        | David         | 17-214-233-1226 | 12311     | 2019-01-02 11:14:54.396 | 2019-01-02 11:14:54.396 | *      |
      | 1004        | David         | 17-214-233-1236 | 12311     | 2019-01-02 11:14:54.396 | 2019-01-02 11:14:54.396 | *      |
      | 1010        | Jenny         | 17-214-233-1214 | 12331     | 2019-01-02 11:14:54.396 | 2019-01-02 11:14:54.396 | *      |
      | 1010        | Jenny         | 17-214-233-1224 | 12331     | 2019-01-02 11:14:54.396 | 2019-01-02 11:14:54.396 | *      |
      | 1010        | Jenny         | 17-214-233-1234 | 12331     | 2019-01-02 11:14:54.396 | 2019-01-02 11:14:54.396 | *      |
      | 1010        | Jenny         | 17-214-233-1244 | 12331     | 2019-01-02 11:14:54.396 | 2019-01-02 11:14:54.396 | *      |
      | 1012        | Albert        | 17-214-233-1215 | 92341     | 2019-01-02 11:14:54.396 | 2019-01-02 11:14:54.396 | *      |
      | 1012        | Albert        | 17-214-233-1225 | 12341     | 2019-01-02 11:14:54.396 | 2019-01-02 11:14:54.396 | *      |
      | 1012        | Albert        | 17-214-233-1235 | 12341     | 2019-01-02 11:14:54.396 | 2019-01-02 11:14:54.396 | *      |
    And I stage the STG_CUSTOMER_TWO_CDK_TS data
    And I load the MULTI_ACTIVE_SATELLITE_TWO_CDK_TS ma_sat

    # ================ DAY 3 ===================
    # Beth (hd+), David (-), Freia (new, dupl)
    When the RAW_STAGE_TWO_CDK_TS is loaded
      | CUSTOMER_ID | CUSTOMER_NAME | CUSTOMER_PHONE  | EXTENSION | EFFECTIVE_FROM          | LOAD_DATETIME           | SOURCE |
      | 1002        | Beth          | 17-214-233-1212 | 92301     | 2019-01-03 11:14:54.396 | 2019-01-03 11:14:54.396 | *      |
      | 1002        | Beth          | 17-214-233-1212 | 12302     | 2019-01-03 11:14:54.396 | 2019-01-03 11:14:54.396 | *      |
      | 1002        | Beth          | 17-214-233-1212 | 12303     | 2019-01-03 11:14:54.396 | 2019-01-03 11:14:54.396 | *      |
      | 1004        | David         | 17-214-233-1216 | 12311     | 2019-01-03 11:14:54.396 | 2019-01-03 11:14:54.396 | *      |
      | 1004        | David         | 17-214-233-1226 | 12311     | 2019-01-03 11:14:54.396 | 2019-01-03 11:14:54.396 | *      |
      | 1006        | Freia         | 17-214-233-1212 | 12311     | 2019-01-03 11:14:54.396 | 2019-01-03 11:14:54.396 | *      |
      | 1006        | Freia         | 17-214-233-1212 | 12311     | 2019-01-03 11:14:54.396 | 2019-01-03 11:14:54.396 | *      |
#      | 1003        | Chris         | 17-214-233-1223 | 12321     | 2019-01-03 11:14:54.396 | 2019-01-03 11:14:54.396 | *      |

    And I stage the STG_CUSTOMER_TWO_CDK_TS data
    And I load the MULTI_ACTIVE_SATELLITE_TWO_CDK_TS ma_sat

    # ================ DAY 4 ===================
    # Beah (hd, dupl), Charley (hd), David (+), Freia (hd), Jenny (hd),
    When the RAW_STAGE_TWO_CDK_TS is loaded
      | CUSTOMER_ID | CUSTOMER_NAME | CUSTOMER_PHONE  | EXTENSION | EFFECTIVE_FROM          | LOAD_DATETIME           | SOURCE |
      | 1002        | Beah          | 17-214-233-1312 | 12311     | 2019-01-04 11:14:54.396 | 2019-01-04 11:14:54.396 | *      |
      | 1002        | Beah          | 17-214-233-1212 | 12311     | 2019-01-04 11:14:54.396 | 2019-01-04 11:14:54.396 | *      |
      | 1002        | Beah          | 17-214-233-1212 | 12311     | 2019-01-04 11:14:54.396 | 2019-01-04 11:14:54.396 | *      |
      | 1003        | Charley       | 17-214-233-1223 | 12321     | 2019-01-04 11:14:54.396 | 2019-01-04 11:14:54.396 | *      |
      | 1004        | David         | 17-214-233-1216 | 12311     | 2019-01-04 11:14:54.396 | 2019-01-04 11:14:54.396 | *      |
      | 1004        | David         | 17-214-233-1226 | 12311     | 2019-01-04 11:14:54.396 | 2019-01-04 11:14:54.396 | *      |
      | 1004        | David         | 17-214-233-1236 | 12311     | 2019-01-04 11:14:54.396 | 2019-01-04 11:14:54.396 | *      |
      | 1006        | Freia         | 17-214-233-1312 | 12311     | 2019-01-04 11:14:54.396 | 2019-01-04 11:14:54.396 | *      |
      | 1010        | Jenny         | 17-214-233-1314 | 12331     | 2019-01-04 11:14:54.396 | 2019-01-04 11:14:54.396 | *      |
      | 1010        | Jenny         | 17-214-233-1324 | 12331     | 2019-01-04 11:14:54.396 | 2019-01-04 11:14:54.396 | *      |
      | 1010        | Jenny         | 17-214-233-1334 | 12331     | 2019-01-04 11:14:54.396 | 2019-01-04 11:14:54.396 | *      |
      | 1010        | Jenny         | 17-214-233-1344 | 12331     | 2019-01-04 11:14:54.396 | 2019-01-04 11:14:54.396 | *      |

    And I stage the STG_CUSTOMER_TWO_CDK_TS data
    And I load the MULTI_ACTIVE_SATELLITE_TWO_CDK_TS ma_sat

    # =============== CHECKS ===================
    Then the MULTI_ACTIVE_SATELLITE_TWO_CDK_TS table should contain expected data
      | CUSTOMER_PK | HASHDIFF                                           | CUSTOMER_NAME | CUSTOMER_PHONE  | EXTENSION | EFFECTIVE_FROM          | LOAD_DATETIME           | SOURCE |
      | md5('1001') | md5('1001\|\|ALBERT\|\|17-214-233-1211\|\|12301')  | Albert        | 17-214-233-1211 | 12301     | 2019-01-01 11:14:54.396 | 2019-01-01 11:14:54.396 | *      |
      | md5('1001') | md5('1001\|\|ALBERT\|\|17-214-233-1211\|\|12302')  | Albert        | 17-214-233-1211 | 12302     | 2019-01-01 11:14:54.396 | 2019-01-01 11:14:54.396 | *      |
      | md5('1001') | md5('1001\|\|ALBERT\|\|17-214-233-1211\|\|12303')  | Albert        | 17-214-233-1211 | 12303     | 2019-01-01 11:14:54.396 | 2019-01-01 11:14:54.396 | *      |
      | md5('1002') | md5('1002\|\|BETH\|\|17-214-233-1212\|\|12311')    | Beth          | 17-214-233-1212 | 12311     | 2019-01-01 11:14:54.396 | 2019-01-01 11:14:54.396 | *      |
      | md5('1002') | md5('1002\|\|BETH\|\|17-214-233-1212\|\|12312')    | Beth          | 17-214-233-1212 | 12312     | 2019-01-01 11:14:54.396 | 2019-01-01 11:14:54.396 | *      |
      | md5('1002') | md5('1002\|\|BETH\|\|17-214-233-1212\|\|12313')    | Beth          | 17-214-233-1212 | 12313     | 2019-01-01 11:14:54.396 | 2019-01-01 11:14:54.396 | *      |
      | md5('1003') | md5('1003\|\|CHARLEY\|\|17-214-233-1213\|\|12321') | Charley       | 17-214-233-1213 | 12321     | 2019-01-01 11:14:54.396 | 2019-01-01 11:14:54.396 | *      |
      | md5('1003') | md5('1003\|\|CHARLEY\|\|17-214-233-1223\|\|12321') | Charley       | 17-214-233-1223 | 12321     | 2019-01-01 11:14:54.396 | 2019-01-01 11:14:54.396 | *      |
      | md5('1003') | md5('1003\|\|CHARLEY\|\|17-214-233-1233\|\|12321') | Charley       | 17-214-233-1233 | 12321     | 2019-01-01 11:14:54.396 | 2019-01-01 11:14:54.396 | *      |
      | md5('1010') | md5('1010\|\|JENNY\|\|17-214-233-1214\|\|12331')   | Jenny         | 17-214-233-1214 | 12331     | 2019-01-01 11:14:54.396 | 2019-01-01 11:14:54.396 | *      |
      | md5('1010') | md5('1010\|\|JENNY\|\|17-214-233-1224\|\|12331')   | Jenny         | 17-214-233-1224 | 12331     | 2019-01-01 11:14:54.396 | 2019-01-01 11:14:54.396 | *      |
      | md5('1010') | md5('1010\|\|JENNY\|\|17-214-233-1234\|\|12331')   | Jenny         | 17-214-233-1234 | 12331     | 2019-01-01 11:14:54.396 | 2019-01-01 11:14:54.396 | *      |
      | md5('1012') | md5('1012\|\|ALBERT\|\|17-214-233-1215\|\|12341')  | Albert        | 17-214-233-1215 | 12341     | 2019-01-01 11:14:54.396 | 2019-01-01 11:14:54.396 | *      |
      | md5('1012') | md5('1012\|\|ALBERT\|\|17-214-233-1225\|\|12341')  | Albert        | 17-214-233-1225 | 12341     | 2019-01-01 11:14:54.396 | 2019-01-01 11:14:54.396 | *      |
      | md5('1012') | md5('1012\|\|ALBERT\|\|17-214-233-1235\|\|12341')  | Albert        | 17-214-233-1235 | 12341     | 2019-01-01 11:14:54.396 | 2019-01-01 11:14:54.396 | *      |
      | md5('1001') | md5('1001\|\|ALBERT\|\|17-214-233-1311\|\|12301')  | Albert        | 17-214-233-1311 | 12301     | 2019-01-02 11:14:54.396 | 2019-01-02 11:14:54.396 | *      |
      | md5('1001') | md5('1001\|\|ALBERT\|\|17-214-233-1211\|\|12302')  | Albert        | 17-214-233-1211 | 12302     | 2019-01-02 11:14:54.396 | 2019-01-02 11:14:54.396 | *      |
      | md5('1001') | md5('1001\|\|ALBERT\|\|17-214-233-1211\|\|12303')  | Albert        | 17-214-233-1211 | 12303     | 2019-01-02 11:14:54.396 | 2019-01-02 11:14:54.396 | *      |
      | md5('1002') | md5('1002\|\|BEAH\|\|17-214-233-1212\|\|12311')    | Beah          | 17-214-233-1212 | 12311     | 2019-01-02 11:14:54.396 | 2019-01-02 11:14:54.396 | *      |
      | md5('1002') | md5('1002\|\|BEAH\|\|17-214-233-1212\|\|12312')    | Beah          | 17-214-233-1212 | 12312     | 2019-01-02 11:14:54.396 | 2019-01-02 11:14:54.396 | *      |
      | md5('1003') | md5('1003\|\|CHRIS\|\|17-214-233-1223\|\|12321')   | Chris         | 17-214-233-1223 | 12321     | 2019-01-02 11:14:54.396 | 2019-01-02 11:14:54.396 | *      |
      | md5('1004') | md5('1004\|\|DAVID\|\|17-214-233-1216\|\|12311')   | David         | 17-214-233-1216 | 12311     | 2019-01-02 11:14:54.396 | 2019-01-02 11:14:54.396 | *      |
      | md5('1004') | md5('1004\|\|DAVID\|\|17-214-233-1226\|\|12311')   | David         | 17-214-233-1226 | 12311     | 2019-01-02 11:14:54.396 | 2019-01-02 11:14:54.396 | *      |
      | md5('1004') | md5('1004\|\|DAVID\|\|17-214-233-1236\|\|12311')   | David         | 17-214-233-1236 | 12311     | 2019-01-02 11:14:54.396 | 2019-01-02 11:14:54.396 | *      |
      | md5('1010') | md5('1010\|\|JENNY\|\|17-214-233-1214\|\|12331')   | Jenny         | 17-214-233-1214 | 12331     | 2019-01-02 11:14:54.396 | 2019-01-02 11:14:54.396 | *      |
      | md5('1010') | md5('1010\|\|JENNY\|\|17-214-233-1224\|\|12331')   | Jenny         | 17-214-233-1224 | 12331     | 2019-01-02 11:14:54.396 | 2019-01-02 11:14:54.396 | *      |
      | md5('1010') | md5('1010\|\|JENNY\|\|17-214-233-1234\|\|12331')   | Jenny         | 17-214-233-1234 | 12331     | 2019-01-02 11:14:54.396 | 2019-01-02 11:14:54.396 | *      |
      | md5('1010') | md5('1010\|\|JENNY\|\|17-214-233-1244\|\|12331')   | Jenny         | 17-214-233-1244 | 12331     | 2019-01-02 11:14:54.396 | 2019-01-02 11:14:54.396 | *      |
      | md5('1012') | md5('1012\|\|ALBERT\|\|17-214-233-1215\|\|92341')  | Albert        | 17-214-233-1215 | 92341     | 2019-01-02 11:14:54.396 | 2019-01-02 11:14:54.396 | *      |
      | md5('1012') | md5('1012\|\|ALBERT\|\|17-214-233-1225\|\|12341')  | Albert        | 17-214-233-1225 | 12341     | 2019-01-02 11:14:54.396 | 2019-01-02 11:14:54.396 | *      |
      | md5('1012') | md5('1012\|\|ALBERT\|\|17-214-233-1235\|\|12341')  | Albert        | 17-214-233-1235 | 12341     | 2019-01-02 11:14:54.396 | 2019-01-02 11:14:54.396 | *      |
      | md5('1002') | md5('1002\|\|BETH\|\|17-214-233-1212\|\|92301')    | Beth          | 17-214-233-1212 | 92301     | 2019-01-03 11:14:54.396 | 2019-01-03 11:14:54.396 | *      |
      | md5('1002') | md5('1002\|\|BETH\|\|17-214-233-1212\|\|12302')    | Beth          | 17-214-233-1212 | 12302     | 2019-01-03 11:14:54.396 | 2019-01-03 11:14:54.396 | *      |
      | md5('1002') | md5('1002\|\|BETH\|\|17-214-233-1212\|\|12303')    | Beth          | 17-214-233-1212 | 12303     | 2019-01-03 11:14:54.396 | 2019-01-03 11:14:54.396 | *      |
      | md5('1004') | md5('1004\|\|DAVID\|\|17-214-233-1216\|\|12311')   | David         | 17-214-233-1216 | 12311     | 2019-01-03 11:14:54.396 | 2019-01-03 11:14:54.396 | *      |
      | md5('1004') | md5('1004\|\|DAVID\|\|17-214-233-1226\|\|12311')   | David         | 17-214-233-1226 | 12311     | 2019-01-03 11:14:54.396 | 2019-01-03 11:14:54.396 | *      |
      | md5('1006') | md5('1006\|\|FREIA\|\|17-214-233-1212\|\|12311')   | Freia         | 17-214-233-1212 | 12311     | 2019-01-03 11:14:54.396 | 2019-01-03 11:14:54.396 | *      |
      | md5('1002') | md5('1002\|\|BEAH\|\|17-214-233-1312\|\|12311')    | Beah          | 17-214-233-1312 | 12311     | 2019-01-04 11:14:54.396 | 2019-01-04 11:14:54.396 | *      |
      | md5('1002') | md5('1002\|\|BEAH\|\|17-214-233-1212\|\|12311')    | Beah          | 17-214-233-1212 | 12311     | 2019-01-04 11:14:54.396 | 2019-01-04 11:14:54.396 | *      |
      | md5('1003') | md5('1003\|\|CHARLEY\|\|17-214-233-1223\|\|12321') | Charley       | 17-214-233-1223 | 12321     | 2019-01-04 11:14:54.396 | 2019-01-04 11:14:54.396 | *      |
      | md5('1004') | md5('1004\|\|DAVID\|\|17-214-233-1216\|\|12311')   | David         | 17-214-233-1216 | 12311     | 2019-01-04 11:14:54.396 | 2019-01-04 11:14:54.396 | *      |
      | md5('1004') | md5('1004\|\|DAVID\|\|17-214-233-1226\|\|12311')   | David         | 17-214-233-1226 | 12311     | 2019-01-04 11:14:54.396 | 2019-01-04 11:14:54.396 | *      |
      | md5('1004') | md5('1004\|\|DAVID\|\|17-214-233-1236\|\|12311')   | David         | 17-214-233-1236 | 12311     | 2019-01-04 11:14:54.396 | 2019-01-04 11:14:54.396 | *      |
      | md5('1006') | md5('1006\|\|FREIA\|\|17-214-233-1312\|\|12311')   | Freia         | 17-214-233-1312 | 12311     | 2019-01-04 11:14:54.396 | 2019-01-04 11:14:54.396 | *      |
      | md5('1010') | md5('1010\|\|JENNY\|\|17-214-233-1314\|\|12331')   | Jenny         | 17-214-233-1314 | 12331     | 2019-01-04 11:14:54.396 | 2019-01-04 11:14:54.396 | *      |
      | md5('1010') | md5('1010\|\|JENNY\|\|17-214-233-1324\|\|12331')   | Jenny         | 17-214-233-1324 | 12331     | 2019-01-04 11:14:54.396 | 2019-01-04 11:14:54.396 | *      |
      | md5('1010') | md5('1010\|\|JENNY\|\|17-214-233-1334\|\|12331')   | Jenny         | 17-214-233-1334 | 12331     | 2019-01-04 11:14:54.396 | 2019-01-04 11:14:54.396 | *      |
      | md5('1010') | md5('1010\|\|JENNY\|\|17-214-233-1344\|\|12331')   | Jenny         | 17-214-233-1344 | 12331     | 2019-01-04 11:14:54.396 | 2019-01-04 11:14:54.396 | *      |

  @fixture.multi_active_satellite_cycle
  Scenario: [SAT-CYCLE-NULLS] Load over several cycles with NULL records
    Given the RAW_STAGE_TWO_CDK stage is empty
    And the MULTI_ACTIVE_SATELLITE_TWO_CDK ma_sat is empty

    # ================ DAY 1 ===================
    When the RAW_STAGE_TWO_CDK is loaded
      | CUSTOMER_ID | CUSTOMER_NAME | CUSTOMER_PHONE  | EXTENSION | EFFECTIVE_FROM | LOAD_DATE  | SOURCE |
      | 1001        | Albert        | 17-214-233-1211 | 12301     | 2019-01-01     | 2019-01-01 | *      |
      | 1001        | Albert        | 17-214-233-1221 | 12301     | 2019-01-01     | 2019-01-01 | *      |
      | 1001        | Albert        | 17-214-233-1231 | 12301     | 2019-01-01     | 2019-01-01 | *      |
      | 1002        | Beth          | 17-214-233-1212 | 12311     | 2019-01-01     | 2019-01-01 | *      |
      | 1002        | Beth          | 17-214-233-1212 | 12312     | 2019-01-01     | 2019-01-01 | *      |
      | 1002        | Beth          | 17-214-233-1212 | 12313     | 2019-01-01     | 2019-01-01 | *      |
      | 1003        | Charley       | 17-214-233-1213 | 12321     | 2019-01-01     | 2019-01-01 | *      |
      | 1003        | Charley       | 17-214-233-1223 | 12322     | 2019-01-01     | 2019-01-01 | *      |
      | 1003        | Charley       | 17-214-233-1233 | 12323     | 2019-01-01     | 2019-01-01 | *      |
    And I stage the STG_CUSTOMER_TWO_CDK data
    And I load the MULTI_ACTIVE_SATELLITE_TWO_CDK ma_sat

    # ================ DAY 2 ===================
    When the RAW_STAGE_TWO_CDK is loaded
      | CUSTOMER_ID | CUSTOMER_NAME | CUSTOMER_PHONE  | EXTENSION | EFFECTIVE_FROM | LOAD_DATE  | SOURCE |
      | <null>      | <null>        | <null>          | 12301     | 2019-01-02     | 2019-01-02 | *      |
      | <null>      | <null>        | 17-214-233-1211 | <null>    | 2019-01-02     | 2019-01-02 | *      |
      | <null>      | Albert        | <null>          | <null>    | 2019-01-02     | 2019-01-02 | *      |
      | 1001        | <null>        | <null>          | <null>    | 2019-01-02     | 2019-01-02 | *      |
      | 1001        | Albert        | <null>          | <null>    | 2019-01-02     | 2019-01-02 | *      |
      | <null>      | <null>        | 17-214-233-1211 | 12301     | 2019-01-02     | 2019-01-02 | *      |
      | <null>      | Albert        | 17-214-233-1211 | <null>    | 2019-01-02     | 2019-01-02 | *      |
      | 1001        | <null>        | <null>          | 12301     | 2019-01-02     | 2019-01-02 | *      |
      | 1001        | Albert        | 17-214-233-1211 | <null>    | 2019-01-02     | 2019-01-02 | *      |
      | 1001        | Albert        | <null>          | 12301     | 2019-01-02     | 2019-01-02 | *      |
      | 1001        | <null>        | 17-214-233-1211 | 12301     | 2019-01-02     | 2019-01-02 | *      |
      | <null>      | Albert        | 17-214-233-1211 | 12301     | 2019-01-02     | 2019-01-02 | *      |
      | 1001        | Albert        | 17-214-233-1221 | 12301     | 2019-01-02     | 2019-01-02 | *      |
    And I stage the STG_CUSTOMER_TWO_CDK data
    And I load the MULTI_ACTIVE_SATELLITE_TWO_CDK ma_sat

    # ================ DAY 3 ===================
    When the RAW_STAGE_TWO_CDK is loaded
      | CUSTOMER_ID | CUSTOMER_NAME | CUSTOMER_PHONE  | EXTENSION | EFFECTIVE_FROM | LOAD_DATE  | SOURCE |
      | <null>      | <null>        | <null>          | 12311     | 2019-01-03     | 2019-01-03 | *      |
      | <null>      | <null>        | 17-214-233-1212 | <null>    | 2019-01-03     | 2019-01-03 | *      |
      | <null>      | Beth          | <null>          | <null>    | 2019-01-03     | 2019-01-03 | *      |
      | 1002        | <null>        | <null>          | <null>    | 2019-01-03     | 2019-01-03 | *      |
      | 1002        | Beth          | <null>          | <null>    | 2019-01-03     | 2019-01-03 | *      |
      | <null>      | <null>        | 17-214-233-1212 | 12311     | 2019-01-03     | 2019-01-03 | *      |
      | <null>      | Beth          | 17-214-233-1212 | <null>    | 2019-01-03     | 2019-01-03 | *      |
      | 1002        | <null>        | <null>          | 12311     | 2019-01-03     | 2019-01-03 | *      |
      | 1002        | Beth          | 17-214-233-1212 | <null>    | 2019-01-03     | 2019-01-03 | *      |
      | 1002        | Beth          | <null>          | 12311     | 2019-01-03     | 2019-01-03 | *      |
      | 1002        | <null>        | 17-214-233-1212 | 12311     | 2019-01-03     | 2019-01-03 | *      |
      | <null>      | Beth          | 17-214-233-1212 | 12311     | 2019-01-03     | 2019-01-03 | *      |
      | 1002        | Beth          | 17-214-233-1222 | 12312     | 2019-01-03     | 2019-01-03 | *      |
      | 1002        | Beah          | 17-214-233-1232 | 12313     | 2019-01-03     | 2019-01-03 | *      |

    And I stage the STG_CUSTOMER_TWO_CDK data
    And I load the MULTI_ACTIVE_SATELLITE_TWO_CDK ma_sat

    # ================ DAY 4 ===================
    When the RAW_STAGE_TWO_CDK is loaded
      | CUSTOMER_ID | CUSTOMER_NAME | CUSTOMER_PHONE  | EXTENSION | EFFECTIVE_FROM | LOAD_DATE  | SOURCE |
      | <null>      | <null>        | <null>          | 12321     | 2019-01-04     | 2019-01-04 | *      |
      | <null>      | <null>        | 17-214-233-1213 | <null>    | 2019-01-04     | 2019-01-04 | *      |
      | <null>      | Charley       | <null>          | <null>    | 2019-01-04     | 2019-01-04 | *      |
      | 1003        | <null>        | <null>          | <null>    | 2019-01-04     | 2019-01-04 | *      |
      | 1003        | Charley       | <null>          | <null>    | 2019-01-04     | 2019-01-04 | *      |
      | <null>      | <null>        | 17-214-233-1213 | 12321     | 2019-01-04     | 2019-01-04 | *      |
      | <null>      | Charley       | 17-214-233-1213 | <null>    | 2019-01-04     | 2019-01-04 | *      |
      | 1003        | <null>        | <null>          | 12321     | 2019-01-04     | 2019-01-04 | *      |
      | 1003        | Charley       | 17-214-233-1213 | <null>    | 2019-01-04     | 2019-01-04 | *      |
      | 1003        | Charley       | <null>          | 12321     | 2019-01-04     | 2019-01-04 | *      |
      | <null>      | Charley       | 17-214-233-1213 | 12321     | 2019-01-04     | 2019-01-04 | *      |

    And I stage the STG_CUSTOMER_TWO_CDK data
    And I load the MULTI_ACTIVE_SATELLITE_TWO_CDK ma_sat

    # =============== CHECKS ===================
    Then the MULTI_ACTIVE_SATELLITE_TWO_CDK table should contain expected data
      | CUSTOMER_PK | HASHDIFF                                           | CUSTOMER_NAME | CUSTOMER_PHONE  | EXTENSION | EFFECTIVE_FROM | LOAD_DATE  | SOURCE |
      | md5('1001') | md5('1001\|\|ALBERT\|\|17-214-233-1211\|\|12301')  | Albert        | 17-214-233-1211 | 12301     | 2019-01-01     | 2019-01-01 | *      |
      | md5('1001') | md5('1001\|\|ALBERT\|\|17-214-233-1221\|\|12301')  | Albert        | 17-214-233-1221 | 12301     | 2019-01-01     | 2019-01-01 | *      |
      | md5('1001') | md5('1001\|\|ALBERT\|\|17-214-233-1231\|\|12301')  | Albert        | 17-214-233-1231 | 12301     | 2019-01-01     | 2019-01-01 | *      |
      | md5('1002') | md5('1002\|\|BETH\|\|17-214-233-1212\|\|12311')    | Beth          | 17-214-233-1212 | 12311     | 2019-01-01     | 2019-01-01 | *      |
      | md5('1002') | md5('1002\|\|BETH\|\|17-214-233-1212\|\|12312')    | Beth          | 17-214-233-1212 | 12312     | 2019-01-01     | 2019-01-01 | *      |
      | md5('1002') | md5('1002\|\|BETH\|\|17-214-233-1212\|\|12313')    | Beth          | 17-214-233-1212 | 12313     | 2019-01-01     | 2019-01-01 | *      |
      | md5('1003') | md5('1003\|\|CHARLEY\|\|17-214-233-1213\|\|12321') | Charley       | 17-214-233-1213 | 12321     | 2019-01-01     | 2019-01-01 | *      |
      | md5('1003') | md5('1003\|\|CHARLEY\|\|17-214-233-1223\|\|12322') | Charley       | 17-214-233-1223 | 12322     | 2019-01-01     | 2019-01-01 | *      |
      | md5('1003') | md5('1003\|\|CHARLEY\|\|17-214-233-1233\|\|12323') | Charley       | 17-214-233-1233 | 12323     | 2019-01-01     | 2019-01-01 | *      |
      | md5('1001') | md5('1001\|\|^^\|\|17-214-233-1211\|\|12301')      | <null>        | 17-214-233-1211 | 12301     | 2019-01-02     | 2019-01-02 | *      |
      | md5('1001') | md5('1001\|\|ALBERT\|\|17-214-233-1221\|\|12301')  | Albert        | 17-214-233-1221 | 12301     | 2019-01-02     | 2019-01-02 | *      |
      | md5('1002') | md5('1002\|\|^^\|\|17-214-233-1212\|\|12311')      | <null>        | 17-214-233-1212 | 12311     | 2019-01-03     | 2019-01-03 | *      |
      | md5('1002') | md5('1002\|\|BETH\|\|17-214-233-1222\|\|12312')    | Beth          | 17-214-233-1222 | 12312     | 2019-01-03     | 2019-01-03 | *      |
      | md5('1002') | md5('1002\|\|BEAH\|\|17-214-233-1232\|\|12313')    | Beah          | 17-214-233-1232 | 12313     | 2019-01-03     | 2019-01-03 | *      |

  @fixture.multi_active_satellite_cycle
  @fixture.enable_sha
  Scenario: [SAT-CYCLE-SHA] Load over several cycles
    Given the RAW_STAGE_TWO_CDK stage is empty
    And the MULTI_ACTIVE_SATELLITE_TWO_CDK ma_sat is empty

    # ================ DAY 1 ===================
    When the RAW_STAGE_TWO_CDK is loaded
      | CUSTOMER_ID | CUSTOMER_NAME | CUSTOMER_PHONE  | EXTENSION | EFFECTIVE_FROM | LOAD_DATE  | SOURCE |
      | 1001        | Albert        | 17-214-233-1211 | 12301     | 2019-01-01     | 2019-01-01 | *      |
      | 1001        | Albert        | 17-214-233-1211 | 12302     | 2019-01-01     | 2019-01-01 | *      |
      | 1001        | Albert        | 17-214-233-1211 | 12303     | 2019-01-01     | 2019-01-01 | *      |
      | 1002        | Beth          | 17-214-233-1212 | 12311     | 2019-01-01     | 2019-01-01 | *      |
      | 1002        | Beth          | 17-214-233-1212 | 12312     | 2019-01-01     | 2019-01-01 | *      |
      | 1002        | Beth          | 17-214-233-1212 | 12313     | 2019-01-01     | 2019-01-01 | *      |
      | 1003        | Charley       | 17-214-233-1213 | 12321     | 2019-01-01     | 2019-01-01 | *      |
      | 1003        | Charley       | 17-214-233-1223 | 12321     | 2019-01-01     | 2019-01-01 | *      |
      | 1003        | Charley       | 17-214-233-1233 | 12321     | 2019-01-01     | 2019-01-01 | *      |
      | 1010        | Jenny         | 17-214-233-1214 | 12331     | 2019-01-01     | 2019-01-01 | *      |
      | 1010        | Jenny         | 17-214-233-1224 | 12331     | 2019-01-01     | 2019-01-01 | *      |
      | 1010        | Jenny         | 17-214-233-1234 | 12331     | 2019-01-01     | 2019-01-01 | *      |
      | 1012        | Albert        | 17-214-233-1215 | 12341     | 2019-01-01     | 2019-01-01 | *      |
      | 1012        | Albert        | 17-214-233-1225 | 12341     | 2019-01-01     | 2019-01-01 | *      |
      | 1012        | Albert        | 17-214-233-1235 | 12341     | 2019-01-01     | 2019-01-01 | *      |
    And I stage the STG_CUSTOMER_TWO_CDK data
    And I load the MULTI_ACTIVE_SATELLITE_TWO_CDK ma_sat

    # ================ DAY 2 ===================
    # Albert(hd), Beah (hd-), Chris (hd-), David (new), Jenny (+), Albert (hd)
    When the RAW_STAGE_TWO_CDK is loaded
      | CUSTOMER_ID | CUSTOMER_NAME | CUSTOMER_PHONE  | EXTENSION | EFFECTIVE_FROM | LOAD_DATE  | SOURCE |
      | 1001        | Albert        | 17-214-233-1311 | 12301     | 2019-01-02     | 2019-01-02 | *      |
      | 1001        | Albert        | 17-214-233-1211 | 12302     | 2019-01-02     | 2019-01-02 | *      |
      | 1001        | Albert        | 17-214-233-1211 | 12303     | 2019-01-02     | 2019-01-02 | *      |
      | 1002        | Beah          | 17-214-233-1212 | 12311     | 2019-01-02     | 2019-01-02 | *      |
      | 1002        | Beah          | 17-214-233-1212 | 12312     | 2019-01-02     | 2019-01-02 | *      |
      | 1003        | Chris         | 17-214-233-1223 | 12321     | 2019-01-02     | 2019-01-02 | *      |
      | 1004        | David         | 17-214-233-1216 | 12311     | 2019-01-02     | 2019-01-02 | *      |
      | 1004        | David         | 17-214-233-1226 | 12311     | 2019-01-02     | 2019-01-02 | *      |
      | 1004        | David         | 17-214-233-1236 | 12311     | 2019-01-02     | 2019-01-02 | *      |
      | 1010        | Jenny         | 17-214-233-1214 | 12331     | 2019-01-02     | 2019-01-02 | *      |
      | 1010        | Jenny         | 17-214-233-1224 | 12331     | 2019-01-02     | 2019-01-02 | *      |
      | 1010        | Jenny         | 17-214-233-1234 | 12331     | 2019-01-02     | 2019-01-02 | *      |
      | 1010        | Jenny         | 17-214-233-1244 | 12331     | 2019-01-02     | 2019-01-02 | *      |
      | 1012        | Albert        | 17-214-233-1215 | 92341     | 2019-01-02     | 2019-01-02 | *      |
      | 1012        | Albert        | 17-214-233-1225 | 12341     | 2019-01-02     | 2019-01-02 | *      |
      | 1012        | Albert        | 17-214-233-1235 | 12341     | 2019-01-02     | 2019-01-02 | *      |
    And I stage the STG_CUSTOMER_TWO_CDK data
    And I load the MULTI_ACTIVE_SATELLITE_TWO_CDK ma_sat

    # ================ DAY 3 ===================
    # Beth (hd+), David (-), Freia (new, dupl)
    When the RAW_STAGE_TWO_CDK is loaded
      | CUSTOMER_ID | CUSTOMER_NAME | CUSTOMER_PHONE  | EXTENSION | EFFECTIVE_FROM | LOAD_DATE  | SOURCE |
      | 1002        | Beth          | 17-214-233-1212 | 92301     | 2019-01-03     | 2019-01-03 | *      |
      | 1002        | Beth          | 17-214-233-1212 | 12302     | 2019-01-03     | 2019-01-03 | *      |
      | 1002        | Beth          | 17-214-233-1212 | 12303     | 2019-01-03     | 2019-01-03 | *      |
      | 1004        | David         | 17-214-233-1216 | 12311     | 2019-01-03     | 2019-01-03 | *      |
      | 1004        | David         | 17-214-233-1226 | 12311     | 2019-01-03     | 2019-01-03 | *      |
      | 1006        | Freia         | 17-214-233-1212 | 12311     | 2019-01-03     | 2019-01-03 | *      |
      | 1006        | Freia         | 17-214-233-1212 | 12311     | 2019-01-03     | 2019-01-03 | *      |
#      | 1003        | Chris         | 17-214-233-1223 | 12321     | 2019-01-03     | 2019-01-03 | *      |

    And I stage the STG_CUSTOMER_TWO_CDK data
    And I load the MULTI_ACTIVE_SATELLITE_TWO_CDK ma_sat

    # ================ DAY 4 ===================
    # Beah (hd, dupl), Charley (hd), David (+), Freia (hd), Jenny (hd),
    When the RAW_STAGE_TWO_CDK is loaded
      | CUSTOMER_ID | CUSTOMER_NAME | CUSTOMER_PHONE  | EXTENSION | EFFECTIVE_FROM | LOAD_DATE  | SOURCE |
      | 1002        | Beah          | 17-214-233-1312 | 12311     | 2019-01-04     | 2019-01-04 | *      |
      | 1002        | Beah          | 17-214-233-1212 | 12311     | 2019-01-04     | 2019-01-04 | *      |
      | 1002        | Beah          | 17-214-233-1212 | 12311     | 2019-01-04     | 2019-01-04 | *      |
      | 1003        | Charley       | 17-214-233-1223 | 12321     | 2019-01-04     | 2019-01-04 | *      |
      | 1004        | David         | 17-214-233-1216 | 12311     | 2019-01-04     | 2019-01-04 | *      |
      | 1004        | David         | 17-214-233-1226 | 12311     | 2019-01-04     | 2019-01-04 | *      |
      | 1004        | David         | 17-214-233-1236 | 12311     | 2019-01-04     | 2019-01-04 | *      |
      | 1006        | Freia         | 17-214-233-1312 | 12311     | 2019-01-04     | 2019-01-04 | *      |
      | 1010        | Jenny         | 17-214-233-1314 | 12331     | 2019-01-04     | 2019-01-04 | *      |
      | 1010        | Jenny         | 17-214-233-1324 | 12331     | 2019-01-04     | 2019-01-04 | *      |
      | 1010        | Jenny         | 17-214-233-1334 | 12331     | 2019-01-04     | 2019-01-04 | *      |
      | 1010        | Jenny         | 17-214-233-1344 | 12331     | 2019-01-04     | 2019-01-04 | *      |

    And I stage the STG_CUSTOMER_TWO_CDK data
    And I load the MULTI_ACTIVE_SATELLITE_TWO_CDK ma_sat

    # =============== CHECKS ===================
    Then the MULTI_ACTIVE_SATELLITE_TWO_CDK table should contain expected data
      | CUSTOMER_PK | HASHDIFF                                           | CUSTOMER_NAME | CUSTOMER_PHONE  | EXTENSION | EFFECTIVE_FROM | LOAD_DATE  | SOURCE |
      | sha('1001') | sha('1001\|\|ALBERT\|\|17-214-233-1211\|\|12301')  | Albert        | 17-214-233-1211 | 12301     | 2019-01-01     | 2019-01-01 | *      |
      | sha('1001') | sha('1001\|\|ALBERT\|\|17-214-233-1211\|\|12302')  | Albert        | 17-214-233-1211 | 12302     | 2019-01-01     | 2019-01-01 | *      |
      | sha('1001') | sha('1001\|\|ALBERT\|\|17-214-233-1211\|\|12303')  | Albert        | 17-214-233-1211 | 12303     | 2019-01-01     | 2019-01-01 | *      |
      | sha('1002') | sha('1002\|\|BETH\|\|17-214-233-1212\|\|12311')    | Beth          | 17-214-233-1212 | 12311     | 2019-01-01     | 2019-01-01 | *      |
      | sha('1002') | sha('1002\|\|BETH\|\|17-214-233-1212\|\|12312')    | Beth          | 17-214-233-1212 | 12312     | 2019-01-01     | 2019-01-01 | *      |
      | sha('1002') | sha('1002\|\|BETH\|\|17-214-233-1212\|\|12313')    | Beth          | 17-214-233-1212 | 12313     | 2019-01-01     | 2019-01-01 | *      |
      | sha('1003') | sha('1003\|\|CHARLEY\|\|17-214-233-1213\|\|12321') | Charley       | 17-214-233-1213 | 12321     | 2019-01-01     | 2019-01-01 | *      |
      | sha('1003') | sha('1003\|\|CHARLEY\|\|17-214-233-1223\|\|12321') | Charley       | 17-214-233-1223 | 12321     | 2019-01-01     | 2019-01-01 | *      |
      | sha('1003') | sha('1003\|\|CHARLEY\|\|17-214-233-1233\|\|12321') | Charley       | 17-214-233-1233 | 12321     | 2019-01-01     | 2019-01-01 | *      |
      | sha('1010') | sha('1010\|\|JENNY\|\|17-214-233-1214\|\|12331')   | Jenny         | 17-214-233-1214 | 12331     | 2019-01-01     | 2019-01-01 | *      |
      | sha('1010') | sha('1010\|\|JENNY\|\|17-214-233-1224\|\|12331')   | Jenny         | 17-214-233-1224 | 12331     | 2019-01-01     | 2019-01-01 | *      |
      | sha('1010') | sha('1010\|\|JENNY\|\|17-214-233-1234\|\|12331')   | Jenny         | 17-214-233-1234 | 12331     | 2019-01-01     | 2019-01-01 | *      |
      | sha('1012') | sha('1012\|\|ALBERT\|\|17-214-233-1215\|\|12341')  | Albert        | 17-214-233-1215 | 12341     | 2019-01-01     | 2019-01-01 | *      |
      | sha('1012') | sha('1012\|\|ALBERT\|\|17-214-233-1225\|\|12341')  | Albert        | 17-214-233-1225 | 12341     | 2019-01-01     | 2019-01-01 | *      |
      | sha('1012') | sha('1012\|\|ALBERT\|\|17-214-233-1235\|\|12341')  | Albert        | 17-214-233-1235 | 12341     | 2019-01-01     | 2019-01-01 | *      |
      | sha('1001') | sha('1001\|\|ALBERT\|\|17-214-233-1311\|\|12301')  | Albert        | 17-214-233-1311 | 12301     | 2019-01-02     | 2019-01-02 | *      |
      | sha('1001') | sha('1001\|\|ALBERT\|\|17-214-233-1211\|\|12302')  | Albert        | 17-214-233-1211 | 12302     | 2019-01-02     | 2019-01-02 | *      |
      | sha('1001') | sha('1001\|\|ALBERT\|\|17-214-233-1211\|\|12303')  | Albert        | 17-214-233-1211 | 12303     | 2019-01-02     | 2019-01-02 | *      |
      | sha('1002') | sha('1002\|\|BEAH\|\|17-214-233-1212\|\|12311')    | Beah          | 17-214-233-1212 | 12311     | 2019-01-02     | 2019-01-02 | *      |
      | sha('1002') | sha('1002\|\|BEAH\|\|17-214-233-1212\|\|12312')    | Beah          | 17-214-233-1212 | 12312     | 2019-01-02     | 2019-01-02 | *      |
      | sha('1003') | sha('1003\|\|CHRIS\|\|17-214-233-1223\|\|12321')   | Chris         | 17-214-233-1223 | 12321     | 2019-01-02     | 2019-01-02 | *      |
      | sha('1004') | sha('1004\|\|DAVID\|\|17-214-233-1216\|\|12311')   | David         | 17-214-233-1216 | 12311     | 2019-01-02     | 2019-01-02 | *      |
      | sha('1004') | sha('1004\|\|DAVID\|\|17-214-233-1226\|\|12311')   | David         | 17-214-233-1226 | 12311     | 2019-01-02     | 2019-01-02 | *      |
      | sha('1004') | sha('1004\|\|DAVID\|\|17-214-233-1236\|\|12311')   | David         | 17-214-233-1236 | 12311     | 2019-01-02     | 2019-01-02 | *      |
      | sha('1010') | sha('1010\|\|JENNY\|\|17-214-233-1214\|\|12331')   | Jenny         | 17-214-233-1214 | 12331     | 2019-01-02     | 2019-01-02 | *      |
      | sha('1010') | sha('1010\|\|JENNY\|\|17-214-233-1224\|\|12331')   | Jenny         | 17-214-233-1224 | 12331     | 2019-01-02     | 2019-01-02 | *      |
      | sha('1010') | sha('1010\|\|JENNY\|\|17-214-233-1234\|\|12331')   | Jenny         | 17-214-233-1234 | 12331     | 2019-01-02     | 2019-01-02 | *      |
      | sha('1010') | sha('1010\|\|JENNY\|\|17-214-233-1244\|\|12331')   | Jenny         | 17-214-233-1244 | 12331     | 2019-01-02     | 2019-01-02 | *      |
      | sha('1012') | sha('1012\|\|ALBERT\|\|17-214-233-1215\|\|92341')  | Albert        | 17-214-233-1215 | 92341     | 2019-01-02     | 2019-01-02 | *      |
      | sha('1012') | sha('1012\|\|ALBERT\|\|17-214-233-1225\|\|12341')  | Albert        | 17-214-233-1225 | 12341     | 2019-01-02     | 2019-01-02 | *      |
      | sha('1012') | sha('1012\|\|ALBERT\|\|17-214-233-1235\|\|12341')  | Albert        | 17-214-233-1235 | 12341     | 2019-01-02     | 2019-01-02 | *      |
      | sha('1002') | sha('1002\|\|BETH\|\|17-214-233-1212\|\|92301')    | Beth          | 17-214-233-1212 | 92301     | 2019-01-03     | 2019-01-03 | *      |
      | sha('1002') | sha('1002\|\|BETH\|\|17-214-233-1212\|\|12302')    | Beth          | 17-214-233-1212 | 12302     | 2019-01-03     | 2019-01-03 | *      |
      | sha('1002') | sha('1002\|\|BETH\|\|17-214-233-1212\|\|12303')    | Beth          | 17-214-233-1212 | 12303     | 2019-01-03     | 2019-01-03 | *      |
      | sha('1004') | sha('1004\|\|DAVID\|\|17-214-233-1216\|\|12311')   | David         | 17-214-233-1216 | 12311     | 2019-01-03     | 2019-01-03 | *      |
      | sha('1004') | sha('1004\|\|DAVID\|\|17-214-233-1226\|\|12311')   | David         | 17-214-233-1226 | 12311     | 2019-01-03     | 2019-01-03 | *      |
      | sha('1006') | sha('1006\|\|FREIA\|\|17-214-233-1212\|\|12311')   | Freia         | 17-214-233-1212 | 12311     | 2019-01-03     | 2019-01-03 | *      |
      | sha('1002') | sha('1002\|\|BEAH\|\|17-214-233-1312\|\|12311')    | Beah          | 17-214-233-1312 | 12311     | 2019-01-04     | 2019-01-04 | *      |
      | sha('1002') | sha('1002\|\|BEAH\|\|17-214-233-1212\|\|12311')    | Beah          | 17-214-233-1212 | 12311     | 2019-01-04     | 2019-01-04 | *      |
      | sha('1003') | sha('1003\|\|CHARLEY\|\|17-214-233-1223\|\|12321') | Charley       | 17-214-233-1223 | 12321     | 2019-01-04     | 2019-01-04 | *      |
      | sha('1004') | sha('1004\|\|DAVID\|\|17-214-233-1216\|\|12311')   | David         | 17-214-233-1216 | 12311     | 2019-01-04     | 2019-01-04 | *      |
      | sha('1004') | sha('1004\|\|DAVID\|\|17-214-233-1226\|\|12311')   | David         | 17-214-233-1226 | 12311     | 2019-01-04     | 2019-01-04 | *      |
      | sha('1004') | sha('1004\|\|DAVID\|\|17-214-233-1236\|\|12311')   | David         | 17-214-233-1236 | 12311     | 2019-01-04     | 2019-01-04 | *      |
      | sha('1006') | sha('1006\|\|FREIA\|\|17-214-233-1312\|\|12311')   | Freia         | 17-214-233-1312 | 12311     | 2019-01-04     | 2019-01-04 | *      |
      | sha('1010') | sha('1010\|\|JENNY\|\|17-214-233-1314\|\|12331')   | Jenny         | 17-214-233-1314 | 12331     | 2019-01-04     | 2019-01-04 | *      |
      | sha('1010') | sha('1010\|\|JENNY\|\|17-214-233-1324\|\|12331')   | Jenny         | 17-214-233-1324 | 12331     | 2019-01-04     | 2019-01-04 | *      |
      | sha('1010') | sha('1010\|\|JENNY\|\|17-214-233-1334\|\|12331')   | Jenny         | 17-214-233-1334 | 12331     | 2019-01-04     | 2019-01-04 | *      |
      | sha('1010') | sha('1010\|\|JENNY\|\|17-214-233-1344\|\|12331')   | Jenny         | 17-214-233-1344 | 12331     | 2019-01-04     | 2019-01-04 | *      |
