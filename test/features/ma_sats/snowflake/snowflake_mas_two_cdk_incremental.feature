
Feature: [SF-MAS-2CD-INC] Multi Active Satellites


 @fixture.multi_active_satellite
  Scenario: [SF-MAS-2CD-INC-01] Load empty stage into a non existent multi-active satellite with 2 CDKs - one cycle
    Given the MULTI_ACTIVE_SATELLITE_TWO_CDK_TS table does not exist
    And the RAW_STAGE_TWO_CDK_TS table contains data
      | CUSTOMER_ID | CUSTOMER_NAME | CUSTOMER_PHONE  | EXTENSION | LOAD_DATETIME           | SOURCE |
      | 1001        | Alice         | 17-214-233-1214 | 12301     | 1993-01-01 11:14:54.396 | *      |
      | 1001        | Alice         | 17-214-233-1214 | 12302     | 1993-01-01 11:14:54.396 | *      |
      | 1001        | Alice         | 17-214-233-1214 | 12303     | 1993-01-01 11:14:54.396 | *      |
      | 1001        | Alice         | 17-214-233-1214 | 12303     | 1993-01-01 11:14:54.396 | *      |
      | 1002        | Bob           | 17-214-233-1215 | 12311     | 1993-01-01 11:14:54.396 | *      |
      | 1002        | Bob           | 17-214-233-1215 | 12312     | 1993-01-01 11:14:54.396 | *      |
      | 1002        | Bob           | 17-214-233-1215 | 12313     | 1993-01-01 11:14:54.396 | *      |
      | 1002        | Bob           | 17-214-233-1215 | 12313     | 1993-01-01 11:14:54.396 | *      |
      | 1003        | Chad          | 17-214-233-1216 | 12321     | 1993-01-01 11:14:54.396 | *      |
      | 1003        | Chad          | 17-214-233-1226 | 12321     | 1993-01-01 11:14:54.396 | *      |
      | 1003        | Chad          | 17-214-233-1226 | 12321     | 1993-01-01 11:14:54.396 | *      |
      | 1003        | Chad          | 17-214-233-1236 | 12321     | 1993-01-01 11:14:54.396 | *      |
      | 1005        | Eric          | 17-214-233-1217 | 12331     | 1993-01-01 11:14:54.396 | *      |
      | 1005        | Eric          | 17-214-233-1227 | 12331     | 1993-01-01 11:14:54.396 | *      |
      | 1005        | Eric          | 17-214-233-1237 | 12331     | 1993-01-01 11:14:54.396 | *      |
      | 1005        | Eric          | 17-214-233-1237 | 12331     | 1993-01-01 11:14:54.396 | *      |
    And I stage the STG_CUSTOMER_TWO_CDK_TS data
    And I load the MULTI_ACTIVE_SATELLITE_TWO_CDK_TS ma_sat
    And the RAW_STAGE_TWO_CDK_TS table contains data
      | CUSTOMER_ID | CUSTOMER_NAME | CUSTOMER_PHONE  | EXTENSION | LOAD_DATETIME | SOURCE |
    Then the MULTI_ACTIVE_SATELLITE_TWO_CDK_TS table should contain expected data
      | CUSTOMER_PK | CUSTOMER_NAME | CUSTOMER_PHONE  | EXTENSION | HASHDIFF                                         | EFFECTIVE_FROM | LOAD_DATETIME            | SOURCE |
      | md5('1001') | Alice         | 17-214-233-1214 | 12301     | md5('1001\|\|ALICE\|\|17-214-233-1214\|\|12301') | 1993-01-01 11:14:54.396     | 1993-01-01 11:14:54.396 | *      |
      | md5('1001') | Alice         | 17-214-233-1214 | 12302     | md5('1001\|\|ALICE\|\|17-214-233-1214\|\|12302') | 1993-01-01 11:14:54.396     | 1993-01-01 11:14:54.396 | *      |
      | md5('1001') | Alice         | 17-214-233-1214 | 12303     | md5('1001\|\|ALICE\|\|17-214-233-1214\|\|12303') | 1993-01-01 11:14:54.396     | 1993-01-01 11:14:54.396 | *      |
      | md5('1002') | Bob           | 17-214-233-1215 | 12311     | md5('1002\|\|BOB\|\|17-214-233-1215\|\|12311')   | 1993-01-01 11:14:54.396     | 1993-01-01 11:14:54.396 | *      |
      | md5('1002') | Bob           | 17-214-233-1215 | 12312     | md5('1002\|\|BOB\|\|17-214-233-1215\|\|12312')   | 1993-01-01 11:14:54.396     | 1993-01-01 11:14:54.396 | *      |
      | md5('1002') | Bob           | 17-214-233-1215 | 12313     | md5('1002\|\|BOB\|\|17-214-233-1215\|\|12313')   | 1993-01-01 11:14:54.396     | 1993-01-01 11:14:54.396 | *      |
      | md5('1003') | Chad          | 17-214-233-1216 | 12321     | md5('1003\|\|CHAD\|\|17-214-233-1216\|\|12321')  | 1993-01-01 11:14:54.396     | 1993-01-01 11:14:54.396 | *      |
      | md5('1003') | Chad          | 17-214-233-1226 | 12321     | md5('1003\|\|CHAD\|\|17-214-233-1226\|\|12321')  | 1993-01-01 11:14:54.396     | 1993-01-01 11:14:54.396 | *      |
      | md5('1003') | Chad          | 17-214-233-1236 | 12321     | md5('1003\|\|CHAD\|\|17-214-233-1236\|\|12321')  | 1993-01-01 11:14:54.396     | 1993-01-01 11:14:54.396 | *      |
      | md5('1005') | Eric          | 17-214-233-1217 | 12331     | md5('1005\|\|ERIC\|\|17-214-233-1217\|\|12331')  | 1993-01-01 11:14:54.396     | 1993-01-01 11:14:54.396 | *      |
      | md5('1005') | Eric          | 17-214-233-1227 | 12331     | md5('1005\|\|ERIC\|\|17-214-233-1227\|\|12331')  | 1993-01-01 11:14:54.396     | 1993-01-01 11:14:54.396 | *      |
      | md5('1005') | Eric          | 17-214-233-1237 | 12331     | md5('1005\|\|ERIC\|\|17-214-233-1237\|\|12331')  | 1993-01-01 11:14:54.396     | 1993-01-01 11:14:54.396 | *      |

  @fixture.multi_active_satellite
  Scenario: [SF-MAS-2CD-INC-02] Load stage into a non existent multi-active satellite with 2 CDKs - one cycle
    Given the MULTI_ACTIVE_SATELLITE_TWO_CDK_TS table does not exist
    And the RAW_STAGE_TWO_CDK_TS table contains data
      | CUSTOMER_ID | CUSTOMER_NAME | CUSTOMER_PHONE  | EXTENSION | LOAD_DATETIME            | SOURCE |
      | 1001        | Alice         | 17-214-233-1214 | 12301     | 1993-01-01 11:14:54.396 | *      |
      | 1001        | Alice         | 17-214-233-1214 | 12302     | 1993-01-01 11:14:54.396 | *      |
      | 1001        | Alice         | 17-214-233-1214 | 12303     | 1993-01-01 11:14:54.396 | *      |
      | 1001        | Alice         | 17-214-233-1214 | 12303     | 1993-01-01 11:14:54.396 | *      |
      | 1002        | Bob           | 17-214-233-1215 | 12311     | 1993-01-01 11:14:54.396 | *      |
      | 1002        | Bob           | 17-214-233-1215 | 12312     | 1993-01-01 11:14:54.396 | *      |
      | 1002        | Bob           | 17-214-233-1215 | 12313     | 1993-01-01 11:14:54.396 | *      |
      | 1002        | Bob           | 17-214-233-1215 | 12313     | 1993-01-01 11:14:54.396 | *      |
      | 1003        | Chad          | 17-214-233-1216 | 12321     | 1993-01-01 11:14:54.396 | *      |
      | 1003        | Chad          | 17-214-233-1226 | 12321     | 1993-01-01 11:14:54.396 | *      |
      | 1003        | Chad          | 17-214-233-1226 | 12321     | 1993-01-01 11:14:54.396 | *      |
      | 1003        | Chad          | 17-214-233-1236 | 12321     | 1993-01-01 11:14:54.396 | *      |
      | 1005        | Eric          | 17-214-233-1217 | 12331     | 1993-01-01 11:14:54.396 | *      |
      | 1005        | Eric          | 17-214-233-1227 | 12331     | 1993-01-01 11:14:54.396 | *      |
      | 1005        | Eric          | 17-214-233-1237 | 12331     | 1993-01-01 11:14:54.396 | *      |
      | 1005        | Eric          | 17-214-233-1237 | 12331     | 1993-01-01 11:14:54.396 | *      |
    And I stage the STG_CUSTOMER_TWO_CDK_TS data
    And I load the MULTI_ACTIVE_SATELLITE_TWO_CDK_TS ma_sat
    And the RAW_STAGE_TWO_CDK_TS table contains data
      | CUSTOMER_ID | CUSTOMER_NAME | CUSTOMER_PHONE  | EXTENSION | LOAD_DATETIME            | SOURCE |
      | 1001        | Alice         | 17-214-233-1214 | 12301     | 1993-01-01 11:14:54.397 | *      |
      | 1001        | Alice         | 17-214-233-1214 | 12302     | 1993-01-01 11:14:54.397 | *      |
      | 1001        | Alice         | 17-214-233-1214 | 12303     | 1993-01-01 11:14:54.397 | *      |
      | 1002        | Bob           | 17-214-233-1215 | 12311     | 1993-01-01 11:14:54.397 | *      |
      | 1002        | Bob           | 17-214-233-1215 | 12312     | 1993-01-01 11:14:54.397 | *      |
      | 1002        | Bob           | 17-214-233-1215 | 12314     | 1993-01-01 11:14:54.397 | *      |
      | 1002        | Bob           | 17-214-233-1215 | 12314     | 1993-01-01 11:14:54.397 | *      |
      | 1003        | Chad          | 17-214-233-1216 | 12321     | 1993-01-01 11:14:54.397 | *      |
      | 1003        | Chad          | 17-214-233-1226 | 12321     | 1993-01-01 11:14:54.397 | *      |
      | 1006        | Dan           | 17-214-233-1230 | 12430     | 1993-01-01 11:14:54.397 | *      |
      | 1006        | Dan           | 17-214-233-1230 | 12440     | 1993-01-01 11:14:54.397 | *      |
      | 1006        | Dan           | 17-214-233-1240 | 12450     | 1993-01-01 11:14:54.397 | *      |
    And I stage the STG_CUSTOMER_TWO_CDK_TS data
    When I load the MULTI_ACTIVE_SATELLITE_TWO_CDK_TS ma_sat
    Then the MULTI_ACTIVE_SATELLITE_TWO_CDK_TS table should contain expected data
      | CUSTOMER_PK | CUSTOMER_NAME | CUSTOMER_PHONE  | EXTENSION | HASHDIFF                                         | EFFECTIVE_FROM | LOAD_DATETIME            | SOURCE |
      | md5('1001') | Alice         | 17-214-233-1214 | 12301     | md5('1001\|\|ALICE\|\|17-214-233-1214\|\|12301') | 1993-01-01 11:14:54.396     | 1993-01-01 11:14:54.396 | *      |
      | md5('1001') | Alice         | 17-214-233-1214 | 12302     | md5('1001\|\|ALICE\|\|17-214-233-1214\|\|12302') | 1993-01-01 11:14:54.396     | 1993-01-01 11:14:54.396 | *      |
      | md5('1001') | Alice         | 17-214-233-1214 | 12303     | md5('1001\|\|ALICE\|\|17-214-233-1214\|\|12303') | 1993-01-01 11:14:54.396     | 1993-01-01 11:14:54.396 | *      |
      | md5('1002') | Bob           | 17-214-233-1215 | 12311     | md5('1002\|\|BOB\|\|17-214-233-1215\|\|12311')   | 1993-01-01 11:14:54.396     | 1993-01-01 11:14:54.396 | *      |
      | md5('1002') | Bob           | 17-214-233-1215 | 12312     | md5('1002\|\|BOB\|\|17-214-233-1215\|\|12312')   | 1993-01-01 11:14:54.396     | 1993-01-01 11:14:54.396 | *      |
      | md5('1002') | Bob           | 17-214-233-1215 | 12313     | md5('1002\|\|BOB\|\|17-214-233-1215\|\|12313')   | 1993-01-01 11:14:54.396     | 1993-01-01 11:14:54.396 | *      |
      | md5('1002') | Bob           | 17-214-233-1215 | 12311     | md5('1002\|\|BOB\|\|17-214-233-1215\|\|12311')   | 1993-01-01 11:14:54.397     | 1993-01-01 11:14:54.397 | *      |
      | md5('1002') | Bob           | 17-214-233-1215 | 12312     | md5('1002\|\|BOB\|\|17-214-233-1215\|\|12312')   | 1993-01-01 11:14:54.397     | 1993-01-01 11:14:54.397 | *      |
      | md5('1002') | Bob           | 17-214-233-1215 | 12314     | md5('1002\|\|BOB\|\|17-214-233-1215\|\|12314')   | 1993-01-01 11:14:54.397     | 1993-01-01 11:14:54.397 | *      |
      | md5('1003') | Chad          | 17-214-233-1216 | 12321     | md5('1003\|\|CHAD\|\|17-214-233-1216\|\|12321')  | 1993-01-01 11:14:54.396     | 1993-01-01 11:14:54.396 | *      |
      | md5('1003') | Chad          | 17-214-233-1226 | 12321     | md5('1003\|\|CHAD\|\|17-214-233-1226\|\|12321')  | 1993-01-01 11:14:54.396     | 1993-01-01 11:14:54.396 | *      |
      | md5('1003') | Chad          | 17-214-233-1236 | 12321     | md5('1003\|\|CHAD\|\|17-214-233-1236\|\|12321')  | 1993-01-01 11:14:54.396     | 1993-01-01 11:14:54.396 | *      |
      | md5('1003') | Chad          | 17-214-233-1216 | 12321     | md5('1003\|\|CHAD\|\|17-214-233-1216\|\|12321')  | 1993-01-01 11:14:54.397     | 1993-01-01 11:14:54.397 | *      |
      | md5('1003') | Chad          | 17-214-233-1226 | 12321     | md5('1003\|\|CHAD\|\|17-214-233-1226\|\|12321')  | 1993-01-01 11:14:54.397     | 1993-01-01 11:14:54.397 | *      |
      | md5('1005') | Eric          | 17-214-233-1217 | 12331     | md5('1005\|\|ERIC\|\|17-214-233-1217\|\|12331')  | 1993-01-01 11:14:54.396     | 1993-01-01 11:14:54.396 | *      |
      | md5('1005') | Eric          | 17-214-233-1227 | 12331     | md5('1005\|\|ERIC\|\|17-214-233-1227\|\|12331')  | 1993-01-01 11:14:54.396     | 1993-01-01 11:14:54.396 | *      |
      | md5('1005') | Eric          | 17-214-233-1237 | 12331     | md5('1005\|\|ERIC\|\|17-214-233-1237\|\|12331')  | 1993-01-01 11:14:54.396     | 1993-01-01 11:14:54.396 | *      |
      | md5('1006') | Dan           | 17-214-233-1230 | 12430     | md5('1006\|\|DAN\|\|17-214-233-1230\|\|12430')   | 1993-01-01 11:14:54.397     | 1993-01-01 11:14:54.397 | *      |
      | md5('1006') | Dan           | 17-214-233-1230 | 12440     | md5('1006\|\|DAN\|\|17-214-233-1230\|\|12440')   | 1993-01-01 11:14:54.397     | 1993-01-01 11:14:54.397 | *      |
      | md5('1006') | Dan           | 17-214-233-1240 | 12450     | md5('1006\|\|DAN\|\|17-214-233-1240\|\|12450')   | 1993-01-01 11:14:54.397     | 1993-01-01 11:14:54.397 | *      |

 @fixture.multi_active_satellite
  Scenario: [SF-MAS-2CD-INC-03] Load mixed stage into a non existent multi-active satellite with 2 CDKs - two cycles
    Given the MULTI_ACTIVE_SATELLITE_TWO_CDK_TS table does not exist
    And the RAW_STAGE_TWO_CDK_TS table contains data
      | CUSTOMER_ID | CUSTOMER_NAME | CUSTOMER_PHONE  | EXTENSION | LOAD_DATETIME            | SOURCE |
      | 1001        | Alice         | 17-214-233-1214 | 12301     | 1993-01-01 11:14:54.396 | *      |
      | 1001        | Alice         | 17-214-233-1214 | 12302     | 1993-01-01 11:14:54.396 | *      |
      | 1001        | Alice         | 17-214-233-1214 | 12303     | 1993-01-01 11:14:54.396 | *      |
      | 1001        | Alice         | 17-214-233-1214 | 12303     | 1993-01-01 11:14:54.396 | *      |
      | 1002        | Bob           | 17-214-233-1215 | 12311     | 1993-01-01 11:14:54.396 | *      |
      | 1002        | Bob           | 17-214-233-1215 | 12312     | 1993-01-01 11:14:54.396 | *      |
      | 1002        | Bob           | 17-214-233-1215 | 12313     | 1993-01-01 11:14:54.396 | *      |
      | 1002        | Bob           | 17-214-233-1215 | 12313     | 1993-01-01 11:14:54.396 | *      |
      | 1003        | Chad          | 17-214-233-1216 | 12321     | 1993-01-01 11:14:54.396 | *      |
      | 1003        | Chad          | 17-214-233-1226 | 12321     | 1993-01-01 11:14:54.396 | *      |
      | 1003        | Chad          | 17-214-233-1226 | 12321     | 1993-01-01 11:14:54.396 | *      |
      | 1003        | Chad          | 17-214-233-1236 | 12321     | 1993-01-01 11:14:54.396 | *      |
      | 1005        | Eric          | 17-214-233-1217 | 12331     | 1993-01-01 11:14:54.396 | *      |
      | 1005        | Eric          | 17-214-233-1227 | 12331     | 1993-01-01 11:14:54.396 | *      |
      | 1005        | Eric          | 17-214-233-1237 | 12331     | 1993-01-01 11:14:54.396 | *      |
      | 1005        | Eric          | 17-214-233-1237 | 12331     | 1993-01-01 11:14:54.396 | *      |
    And I stage the STG_CUSTOMER_TWO_CDK_TS data
    And I load the MULTI_ACTIVE_SATELLITE_TWO_CDK_TS ma_sat
    And the RAW_STAGE_TWO_CDK_TS table contains data
      | CUSTOMER_ID | CUSTOMER_NAME | CUSTOMER_PHONE  | EXTENSION | LOAD_DATETIME            | SOURCE |
      | 1001        | Alice         | 17-214-233-1214 | 12301     | 1993-01-01 11:14:54.397 | *      |
      | 1001        | Alice         | 17-214-233-1214 | 12302     | 1993-01-01 11:14:54.397 | *      |
      | 1001        | Alice         | 17-214-233-1214 | 12303     | 1993-01-01 11:14:54.397 | *      |
      | 1002        | Bob           | 17-214-233-1215 | 12311     | 1993-01-01 11:14:54.397 | *      |
      | 1002        | Bob           | 17-214-233-1215 | 12312     | 1993-01-01 11:14:54.397 | *      |
      | 1002        | Bob           | 17-214-233-1215 | 12314     | 1993-01-01 11:14:54.397 | *      |
      | 1002        | Bob           | 17-214-233-1215 | 12314     | 1993-01-01 11:14:54.397 | *      |
      | 1003        | Chad          | 17-214-233-1216 | 12321     | 1993-01-01 11:14:54.397 | *      |
      | 1003        | Chad          | 17-214-233-1226 | 12321     | 1993-01-01 11:14:54.397 | *      |
      | 1006        | Dan           | 17-214-233-1230 | 12430     | 1993-01-01 11:14:54.397 | *      |
      | 1006        | Dan           | 17-214-233-1230 | 12440     | 1993-01-01 11:14:54.397 | *      |
      | 1006        | Dan           | 17-214-233-1240 | 12450     | 1993-01-01 11:14:54.397 | *      |
    And I stage the STG_CUSTOMER_TWO_CDK_TS data
    And I load the MULTI_ACTIVE_SATELLITE_TWO_CDK_TS ma_sat
    And the RAW_STAGE_TWO_CDK_TS table contains data
      | CUSTOMER_ID | CUSTOMER_NAME | CUSTOMER_PHONE  | EXTENSION | LOAD_DATETIME            | SOURCE |
      | 1002        | Bob           | 17-214-233-1215 | 12311     | 1993-01-01 11:14:54.398 | *      |
      | 1002        | Bob           | 17-214-233-1215 | 12312     | 1993-01-01 11:14:54.398 | *      |
      | 1002        | Bob           | 17-214-233-1215 | 12314     | 1993-01-01 11:14:54.398 | *      |
      | 1003        | Chad          | 17-214-233-1226 | 12321     | 1993-01-01 11:14:54.398 | *      |
      | 1006        | Dan           | 17-214-233-1230 | 12430     | 1993-01-01 11:14:54.398 | *      |
      | 1006        | Dan           | 17-214-233-1230 | 12440     | 1993-01-01 11:14:54.398 | *      |
      | 1006        | Dan           | 17-214-233-1240 | 12460     | 1993-01-01 11:14:54.398 | *      |
      | 1007        | Charles       | 17-214-233-2000 | 12500     | 1993-01-01 11:14:54.398 | *      |
      | 1007        | Charles       | 17-214-233-2000 | 12510     | 1993-01-01 11:14:54.398 | *      |
      | 1007        | Charlie       | 17-214-233-2000 | 12510     | 1993-01-01 11:14:54.398 | *      |
      | 1007        | Charlie       | 17-214-233-2000 | 12510     | 1993-01-01 11:14:54.398 | *      |
    And I stage the STG_CUSTOMER_TWO_CDK_TS data
    When I load the MULTI_ACTIVE_SATELLITE_TWO_CDK_TS ma_sat
    Then the MULTI_ACTIVE_SATELLITE_TWO_CDK_TS table should contain expected data
      | CUSTOMER_PK | CUSTOMER_NAME | CUSTOMER_PHONE  | EXTENSION | HASHDIFF                                             | EFFECTIVE_FROM | LOAD_DATETIME            | SOURCE |
      | md5('1001') | Alice         | 17-214-233-1214 | 12301     | md5('1001\|\|ALICE\|\|17-214-233-1214\|\|12301')     | 1993-01-01 11:14:54.396     | 1993-01-01 11:14:54.396 | *      |
      | md5('1001') | Alice         | 17-214-233-1214 | 12302     | md5('1001\|\|ALICE\|\|17-214-233-1214\|\|12302')     | 1993-01-01 11:14:54.396     | 1993-01-01 11:14:54.396 | *      |
      | md5('1001') | Alice         | 17-214-233-1214 | 12303     | md5('1001\|\|ALICE\|\|17-214-233-1214\|\|12303')     | 1993-01-01 11:14:54.396     | 1993-01-01 11:14:54.396 | *      |
      | md5('1002') | Bob           | 17-214-233-1215 | 12311     | md5('1002\|\|BOB\|\|17-214-233-1215\|\|12311')       | 1993-01-01 11:14:54.396     | 1993-01-01 11:14:54.396 | *      |
      | md5('1002') | Bob           | 17-214-233-1215 | 12312     | md5('1002\|\|BOB\|\|17-214-233-1215\|\|12312')       | 1993-01-01 11:14:54.396     | 1993-01-01 11:14:54.396 | *      |
      | md5('1002') | Bob           | 17-214-233-1215 | 12313     | md5('1002\|\|BOB\|\|17-214-233-1215\|\|12313')       | 1993-01-01 11:14:54.396     | 1993-01-01 11:14:54.396 | *      |
      | md5('1002') | Bob           | 17-214-233-1215 | 12311     | md5('1002\|\|BOB\|\|17-214-233-1215\|\|12311')       | 1993-01-01 11:14:54.397     | 1993-01-01 11:14:54.397 | *      |
      | md5('1002') | Bob           | 17-214-233-1215 | 12312     | md5('1002\|\|BOB\|\|17-214-233-1215\|\|12312')       | 1993-01-01 11:14:54.397     | 1993-01-01 11:14:54.397 | *      |
      | md5('1002') | Bob           | 17-214-233-1215 | 12314     | md5('1002\|\|BOB\|\|17-214-233-1215\|\|12314')       | 1993-01-01 11:14:54.397     | 1993-01-01 11:14:54.397 | *      |
      | md5('1003') | Chad          | 17-214-233-1216 | 12321     | md5('1003\|\|CHAD\|\|17-214-233-1216\|\|12321')      | 1993-01-01 11:14:54.396     | 1993-01-01 11:14:54.396 | *      |
      | md5('1003') | Chad          | 17-214-233-1226 | 12321     | md5('1003\|\|CHAD\|\|17-214-233-1226\|\|12321')      | 1993-01-01 11:14:54.396     | 1993-01-01 11:14:54.396 | *      |
      | md5('1003') | Chad          | 17-214-233-1236 | 12321     | md5('1003\|\|CHAD\|\|17-214-233-1236\|\|12321')      | 1993-01-01 11:14:54.396     | 1993-01-01 11:14:54.396 | *      |
      | md5('1003') | Chad          | 17-214-233-1216 | 12321     | md5('1003\|\|CHAD\|\|17-214-233-1216\|\|12321')      | 1993-01-01 11:14:54.397     | 1993-01-01 11:14:54.397 | *      |
      | md5('1003') | Chad          | 17-214-233-1226 | 12321     | md5('1003\|\|CHAD\|\|17-214-233-1226\|\|12321')      | 1993-01-01 11:14:54.397     | 1993-01-01 11:14:54.397 | *      |
      | md5('1003') | Chad          | 17-214-233-1226 | 12321     | md5('1003\|\|CHAD\|\|17-214-233-1226\|\|12321')      | 1993-01-01 11:14:54.398     | 1993-01-01 11:14:54.398 | *      |
      | md5('1005') | Eric          | 17-214-233-1217 | 12331     | md5('1005\|\|ERIC\|\|17-214-233-1217\|\|12331')      | 1993-01-01 11:14:54.396     | 1993-01-01 11:14:54.396 | *      |
      | md5('1005') | Eric          | 17-214-233-1227 | 12331     | md5('1005\|\|ERIC\|\|17-214-233-1227\|\|12331')      | 1993-01-01 11:14:54.396     | 1993-01-01 11:14:54.396 | *      |
      | md5('1005') | Eric          | 17-214-233-1237 | 12331     | md5('1005\|\|ERIC\|\|17-214-233-1237\|\|12331')      | 1993-01-01 11:14:54.396     | 1993-01-01 11:14:54.396 | *      |
      | md5('1006') | Dan           | 17-214-233-1230 | 12430     | md5('1006\|\|DAN\|\|17-214-233-1230\|\|12430')       | 1993-01-01 11:14:54.397     | 1993-01-01 11:14:54.397 | *      |
      | md5('1006') | Dan           | 17-214-233-1230 | 12440     | md5('1006\|\|DAN\|\|17-214-233-1230\|\|12440')       | 1993-01-01 11:14:54.397     | 1993-01-01 11:14:54.397 | *      |
      | md5('1006') | Dan           | 17-214-233-1240 | 12450     | md5('1006\|\|DAN\|\|17-214-233-1240\|\|12450')       | 1993-01-01 11:14:54.397     | 1993-01-01 11:14:54.397 | *      |
      | md5('1006') | Dan           | 17-214-233-1230 | 12430     | md5('1006\|\|DAN\|\|17-214-233-1230\|\|12430')       | 1993-01-01 11:14:54.398     | 1993-01-01 11:14:54.398 | *      |
      | md5('1006') | Dan           | 17-214-233-1230 | 12440     | md5('1006\|\|DAN\|\|17-214-233-1230\|\|12440')       | 1993-01-01 11:14:54.398     | 1993-01-01 11:14:54.398 | *      |
      | md5('1006') | Dan           | 17-214-233-1240 | 12460     | md5('1006\|\|DAN\|\|17-214-233-1240\|\|12460')       | 1993-01-01 11:14:54.398     | 1993-01-01 11:14:54.398 | *      |
      | md5('1007') | Charles       | 17-214-233-2000 | 12500     | md5('1007\|\|CHARLES\|\|17-214-233-2000\|\|12500')   | 1993-01-01 11:14:54.398     | 1993-01-01 11:14:54.398 | *      |
      | md5('1007') | Charles       | 17-214-233-2000 | 12510     | md5('1007\|\|CHARLES\|\|17-214-233-2000\|\|12510')   | 1993-01-01 11:14:54.398     | 1993-01-01 11:14:54.398 | *      |
      | md5('1007') | Charlie       | 17-214-233-2000 | 12510     | md5('1007\|\|CHARLIE\|\|17-214-233-2000\|\|12510')   | 1993-01-01 11:14:54.398     | 1993-01-01 11:14:54.398 | *      |

  @fixture.multi_active_satellite
  Scenario: [SF-MAS-2CD-INC-04] Load empty stage into a non existent multi-active satellite with 2 CDKs - two cycles
    Given the MULTI_ACTIVE_SATELLITE_TWO_CDK_TS ma_sat is empty
    And the RAW_STAGE_TWO_CDK_TS table contains data
      | CUSTOMER_ID | CUSTOMER_NAME | CUSTOMER_PHONE  | EXTENSION | LOAD_DATETIME            | SOURCE |
      | 1001        | Alice         | 17-214-233-1214 | 12301     | 1993-01-01 11:14:54.396 | *      |
      | 1001        | Alice         | 17-214-233-1214 | 12302     | 1993-01-01 11:14:54.396 | *      |
      | 1001        | Alice         | 17-214-233-1214 | 12303     | 1993-01-01 11:14:54.396 | *      |
      | 1001        | Alice         | 17-214-233-1214 | 12303     | 1993-01-01 11:14:54.396 | *      |
      | 1002        | Bob           | 17-214-233-1215 | 12311     | 1993-01-01 11:14:54.396 | *      |
      | 1002        | Bob           | 17-214-233-1215 | 12312     | 1993-01-01 11:14:54.396 | *      |
      | 1002        | Bob           | 17-214-233-1215 | 12313     | 1993-01-01 11:14:54.396 | *      |
      | 1002        | Bob           | 17-214-233-1215 | 12313     | 1993-01-01 11:14:54.396 | *      |
      | 1003        | Chad          | 17-214-233-1216 | 12321     | 1993-01-01 11:14:54.396 | *      |
      | 1003        | Chad          | 17-214-233-1226 | 12321     | 1993-01-01 11:14:54.396 | *      |
      | 1003        | Chad          | 17-214-233-1226 | 12321     | 1993-01-01 11:14:54.396 | *      |
      | 1003        | Chad          | 17-214-233-1236 | 12321     | 1993-01-01 11:14:54.396 | *      |
      | 1005        | Eric          | 17-214-233-1217 | 12331     | 1993-01-01 11:14:54.396 | *      |
      | 1005        | Eric          | 17-214-233-1227 | 12331     | 1993-01-01 11:14:54.396 | *      |
      | 1005        | Eric          | 17-214-233-1237 | 12331     | 1993-01-01 11:14:54.396 | *      |
      | 1005        | Eric          | 17-214-233-1237 | 12331     | 1993-01-01 11:14:54.396 | *      |
    And I stage the STG_CUSTOMER_TWO_CDK_TS data
    And I load the MULTI_ACTIVE_SATELLITE_TWO_CDK_TS ma_sat
    And the RAW_STAGE_TWO_CDK_TS table contains data
      | CUSTOMER_ID | CUSTOMER_NAME | CUSTOMER_PHONE  | EXTENSION | LOAD_DATETIME | SOURCE |
    Then the MULTI_ACTIVE_SATELLITE_TWO_CDK_TS table should contain expected data
      | CUSTOMER_PK | CUSTOMER_NAME | CUSTOMER_PHONE  | EXTENSION | HASHDIFF                                         | EFFECTIVE_FROM | LOAD_DATETIME            | SOURCE |
      | md5('1001') | Alice         | 17-214-233-1214 | 12301     | md5('1001\|\|ALICE\|\|17-214-233-1214\|\|12301') | 1993-01-01 11:14:54.396     | 1993-01-01 11:14:54.396 | *      |
      | md5('1001') | Alice         | 17-214-233-1214 | 12302     | md5('1001\|\|ALICE\|\|17-214-233-1214\|\|12302') | 1993-01-01 11:14:54.396     | 1993-01-01 11:14:54.396 | *      |
      | md5('1001') | Alice         | 17-214-233-1214 | 12303     | md5('1001\|\|ALICE\|\|17-214-233-1214\|\|12303') | 1993-01-01 11:14:54.396     | 1993-01-01 11:14:54.396 | *      |
      | md5('1002') | Bob           | 17-214-233-1215 | 12311     | md5('1002\|\|BOB\|\|17-214-233-1215\|\|12311')   | 1993-01-01 11:14:54.396     | 1993-01-01 11:14:54.396 | *      |
      | md5('1002') | Bob           | 17-214-233-1215 | 12312     | md5('1002\|\|BOB\|\|17-214-233-1215\|\|12312')   | 1993-01-01 11:14:54.396     | 1993-01-01 11:14:54.396 | *      |
      | md5('1002') | Bob           | 17-214-233-1215 | 12313     | md5('1002\|\|BOB\|\|17-214-233-1215\|\|12313')   | 1993-01-01 11:14:54.396     | 1993-01-01 11:14:54.396 | *      |
      | md5('1003') | Chad          | 17-214-233-1216 | 12321     | md5('1003\|\|CHAD\|\|17-214-233-1216\|\|12321')  | 1993-01-01 11:14:54.396     | 1993-01-01 11:14:54.396 | *      |
      | md5('1003') | Chad          | 17-214-233-1226 | 12321     | md5('1003\|\|CHAD\|\|17-214-233-1226\|\|12321')  | 1993-01-01 11:14:54.396     | 1993-01-01 11:14:54.396 | *      |
      | md5('1003') | Chad          | 17-214-233-1236 | 12321     | md5('1003\|\|CHAD\|\|17-214-233-1236\|\|12321')  | 1993-01-01 11:14:54.396     | 1993-01-01 11:14:54.396 | *      |
      | md5('1005') | Eric          | 17-214-233-1217 | 12331     | md5('1005\|\|ERIC\|\|17-214-233-1217\|\|12331')  | 1993-01-01 11:14:54.396     | 1993-01-01 11:14:54.396 | *      |
      | md5('1005') | Eric          | 17-214-233-1227 | 12331     | md5('1005\|\|ERIC\|\|17-214-233-1227\|\|12331')  | 1993-01-01 11:14:54.396     | 1993-01-01 11:14:54.396 | *      |
      | md5('1005') | Eric          | 17-214-233-1237 | 12331     | md5('1005\|\|ERIC\|\|17-214-233-1237\|\|12331')  | 1993-01-01 11:14:54.396     | 1993-01-01 11:14:54.396 | *      |

  @fixture.multi_active_satellite
  Scenario: [SF-MAS-2CD-INC-05] Load empty stage into a non existent multi-active satellite with 2 CDKs - one cycle
    Given the MULTI_ACTIVE_SATELLITE_TWO_CDK_TS ma_sat is empty
    And the RAW_STAGE_TWO_CDK_TS table contains data
      | CUSTOMER_ID | CUSTOMER_NAME | CUSTOMER_PHONE  | EXTENSION | LOAD_DATETIME            | SOURCE |
      | 1001        | Alice         | 17-214-233-1214 | 12301     | 1993-01-01 11:14:54.396 | *      |
      | 1001        | Alice         | 17-214-233-1214 | 12302     | 1993-01-01 11:14:54.396 | *      |
      | 1001        | Alice         | 17-214-233-1214 | 12303     | 1993-01-01 11:14:54.396 | *      |
      | 1001        | Alice         | 17-214-233-1214 | 12303     | 1993-01-01 11:14:54.396 | *      |
      | 1002        | Bob           | 17-214-233-1215 | 12311     | 1993-01-01 11:14:54.396 | *      |
      | 1002        | Bob           | 17-214-233-1215 | 12312     | 1993-01-01 11:14:54.396 | *      |
      | 1002        | Bob           | 17-214-233-1215 | 12313     | 1993-01-01 11:14:54.396 | *      |
      | 1002        | Bob           | 17-214-233-1215 | 12313     | 1993-01-01 11:14:54.396 | *      |
      | 1003        | Chad          | 17-214-233-1216 | 12321     | 1993-01-01 11:14:54.396 | *      |
      | 1003        | Chad          | 17-214-233-1226 | 12321     | 1993-01-01 11:14:54.396 | *      |
      | 1003        | Chad          | 17-214-233-1226 | 12321     | 1993-01-01 11:14:54.396 | *      |
      | 1003        | Chad          | 17-214-233-1236 | 12321     | 1993-01-01 11:14:54.396 | *      |
      | 1005        | Eric          | 17-214-233-1217 | 12331     | 1993-01-01 11:14:54.396 | *      |
      | 1005        | Eric          | 17-214-233-1227 | 12331     | 1993-01-01 11:14:54.396 | *      |
      | 1005        | Eric          | 17-214-233-1237 | 12331     | 1993-01-01 11:14:54.396 | *      |
      | 1005        | Eric          | 17-214-233-1237 | 12331     | 1993-01-01 11:14:54.396 | *      |
    And I stage the STG_CUSTOMER_TWO_CDK_TS data
    When I load the MULTI_ACTIVE_SATELLITE_TWO_CDK_TS ma_sat
    Then the MULTI_ACTIVE_SATELLITE_TWO_CDK_TS table should contain expected data
      | CUSTOMER_PK | CUSTOMER_NAME | CUSTOMER_PHONE  | EXTENSION | HASHDIFF                                         | EFFECTIVE_FROM | LOAD_DATETIME            | SOURCE |
      | md5('1001') | Alice         | 17-214-233-1214 | 12301     | md5('1001\|\|ALICE\|\|17-214-233-1214\|\|12301') | 1993-01-01 11:14:54.396     | 1993-01-01 11:14:54.396 | *      |
      | md5('1001') | Alice         | 17-214-233-1214 | 12302     | md5('1001\|\|ALICE\|\|17-214-233-1214\|\|12302') | 1993-01-01 11:14:54.396     | 1993-01-01 11:14:54.396 | *      |
      | md5('1001') | Alice         | 17-214-233-1214 | 12303     | md5('1001\|\|ALICE\|\|17-214-233-1214\|\|12303') | 1993-01-01 11:14:54.396     | 1993-01-01 11:14:54.396 | *      |
      | md5('1002') | Bob           | 17-214-233-1215 | 12311     | md5('1002\|\|BOB\|\|17-214-233-1215\|\|12311')   | 1993-01-01 11:14:54.396     | 1993-01-01 11:14:54.396 | *      |
      | md5('1002') | Bob           | 17-214-233-1215 | 12312     | md5('1002\|\|BOB\|\|17-214-233-1215\|\|12312')   | 1993-01-01 11:14:54.396     | 1993-01-01 11:14:54.396 | *      |
      | md5('1002') | Bob           | 17-214-233-1215 | 12313     | md5('1002\|\|BOB\|\|17-214-233-1215\|\|12313')   | 1993-01-01 11:14:54.396     | 1993-01-01 11:14:54.396 | *      |
      | md5('1003') | Chad          | 17-214-233-1216 | 12321     | md5('1003\|\|CHAD\|\|17-214-233-1216\|\|12321')  | 1993-01-01 11:14:54.396     | 1993-01-01 11:14:54.396 | *      |
      | md5('1003') | Chad          | 17-214-233-1226 | 12321     | md5('1003\|\|CHAD\|\|17-214-233-1226\|\|12321')  | 1993-01-01 11:14:54.396     | 1993-01-01 11:14:54.396 | *      |
      | md5('1003') | Chad          | 17-214-233-1236 | 12321     | md5('1003\|\|CHAD\|\|17-214-233-1236\|\|12321')  | 1993-01-01 11:14:54.396     | 1993-01-01 11:14:54.396 | *      |
      | md5('1005') | Eric          | 17-214-233-1217 | 12331     | md5('1005\|\|ERIC\|\|17-214-233-1217\|\|12331')  | 1993-01-01 11:14:54.396     | 1993-01-01 11:14:54.396 | *      |
      | md5('1005') | Eric          | 17-214-233-1227 | 12331     | md5('1005\|\|ERIC\|\|17-214-233-1227\|\|12331')  | 1993-01-01 11:14:54.396     | 1993-01-01 11:14:54.396 | *      |
      | md5('1005') | Eric          | 17-214-233-1237 | 12331     | md5('1005\|\|ERIC\|\|17-214-233-1237\|\|12331')  | 1993-01-01 11:14:54.396     | 1993-01-01 11:14:54.396 | *      |

  @fixture.multi_active_satellite
  Scenario: [SF-MAS-2CD-INC-06] Load empty stage into a non existent multi-active satellite with 2 CDKs - two cycles
    Given the MULTI_ACTIVE_SATELLITE_TWO_CDK_TS ma_sat is empty
    And the RAW_STAGE_TWO_CDK_TS table contains data
      | CUSTOMER_ID | CUSTOMER_NAME | CUSTOMER_PHONE  | EXTENSION | LOAD_DATETIME            | SOURCE |
      | 1001        | Alice         | 17-214-233-1214 | 12301     | 1993-01-01 11:14:54.396 | *      |
      | 1001        | Alice         | 17-214-233-1214 | 12302     | 1993-01-01 11:14:54.396 | *      |
      | 1001        | Alice         | 17-214-233-1214 | 12303     | 1993-01-01 11:14:54.396 | *      |
      | 1001        | Alice         | 17-214-233-1214 | 12303     | 1993-01-01 11:14:54.396 | *      |
      | 1002        | Bob           | 17-214-233-1215 | 12311     | 1993-01-01 11:14:54.396 | *      |
      | 1002        | Bob           | 17-214-233-1215 | 12312     | 1993-01-01 11:14:54.396 | *      |
      | 1002        | Bob           | 17-214-233-1215 | 12313     | 1993-01-01 11:14:54.396 | *      |
      | 1002        | Bob           | 17-214-233-1215 | 12313     | 1993-01-01 11:14:54.396 | *      |
      | 1003        | Chad          | 17-214-233-1216 | 12321     | 1993-01-01 11:14:54.396 | *      |
      | 1003        | Chad          | 17-214-233-1226 | 12321     | 1993-01-01 11:14:54.396 | *      |
      | 1003        | Chad          | 17-214-233-1226 | 12321     | 1993-01-01 11:14:54.396 | *      |
      | 1003        | Chad          | 17-214-233-1236 | 12321     | 1993-01-01 11:14:54.396 | *      |
      | 1005        | Eric          | 17-214-233-1217 | 12331     | 1993-01-01 11:14:54.396 | *      |
      | 1005        | Eric          | 17-214-233-1227 | 12331     | 1993-01-01 11:14:54.396 | *      |
      | 1005        | Eric          | 17-214-233-1237 | 12331     | 1993-01-01 11:14:54.396 | *      |
      | 1005        | Eric          | 17-214-233-1237 | 12331     | 1993-01-01 11:14:54.396 | *      |
    And I stage the STG_CUSTOMER_TWO_CDK_TS data
    And I load the MULTI_ACTIVE_SATELLITE_TWO_CDK_TS ma_sat
    And the RAW_STAGE_TWO_CDK_TS table contains data
      | CUSTOMER_ID | CUSTOMER_NAME | CUSTOMER_PHONE  | EXTENSION | LOAD_DATETIME            | SOURCE |
      | 1001        | Alice         | 17-214-233-1214 | 12301     | 1993-01-01 11:14:54.397 | *      |
      | 1001        | Alice         | 17-214-233-1214 | 12302     | 1993-01-01 11:14:54.397 | *      |
      | 1001        | Alice         | 17-214-233-1214 | 12303     | 1993-01-01 11:14:54.397 | *      |
      | 1002        | Bob           | 17-214-233-1215 | 12311     | 1993-01-01 11:14:54.397 | *      |
      | 1002        | Bob           | 17-214-233-1215 | 12312     | 1993-01-01 11:14:54.397 | *      |
      | 1002        | Bob           | 17-214-233-1215 | 12314     | 1993-01-01 11:14:54.397 | *      |
      | 1002        | Bob           | 17-214-233-1215 | 12314     | 1993-01-01 11:14:54.397 | *      |
      | 1003        | Chad          | 17-214-233-1216 | 12321     | 1993-01-01 11:14:54.397 | *      |
      | 1003        | Chad          | 17-214-233-1226 | 12321     | 1993-01-01 11:14:54.397 | *      |
      | 1006        | Dan           | 17-214-233-1230 | 12430     | 1993-01-01 11:14:54.397 | *      |
      | 1006        | Dan           | 17-214-233-1230 | 12440     | 1993-01-01 11:14:54.397 | *      |
      | 1006        | Dan           | 17-214-233-1240 | 12450     | 1993-01-01 11:14:54.397 | *      |
    And I stage the STG_CUSTOMER_TWO_CDK_TS data
    When I load the MULTI_ACTIVE_SATELLITE_TWO_CDK_TS ma_sat
    Then the MULTI_ACTIVE_SATELLITE_TWO_CDK_TS table should contain expected data
      | CUSTOMER_PK | CUSTOMER_NAME | CUSTOMER_PHONE  | EXTENSION | HASHDIFF                                         | EFFECTIVE_FROM | LOAD_DATETIME            | SOURCE |
      | md5('1001') | Alice         | 17-214-233-1214 | 12301     | md5('1001\|\|ALICE\|\|17-214-233-1214\|\|12301') | 1993-01-01 11:14:54.396     | 1993-01-01 11:14:54.396 | *      |
      | md5('1001') | Alice         | 17-214-233-1214 | 12302     | md5('1001\|\|ALICE\|\|17-214-233-1214\|\|12302') | 1993-01-01 11:14:54.396     | 1993-01-01 11:14:54.396 | *      |
      | md5('1001') | Alice         | 17-214-233-1214 | 12303     | md5('1001\|\|ALICE\|\|17-214-233-1214\|\|12303') | 1993-01-01 11:14:54.396     | 1993-01-01 11:14:54.396 | *      |
      | md5('1002') | Bob           | 17-214-233-1215 | 12311     | md5('1002\|\|BOB\|\|17-214-233-1215\|\|12311')   | 1993-01-01 11:14:54.396     | 1993-01-01 11:14:54.396 | *      |
      | md5('1002') | Bob           | 17-214-233-1215 | 12312     | md5('1002\|\|BOB\|\|17-214-233-1215\|\|12312')   | 1993-01-01 11:14:54.396     | 1993-01-01 11:14:54.396 | *      |
      | md5('1002') | Bob           | 17-214-233-1215 | 12313     | md5('1002\|\|BOB\|\|17-214-233-1215\|\|12313')   | 1993-01-01 11:14:54.396     | 1993-01-01 11:14:54.396 | *      |
      | md5('1002') | Bob           | 17-214-233-1215 | 12311     | md5('1002\|\|BOB\|\|17-214-233-1215\|\|12311')   | 1993-01-01 11:14:54.397     | 1993-01-01 11:14:54.397 | *      |
      | md5('1002') | Bob           | 17-214-233-1215 | 12312     | md5('1002\|\|BOB\|\|17-214-233-1215\|\|12312')   | 1993-01-01 11:14:54.397     | 1993-01-01 11:14:54.397 | *      |
      | md5('1002') | Bob           | 17-214-233-1215 | 12314     | md5('1002\|\|BOB\|\|17-214-233-1215\|\|12314')   | 1993-01-01 11:14:54.397     | 1993-01-01 11:14:54.397 | *      |
      | md5('1003') | Chad          | 17-214-233-1216 | 12321     | md5('1003\|\|CHAD\|\|17-214-233-1216\|\|12321')  | 1993-01-01 11:14:54.396     | 1993-01-01 11:14:54.396 | *      |
      | md5('1003') | Chad          | 17-214-233-1226 | 12321     | md5('1003\|\|CHAD\|\|17-214-233-1226\|\|12321')  | 1993-01-01 11:14:54.396     | 1993-01-01 11:14:54.396 | *      |
      | md5('1003') | Chad          | 17-214-233-1236 | 12321     | md5('1003\|\|CHAD\|\|17-214-233-1236\|\|12321')  | 1993-01-01 11:14:54.396     | 1993-01-01 11:14:54.396 | *      |
      | md5('1003') | Chad          | 17-214-233-1216 | 12321     | md5('1003\|\|CHAD\|\|17-214-233-1216\|\|12321')  | 1993-01-01 11:14:54.397     | 1993-01-01 11:14:54.397 | *      |
      | md5('1003') | Chad          | 17-214-233-1226 | 12321     | md5('1003\|\|CHAD\|\|17-214-233-1226\|\|12321')  | 1993-01-01 11:14:54.397     | 1993-01-01 11:14:54.397 | *      |
      | md5('1005') | Eric          | 17-214-233-1217 | 12331     | md5('1005\|\|ERIC\|\|17-214-233-1217\|\|12331')  | 1993-01-01 11:14:54.396     | 1993-01-01 11:14:54.396 | *      |
      | md5('1005') | Eric          | 17-214-233-1227 | 12331     | md5('1005\|\|ERIC\|\|17-214-233-1227\|\|12331')  | 1993-01-01 11:14:54.396     | 1993-01-01 11:14:54.396 | *      |
      | md5('1005') | Eric          | 17-214-233-1237 | 12331     | md5('1005\|\|ERIC\|\|17-214-233-1237\|\|12331')  | 1993-01-01 11:14:54.396     | 1993-01-01 11:14:54.396 | *      |
      | md5('1006') | Dan           | 17-214-233-1230 | 12430     | md5('1006\|\|DAN\|\|17-214-233-1230\|\|12430')   | 1993-01-01 11:14:54.397     | 1993-01-01 11:14:54.397 | *      |
      | md5('1006') | Dan           | 17-214-233-1230 | 12440     | md5('1006\|\|DAN\|\|17-214-233-1230\|\|12440')   | 1993-01-01 11:14:54.397     | 1993-01-01 11:14:54.397 | *      |
      | md5('1006') | Dan           | 17-214-233-1240 | 12450     | md5('1006\|\|DAN\|\|17-214-233-1240\|\|12450')   | 1993-01-01 11:14:54.397     | 1993-01-01 11:14:54.397 | *      |
    
  @fixture.multi_active_satellite
  Scenario: [SF-MAS-2CD-INC-07] Load empty stage into a populated multi-active satellite with 2 CDKs - one cycle
    Given the MULTI_ACTIVE_SATELLITE_TWO_CDK_TS ma_sat is already populated with data
      | CUSTOMER_PK | CUSTOMER_NAME | CUSTOMER_PHONE  | EXTENSION | HASHDIFF                                         | EFFECTIVE_FROM | LOAD_DATETIME            | SOURCE |
      | md5('1001') | Alice         | 17-214-233-1214 | 12301     | md5('1001\|\|ALICE\|\|17-214-233-1214\|\|12301') | 1993-01-01 11:14:54.396     | 1993-01-01 11:14:54.396 | *      |
      | md5('1001') | Alice         | 17-214-233-1214 | 12302     | md5('1001\|\|ALICE\|\|17-214-233-1214\|\|12302') | 1993-01-01 11:14:54.396     | 1993-01-01 11:14:54.396 | *      |
      | md5('1001') | Alice         | 17-214-233-1214 | 12303     | md5('1001\|\|ALICE\|\|17-214-233-1214\|\|12303') | 1993-01-01 11:14:54.396     | 1993-01-01 11:14:54.396 | *      |
      | md5('1002') | Bob           | 17-214-233-1215 | 12311     | md5('1002\|\|BOB\|\|17-214-233-1215\|\|12311')   | 1993-01-01 11:14:54.396     | 1993-01-01 11:14:54.396 | *      |
      | md5('1002') | Bob           | 17-214-233-1215 | 12312     | md5('1002\|\|BOB\|\|17-214-233-1215\|\|12312')   | 1993-01-01 11:14:54.396     | 1993-01-01 11:14:54.396 | *      |
      | md5('1002') | Bob           | 17-214-233-1215 | 12313     | md5('1002\|\|BOB\|\|17-214-233-1215\|\|12313')   | 1993-01-01 11:14:54.396     | 1993-01-01 11:14:54.396 | *      |
      | md5('1003') | Chad          | 17-214-233-1216 | 12321     | md5('1003\|\|CHAD\|\|17-214-233-1216\|\|12321')  | 1993-01-01 11:14:54.396     | 1993-01-01 11:14:54.396 | *      |
      | md5('1003') | Chad          | 17-214-233-1226 | 12321     | md5('1003\|\|CHAD\|\|17-214-233-1226\|\|12321')  | 1993-01-01 11:14:54.396     | 1993-01-01 11:14:54.396 | *      |
      | md5('1003') | Chad          | 17-214-233-1236 | 12321     | md5('1003\|\|CHAD\|\|17-214-233-1236\|\|12321')  | 1993-01-01 11:14:54.396     | 1993-01-01 11:14:54.396 | *      |
      | md5('1005') | Eric          | 17-214-233-1217 | 12331     | md5('1005\|\|ERIC\|\|17-214-233-1217\|\|12331')  | 1993-01-01 11:14:54.396     | 1993-01-01 11:14:54.396 | *      |
      | md5('1005') | Eric          | 17-214-233-1227 | 12331     | md5('1005\|\|ERIC\|\|17-214-233-1227\|\|12331')  | 1993-01-01 11:14:54.396     | 1993-01-01 11:14:54.396 | *      |
      | md5('1005') | Eric          | 17-214-233-1237 | 12331     | md5('1005\|\|ERIC\|\|17-214-233-1237\|\|12331')  | 1993-01-01 11:14:54.396     | 1993-01-01 11:14:54.396 | *      |
    And the RAW_STAGE_TWO_CDK_TS table contains data
      | CUSTOMER_ID | CUSTOMER_NAME | CUSTOMER_PHONE  | EXTENSION | LOAD_DATETIME | SOURCE |
    And I stage the STG_CUSTOMER_TWO_CDK_TS data
    When I load the MULTI_ACTIVE_SATELLITE_TWO_CDK_TS ma_sat
    Then the MULTI_ACTIVE_SATELLITE_TWO_CDK_TS table should contain expected data
      | CUSTOMER_PK | CUSTOMER_NAME | CUSTOMER_PHONE  | EXTENSION | HASHDIFF                                         | EFFECTIVE_FROM | LOAD_DATETIME            | SOURCE |
      | md5('1001') | Alice         | 17-214-233-1214 | 12301     | md5('1001\|\|ALICE\|\|17-214-233-1214\|\|12301') | 1993-01-01 11:14:54.396     | 1993-01-01 11:14:54.396 | *      |
      | md5('1001') | Alice         | 17-214-233-1214 | 12302     | md5('1001\|\|ALICE\|\|17-214-233-1214\|\|12302') | 1993-01-01 11:14:54.396     | 1993-01-01 11:14:54.396 | *      |
      | md5('1001') | Alice         | 17-214-233-1214 | 12303     | md5('1001\|\|ALICE\|\|17-214-233-1214\|\|12303') | 1993-01-01 11:14:54.396     | 1993-01-01 11:14:54.396 | *      |
      | md5('1002') | Bob           | 17-214-233-1215 | 12311     | md5('1002\|\|BOB\|\|17-214-233-1215\|\|12311')   | 1993-01-01 11:14:54.396     | 1993-01-01 11:14:54.396 | *      |
      | md5('1002') | Bob           | 17-214-233-1215 | 12312     | md5('1002\|\|BOB\|\|17-214-233-1215\|\|12312')   | 1993-01-01 11:14:54.396     | 1993-01-01 11:14:54.396 | *      |
      | md5('1002') | Bob           | 17-214-233-1215 | 12313     | md5('1002\|\|BOB\|\|17-214-233-1215\|\|12313')   | 1993-01-01 11:14:54.396     | 1993-01-01 11:14:54.396 | *      |
      | md5('1003') | Chad          | 17-214-233-1216 | 12321     | md5('1003\|\|CHAD\|\|17-214-233-1216\|\|12321')  | 1993-01-01 11:14:54.396     | 1993-01-01 11:14:54.396 | *      |
      | md5('1003') | Chad          | 17-214-233-1226 | 12321     | md5('1003\|\|CHAD\|\|17-214-233-1226\|\|12321')  | 1993-01-01 11:14:54.396     | 1993-01-01 11:14:54.396 | *      |
      | md5('1003') | Chad          | 17-214-233-1236 | 12321     | md5('1003\|\|CHAD\|\|17-214-233-1236\|\|12321')  | 1993-01-01 11:14:54.396     | 1993-01-01 11:14:54.396 | *      |
      | md5('1005') | Eric          | 17-214-233-1217 | 12331     | md5('1005\|\|ERIC\|\|17-214-233-1217\|\|12331')  | 1993-01-01 11:14:54.396     | 1993-01-01 11:14:54.396 | *      |
      | md5('1005') | Eric          | 17-214-233-1227 | 12331     | md5('1005\|\|ERIC\|\|17-214-233-1227\|\|12331')  | 1993-01-01 11:14:54.396     | 1993-01-01 11:14:54.396 | *      |
      | md5('1005') | Eric          | 17-214-233-1237 | 12331     | md5('1005\|\|ERIC\|\|17-214-233-1237\|\|12331')  | 1993-01-01 11:14:54.396     | 1993-01-01 11:14:54.396 | *      |

    @fixture.multi_active_satellite
    Scenario: [SF-MAS-2CD-INC-08] Load stage into a populated multi-active satellite with 2 CDKs - one cycle
    Given the MULTI_ACTIVE_SATELLITE_TWO_CDK_TS ma_sat is already populated with data
      | CUSTOMER_PK | CUSTOMER_NAME | CUSTOMER_PHONE  | EXTENSION | HASHDIFF                                         | EFFECTIVE_FROM | LOAD_DATETIME            | SOURCE |
      | md5('1001') | Alice         | 17-214-233-1214 | 12301     | md5('1001\|\|ALICE\|\|17-214-233-1214\|\|12301') | 1993-01-01 11:14:54.396     | 1993-01-01 11:14:54.396 | *      |
      | md5('1001') | Alice         | 17-214-233-1214 | 12302     | md5('1001\|\|ALICE\|\|17-214-233-1214\|\|12302') | 1993-01-01 11:14:54.396     | 1993-01-01 11:14:54.396 | *      |
      | md5('1001') | Alice         | 17-214-233-1214 | 12303     | md5('1001\|\|ALICE\|\|17-214-233-1214\|\|12303') | 1993-01-01 11:14:54.396     | 1993-01-01 11:14:54.396 | *      |
      | md5('1002') | Bob           | 17-214-233-1215 | 12311     | md5('1002\|\|BOB\|\|17-214-233-1215\|\|12311')   | 1993-01-01 11:14:54.396     | 1993-01-01 11:14:54.396 | *      |
      | md5('1002') | Bob           | 17-214-233-1215 | 12312     | md5('1002\|\|BOB\|\|17-214-233-1215\|\|12312')   | 1993-01-01 11:14:54.396     | 1993-01-01 11:14:54.396 | *      |
      | md5('1002') | Bob           | 17-214-233-1215 | 12313     | md5('1002\|\|BOB\|\|17-214-233-1215\|\|12313')   | 1993-01-01 11:14:54.396     | 1993-01-01 11:14:54.396 | *      |
      | md5('1003') | Chad          | 17-214-233-1216 | 12321     | md5('1003\|\|CHAD\|\|17-214-233-1216\|\|12321')  | 1993-01-01 11:14:54.396     | 1993-01-01 11:14:54.396 | *      |
      | md5('1003') | Chad          | 17-214-233-1226 | 12321     | md5('1003\|\|CHAD\|\|17-214-233-1226\|\|12321')  | 1993-01-01 11:14:54.396     | 1993-01-01 11:14:54.396 | *      |
      | md5('1003') | Chad          | 17-214-233-1236 | 12321     | md5('1003\|\|CHAD\|\|17-214-233-1236\|\|12321')  | 1993-01-01 11:14:54.396     | 1993-01-01 11:14:54.396 | *      |
      | md5('1005') | Eric          | 17-214-233-1217 | 12331     | md5('1005\|\|ERIC\|\|17-214-233-1217\|\|12331')  | 1993-01-01 11:14:54.396     | 1993-01-01 11:14:54.396 | *      |
      | md5('1005') | Eric          | 17-214-233-1227 | 12331     | md5('1005\|\|ERIC\|\|17-214-233-1227\|\|12331')  | 1993-01-01 11:14:54.396     | 1993-01-01 11:14:54.396 | *      |
      | md5('1005') | Eric          | 17-214-233-1237 | 12331     | md5('1005\|\|ERIC\|\|17-214-233-1237\|\|12331')  | 1993-01-01 11:14:54.396     | 1993-01-01 11:14:54.396 | *      |
    And the RAW_STAGE_TWO_CDK_TS table contains data
      | CUSTOMER_ID | CUSTOMER_NAME | CUSTOMER_PHONE  | EXTENSION | LOAD_DATETIME            | SOURCE |
      | 1001        | Alice         | 17-214-233-1214 | 12301     | 1993-01-01 11:14:54.397 | *      |
      | 1001        | Alice         | 17-214-233-1214 | 12302     | 1993-01-01 11:14:54.397 | *      |
      | 1001        | Alice         | 17-214-233-1214 | 12303     | 1993-01-01 11:14:54.397 | *      |
      | 1002        | Bob           | 17-214-233-1215 | 12311     | 1993-01-01 11:14:54.397 | *      |
      | 1002        | Bob           | 17-214-233-1215 | 12312     | 1993-01-01 11:14:54.397 | *      |
      | 1002        | Bob           | 17-214-233-1215 | 12314     | 1993-01-01 11:14:54.397 | *      |
      | 1002        | Bob           | 17-214-233-1215 | 12314     | 1993-01-01 11:14:54.397 | *      |
      | 1003        | Chad          | 17-214-233-1216 | 12321     | 1993-01-01 11:14:54.397 | *      |
      | 1003        | Chad          | 17-214-233-1226 | 12321     | 1993-01-01 11:14:54.397 | *      |
      | 1006        | Dan           | 17-214-233-1230 | 12430     | 1993-01-01 11:14:54.397 | *      |
      | 1006        | Dan           | 17-214-233-1230 | 12440     | 1993-01-01 11:14:54.397 | *      |
      | 1006        | Dan           | 17-214-233-1240 | 12450     | 1993-01-01 11:14:54.397 | *      |
    And I stage the STG_CUSTOMER_TWO_CDK_TS data
    When I load the MULTI_ACTIVE_SATELLITE_TWO_CDK_TS ma_sat
    Then the MULTI_ACTIVE_SATELLITE_TWO_CDK_TS table should contain expected data
      | CUSTOMER_PK | CUSTOMER_NAME | CUSTOMER_PHONE  | EXTENSION | HASHDIFF                                         | EFFECTIVE_FROM | LOAD_DATETIME            | SOURCE |
      | md5('1001') | Alice         | 17-214-233-1214 | 12301     | md5('1001\|\|ALICE\|\|17-214-233-1214\|\|12301') | 1993-01-01 11:14:54.396     | 1993-01-01 11:14:54.396 | *      |
      | md5('1001') | Alice         | 17-214-233-1214 | 12302     | md5('1001\|\|ALICE\|\|17-214-233-1214\|\|12302') | 1993-01-01 11:14:54.396     | 1993-01-01 11:14:54.396 | *      |
      | md5('1001') | Alice         | 17-214-233-1214 | 12303     | md5('1001\|\|ALICE\|\|17-214-233-1214\|\|12303') | 1993-01-01 11:14:54.396     | 1993-01-01 11:14:54.396 | *      |
      | md5('1002') | Bob           | 17-214-233-1215 | 12311     | md5('1002\|\|BOB\|\|17-214-233-1215\|\|12311')   | 1993-01-01 11:14:54.396     | 1993-01-01 11:14:54.396 | *      |
      | md5('1002') | Bob           | 17-214-233-1215 | 12312     | md5('1002\|\|BOB\|\|17-214-233-1215\|\|12312')   | 1993-01-01 11:14:54.396     | 1993-01-01 11:14:54.396 | *      |
      | md5('1002') | Bob           | 17-214-233-1215 | 12313     | md5('1002\|\|BOB\|\|17-214-233-1215\|\|12313')   | 1993-01-01 11:14:54.396     | 1993-01-01 11:14:54.396 | *      |
      | md5('1002') | Bob           | 17-214-233-1215 | 12311     | md5('1002\|\|BOB\|\|17-214-233-1215\|\|12311')   | 1993-01-01 11:14:54.397     | 1993-01-01 11:14:54.397 | *      |
      | md5('1002') | Bob           | 17-214-233-1215 | 12312     | md5('1002\|\|BOB\|\|17-214-233-1215\|\|12312')   | 1993-01-01 11:14:54.397     | 1993-01-01 11:14:54.397 | *      |
      | md5('1002') | Bob           | 17-214-233-1215 | 12314     | md5('1002\|\|BOB\|\|17-214-233-1215\|\|12314')   | 1993-01-01 11:14:54.397     | 1993-01-01 11:14:54.397 | *      |
      | md5('1003') | Chad          | 17-214-233-1216 | 12321     | md5('1003\|\|CHAD\|\|17-214-233-1216\|\|12321')  | 1993-01-01 11:14:54.396     | 1993-01-01 11:14:54.396 | *      |
      | md5('1003') | Chad          | 17-214-233-1226 | 12321     | md5('1003\|\|CHAD\|\|17-214-233-1226\|\|12321')  | 1993-01-01 11:14:54.396     | 1993-01-01 11:14:54.396 | *      |
      | md5('1003') | Chad          | 17-214-233-1236 | 12321     | md5('1003\|\|CHAD\|\|17-214-233-1236\|\|12321')  | 1993-01-01 11:14:54.396     | 1993-01-01 11:14:54.396 | *      |
      | md5('1003') | Chad          | 17-214-233-1216 | 12321     | md5('1003\|\|CHAD\|\|17-214-233-1216\|\|12321')  | 1993-01-01 11:14:54.397     | 1993-01-01 11:14:54.397 | *      |
      | md5('1003') | Chad          | 17-214-233-1226 | 12321     | md5('1003\|\|CHAD\|\|17-214-233-1226\|\|12321')  | 1993-01-01 11:14:54.397     | 1993-01-01 11:14:54.397 | *      |
      | md5('1005') | Eric          | 17-214-233-1217 | 12331     | md5('1005\|\|ERIC\|\|17-214-233-1217\|\|12331')  | 1993-01-01 11:14:54.396     | 1993-01-01 11:14:54.396 | *      |
      | md5('1005') | Eric          | 17-214-233-1227 | 12331     | md5('1005\|\|ERIC\|\|17-214-233-1227\|\|12331')  | 1993-01-01 11:14:54.396     | 1993-01-01 11:14:54.396 | *      |
      | md5('1005') | Eric          | 17-214-233-1237 | 12331     | md5('1005\|\|ERIC\|\|17-214-233-1237\|\|12331')  | 1993-01-01 11:14:54.396     | 1993-01-01 11:14:54.396 | *      |
      | md5('1006') | Dan           | 17-214-233-1230 | 12430     | md5('1006\|\|DAN\|\|17-214-233-1230\|\|12430')   | 1993-01-01 11:14:54.397     | 1993-01-01 11:14:54.397 | *      |
      | md5('1006') | Dan           | 17-214-233-1230 | 12440     | md5('1006\|\|DAN\|\|17-214-233-1230\|\|12440')   | 1993-01-01 11:14:54.397     | 1993-01-01 11:14:54.397 | *      |
      | md5('1006') | Dan           | 17-214-233-1240 | 12450     | md5('1006\|\|DAN\|\|17-214-233-1240\|\|12450')   | 1993-01-01 11:14:54.397     | 1993-01-01 11:14:54.397 | *      |

    @fixture.multi_active_satellite
    Scenario: [SF-MAS-2CD-INC-09] Load mixed stage into a populated multi-active satellite with 2 CDKs - two cycles
    Given the MULTI_ACTIVE_SATELLITE_TWO_CDK_TS ma_sat is already populated with data
      | CUSTOMER_PK | CUSTOMER_NAME | CUSTOMER_PHONE  | EXTENSION | HASHDIFF                                         | EFFECTIVE_FROM | LOAD_DATETIME            | SOURCE |
      | md5('1001') | Alice         | 17-214-233-1214 | 12301     | md5('1001\|\|ALICE\|\|17-214-233-1214\|\|12301') | 1993-01-01 11:14:54.396     | 1993-01-01 11:14:54.396 | *      |
      | md5('1001') | Alice         | 17-214-233-1214 | 12302     | md5('1001\|\|ALICE\|\|17-214-233-1214\|\|12302') | 1993-01-01 11:14:54.396     | 1993-01-01 11:14:54.396 | *      |
      | md5('1001') | Alice         | 17-214-233-1214 | 12303     | md5('1001\|\|ALICE\|\|17-214-233-1214\|\|12303') | 1993-01-01 11:14:54.396     | 1993-01-01 11:14:54.396 | *      |
      | md5('1002') | Bob           | 17-214-233-1215 | 12311     | md5('1002\|\|BOB\|\|17-214-233-1215\|\|12311')   | 1993-01-01 11:14:54.396     | 1993-01-01 11:14:54.396 | *      |
      | md5('1002') | Bob           | 17-214-233-1215 | 12312     | md5('1002\|\|BOB\|\|17-214-233-1215\|\|12312')   | 1993-01-01 11:14:54.396     | 1993-01-01 11:14:54.396 | *      |
      | md5('1002') | Bob           | 17-214-233-1215 | 12313     | md5('1002\|\|BOB\|\|17-214-233-1215\|\|12313')   | 1993-01-01 11:14:54.396     | 1993-01-01 11:14:54.396 | *      |
      | md5('1003') | Chad          | 17-214-233-1216 | 12321     | md5('1003\|\|CHAD\|\|17-214-233-1216\|\|12321')  | 1993-01-01 11:14:54.396     | 1993-01-01 11:14:54.396 | *      |
      | md5('1003') | Chad          | 17-214-233-1226 | 12321     | md5('1003\|\|CHAD\|\|17-214-233-1226\|\|12321')  | 1993-01-01 11:14:54.396     | 1993-01-01 11:14:54.396 | *      |
      | md5('1003') | Chad          | 17-214-233-1236 | 12321     | md5('1003\|\|CHAD\|\|17-214-233-1236\|\|12321')  | 1993-01-01 11:14:54.396     | 1993-01-01 11:14:54.396 | *      |
      | md5('1005') | Eric          | 17-214-233-1217 | 12331     | md5('1005\|\|ERIC\|\|17-214-233-1217\|\|12331')  | 1993-01-01 11:14:54.396     | 1993-01-01 11:14:54.396 | *      |
      | md5('1005') | Eric          | 17-214-233-1227 | 12331     | md5('1005\|\|ERIC\|\|17-214-233-1227\|\|12331')  | 1993-01-01 11:14:54.396     | 1993-01-01 11:14:54.396 | *      |
      | md5('1005') | Eric          | 17-214-233-1237 | 12331     | md5('1005\|\|ERIC\|\|17-214-233-1237\|\|12331')  | 1993-01-01 11:14:54.396     | 1993-01-01 11:14:54.396 | *      |
    And the RAW_STAGE_TWO_CDK_TS table contains data
      | CUSTOMER_ID | CUSTOMER_NAME | CUSTOMER_PHONE  | EXTENSION | LOAD_DATETIME            | SOURCE |
      | 1001        | Alice         | 17-214-233-1214 | 12301     | 1993-01-01 11:14:54.397 | *      |
      | 1001        | Alice         | 17-214-233-1214 | 12302     | 1993-01-01 11:14:54.397 | *      |
      | 1001        | Alice         | 17-214-233-1214 | 12303     | 1993-01-01 11:14:54.397 | *      |
      | 1002        | Bob           | 17-214-233-1215 | 12311     | 1993-01-01 11:14:54.397 | *      |
      | 1002        | Bob           | 17-214-233-1215 | 12312     | 1993-01-01 11:14:54.397 | *      |
      | 1002        | Bob           | 17-214-233-1215 | 12314     | 1993-01-01 11:14:54.397 | *      |
      | 1002        | Bob           | 17-214-233-1215 | 12314     | 1993-01-01 11:14:54.397 | *      |
      | 1003        | Chad          | 17-214-233-1216 | 12321     | 1993-01-01 11:14:54.397 | *      |
      | 1003        | Chad          | 17-214-233-1226 | 12321     | 1993-01-01 11:14:54.397 | *      |
      | 1006        | Dan           | 17-214-233-1230 | 12430     | 1993-01-01 11:14:54.397 | *      |
      | 1006        | Dan           | 17-214-233-1230 | 12440     | 1993-01-01 11:14:54.397 | *      |
      | 1006        | Dan           | 17-214-233-1240 | 12450     | 1993-01-01 11:14:54.397 | *      |
    And I stage the STG_CUSTOMER_TWO_CDK_TS data
    And I load the MULTI_ACTIVE_SATELLITE_TWO_CDK_TS ma_sat
    And the RAW_STAGE_TWO_CDK_TS table contains data
      | CUSTOMER_ID | CUSTOMER_NAME | CUSTOMER_PHONE  | EXTENSION | LOAD_DATETIME            | SOURCE |
      | 1002        | Bob           | 17-214-233-1215 | 12311     | 1993-01-01 11:14:54.398 | *      |
      | 1002        | Bob           | 17-214-233-1215 | 12312     | 1993-01-01 11:14:54.398 | *      |
      | 1002        | Bob           | 17-214-233-1215 | 12314     | 1993-01-01 11:14:54.398 | *      |
      | 1003        | Chad          | 17-214-233-1226 | 12321     | 1993-01-01 11:14:54.398 | *      |
      | 1006        | Dan           | 17-214-233-1230 | 12430     | 1993-01-01 11:14:54.398 | *      |
      | 1006        | Dan           | 17-214-233-1230 | 12440     | 1993-01-01 11:14:54.398 | *      |
      | 1006        | Dan           | 17-214-233-1240 | 12460     | 1993-01-01 11:14:54.398 | *      |
      | 1007        | Charles       | 17-214-233-2000 | 12500     | 1993-01-01 11:14:54.398 | *      |
      | 1007        | Charles       | 17-214-233-2000 | 12510     | 1993-01-01 11:14:54.398 | *      |
      | 1007        | Charlie       | 17-214-233-2000 | 12510     | 1993-01-01 11:14:54.398 | *      |
      | 1007        | Charlie       | 17-214-233-2000 | 12510     | 1993-01-01 11:14:54.398 | *      |
    And I stage the STG_CUSTOMER_TWO_CDK_TS data
    When I load the MULTI_ACTIVE_SATELLITE_TWO_CDK_TS ma_sat
    Then the MULTI_ACTIVE_SATELLITE_TWO_CDK_TS table should contain expected data
      | CUSTOMER_PK | CUSTOMER_NAME | CUSTOMER_PHONE  | EXTENSION | HASHDIFF                                             | EFFECTIVE_FROM | LOAD_DATETIME            | SOURCE |
      | md5('1001') | Alice         | 17-214-233-1214 | 12301     | md5('1001\|\|ALICE\|\|17-214-233-1214\|\|12301')     | 1993-01-01 11:14:54.396     | 1993-01-01 11:14:54.396 | *      |
      | md5('1001') | Alice         | 17-214-233-1214 | 12302     | md5('1001\|\|ALICE\|\|17-214-233-1214\|\|12302')     | 1993-01-01 11:14:54.396     | 1993-01-01 11:14:54.396 | *      |
      | md5('1001') | Alice         | 17-214-233-1214 | 12303     | md5('1001\|\|ALICE\|\|17-214-233-1214\|\|12303')     | 1993-01-01 11:14:54.396     | 1993-01-01 11:14:54.396 | *      |
      | md5('1002') | Bob           | 17-214-233-1215 | 12311     | md5('1002\|\|BOB\|\|17-214-233-1215\|\|12311')       | 1993-01-01 11:14:54.396     | 1993-01-01 11:14:54.396 | *      |
      | md5('1002') | Bob           | 17-214-233-1215 | 12312     | md5('1002\|\|BOB\|\|17-214-233-1215\|\|12312')       | 1993-01-01 11:14:54.396     | 1993-01-01 11:14:54.396 | *      |
      | md5('1002') | Bob           | 17-214-233-1215 | 12313     | md5('1002\|\|BOB\|\|17-214-233-1215\|\|12313')       | 1993-01-01 11:14:54.396     | 1993-01-01 11:14:54.396 | *      |
      | md5('1002') | Bob           | 17-214-233-1215 | 12311     | md5('1002\|\|BOB\|\|17-214-233-1215\|\|12311')       | 1993-01-01 11:14:54.397     | 1993-01-01 11:14:54.397 | *      |
      | md5('1002') | Bob           | 17-214-233-1215 | 12312     | md5('1002\|\|BOB\|\|17-214-233-1215\|\|12312')       | 1993-01-01 11:14:54.397     | 1993-01-01 11:14:54.397 | *      |
      | md5('1002') | Bob           | 17-214-233-1215 | 12314     | md5('1002\|\|BOB\|\|17-214-233-1215\|\|12314')       | 1993-01-01 11:14:54.397     | 1993-01-01 11:14:54.397 | *      |
      | md5('1003') | Chad          | 17-214-233-1216 | 12321     | md5('1003\|\|CHAD\|\|17-214-233-1216\|\|12321')      | 1993-01-01 11:14:54.396     | 1993-01-01 11:14:54.396 | *      |
      | md5('1003') | Chad          | 17-214-233-1226 | 12321     | md5('1003\|\|CHAD\|\|17-214-233-1226\|\|12321')      | 1993-01-01 11:14:54.396     | 1993-01-01 11:14:54.396 | *      |
      | md5('1003') | Chad          | 17-214-233-1236 | 12321     | md5('1003\|\|CHAD\|\|17-214-233-1236\|\|12321')      | 1993-01-01 11:14:54.396     | 1993-01-01 11:14:54.396 | *      |
      | md5('1003') | Chad          | 17-214-233-1216 | 12321     | md5('1003\|\|CHAD\|\|17-214-233-1216\|\|12321')      | 1993-01-01 11:14:54.397     | 1993-01-01 11:14:54.397 | *      |
      | md5('1003') | Chad          | 17-214-233-1226 | 12321     | md5('1003\|\|CHAD\|\|17-214-233-1226\|\|12321')      | 1993-01-01 11:14:54.397     | 1993-01-01 11:14:54.397 | *      |
      | md5('1003') | Chad          | 17-214-233-1226 | 12321     | md5('1003\|\|CHAD\|\|17-214-233-1226\|\|12321')      | 1993-01-01 11:14:54.398     | 1993-01-01 11:14:54.398 | *      |
      | md5('1005') | Eric          | 17-214-233-1217 | 12331     | md5('1005\|\|ERIC\|\|17-214-233-1217\|\|12331')      | 1993-01-01 11:14:54.396     | 1993-01-01 11:14:54.396 | *      |
      | md5('1005') | Eric          | 17-214-233-1227 | 12331     | md5('1005\|\|ERIC\|\|17-214-233-1227\|\|12331')      | 1993-01-01 11:14:54.396     | 1993-01-01 11:14:54.396 | *      |
      | md5('1005') | Eric          | 17-214-233-1237 | 12331     | md5('1005\|\|ERIC\|\|17-214-233-1237\|\|12331')      | 1993-01-01 11:14:54.396     | 1993-01-01 11:14:54.396 | *      |
      | md5('1006') | Dan           | 17-214-233-1230 | 12430     | md5('1006\|\|DAN\|\|17-214-233-1230\|\|12430')       | 1993-01-01 11:14:54.397     | 1993-01-01 11:14:54.397 | *      |
      | md5('1006') | Dan           | 17-214-233-1230 | 12440     | md5('1006\|\|DAN\|\|17-214-233-1230\|\|12440')       | 1993-01-01 11:14:54.397     | 1993-01-01 11:14:54.397 | *      |
      | md5('1006') | Dan           | 17-214-233-1240 | 12450     | md5('1006\|\|DAN\|\|17-214-233-1240\|\|12450')       | 1993-01-01 11:14:54.397     | 1993-01-01 11:14:54.397 | *      |
      | md5('1006') | Dan           | 17-214-233-1230 | 12430     | md5('1006\|\|DAN\|\|17-214-233-1230\|\|12430')       | 1993-01-01 11:14:54.398     | 1993-01-01 11:14:54.398 | *      |
      | md5('1006') | Dan           | 17-214-233-1230 | 12440     | md5('1006\|\|DAN\|\|17-214-233-1230\|\|12440')       | 1993-01-01 11:14:54.398     | 1993-01-01 11:14:54.398 | *      |
      | md5('1006') | Dan           | 17-214-233-1240 | 12460     | md5('1006\|\|DAN\|\|17-214-233-1240\|\|12460')       | 1993-01-01 11:14:54.398     | 1993-01-01 11:14:54.398 | *      |
      | md5('1007') | Charles       | 17-214-233-2000 | 12500     | md5('1007\|\|CHARLES\|\|17-214-233-2000\|\|12500')   | 1993-01-01 11:14:54.398     | 1993-01-01 11:14:54.398 | *      |
      | md5('1007') | Charles       | 17-214-233-2000 | 12510     | md5('1007\|\|CHARLES\|\|17-214-233-2000\|\|12510')   | 1993-01-01 11:14:54.398     | 1993-01-01 11:14:54.398 | *      |
      | md5('1007') | Charlie       | 17-214-233-2000 | 12510     | md5('1007\|\|CHARLIE\|\|17-214-233-2000\|\|12510')   | 1993-01-01 11:14:54.398     | 1993-01-01 11:14:54.398 | *      |